      Study of a visco-elastic model of the human lung and
         application to the High Frequency Chest Wall
                            Oscillation
                                           Michaël Brunengo



      To cite this version:
    Michaël Brunengo. Study of a visco-elastic model of the human lung and application to the High
    Frequency Chest Wall Oscillation. Mechanics [physics]. Université Côte d’Azur, 2021. English.
    �NNT : 2021COAZ4069�. �tel-03438925�




                                   HAL Id: tel-03438925
                 https://tel.archives-ouvertes.fr/tel-03438925
                                      Submitted on 22 Nov 2021




    HAL is a multi-disciplinary open access               L’archive ouverte pluridisciplinaire HAL, est
archive for the deposit and dissemination of sci-     destinée au dépôt et à la diffusion de documents
entific research documents, whether they are pub-     scientifiques de niveau recherche, publiés ou non,
lished or not. The documents may come from            émanant des établissements d’enseignement et de
teaching and research institutions in France or       recherche français ou étrangers, des laboratoires
abroad, or from public or private research centers.   publics ou privés.


   THÈSE DE DOCTORAT

 Étude d'un modèle visco-élastique
 du poumon humain et application
   à l'oscillation haute fréquence
           extra-thoracique
                  Michaël Brunengo
                Laboratoire Jean Alexandre Dieudonné

Présentée en vue de l’obtention   Devant le jury, composé de :
du grade de docteur en            Céline Grandmont, DR, INRIA Paris
Mathématiques                     Philippe Poncet, Pr, Univ. Pau & pays de l’Adour
d’Université Côte d’Azur          Laurent Monasse, CR, INRIA Sophia Antipolis
                                  Plamen Bokov, MCU-PH, Hôpital Robert-Debré
Dirigée par : Benjamin MAUROY     Hélène Politano, DR, Université Côte d’Azur
                                  Invité : Bernard Rousselet, Pr. Ém, Université
Soutenue le : 13 Octobre 2021     Côte d’Azur
                                  Barret R. Mitchell, CEO, RespInnovation SAS


              UNIVERSITÉ CÔTE D’AZUR
       École Doctorale de Sciences Fondamentales et Appliquées

                              THÉSE
      pour obtenir le titre de docteur de l’Université Côte d’Azur

                Discipline : Mathématiques

                             presentée par
                      Michaël Brunengo


Study of a visco-elastic model of the
 human lung and application to the
    High Frequency Chest Wall
             Oscillation
                                   -
 Étude d’un modèle visco-élastique du poumon humain et application à
             l’oscillation haute fréquence extra-thoracique


            Thèse dirigée par Benjamin Mauroy
                     soutenue le 13 Octobre 2021


                      devant le jury composé de
                            Rapporteurs
     Céline Grandmont, Directrice de recherche, INRIA Paris
Philippe Poncet, Professeur, Université de Pau et des pays de l’Adour

                            Examinateurs
  Laurent Monasse, Chargé de recherche, INRIA Sophia Antipolis
     Plamen Bokov, MCU-PH, Hôpital Robert-Debré, Paris
         Hélène Politano, Directrice de Recherche, CNRS
          Benjamin Mauroy, Chargé de recherche, CNRS

                                Invités
Barret R. Mitchell, Directeur général, RespInnovation SAS, Seillans
  Bernard Rousselet, Professeur émérite, Université Côte d’Azur


    The human lung is a complex organ playing the role of interface for the vital gas exchanges
(oxygen and carbon dioxide) between the ambient air and the blood. It is composed of two
interconnected structures assuring the correct circulation of the air produced by the ventilation:
the tracheo-bronchial tree and the lung’s parenchyma, a porous medium where the gas exchanges
between the air and the blood occur. Being reachable by external pollutants, the lung is pro-
tected among others by a specific secretion, also called the pulmonary mucus. The latter can
accumulate and obstruct the airways in case of specific respiratory diseases. That can then alter
and disturb the proper functioning of the lung. The use of therapeutic methods is then essential
for the patient to maintain a good quality of life. The High Frequency Chest Wall Oscillation
(HFCWO) is a respiratory technique, being part of the chest physiotherapy, that dispenses au-
tomated therapy which mobilizes the mucus and favors its expectoration. It is based on the
application of small amplitude pressures at a relatively high frequency on the chest’s patient.
This mechanical treatment seems efficient but its use and effects on human lungs are based on
empirical knowledge and are consequently not well understood as of today. The comprehension
of this therapy rests on the study of the lung, complex system where specific behaviors occur.
In that way, the mathematical modeling can be an useful tool. This thesis takes an interest in
building and understanding a mathematical and numerical model of the lungs adapted to study
the influences of the HFCWO on the human lungs. It is exploited to propose new insight on
the use of this technique. Our work is based on the coupling between two idealised models : a
0D model of an airway tree that mimics the tracheo-bronchial tree and a multi-D homogeneous
elastic medium that mimics the lung’s parenchyma. The latter is used with its unidimensional
formulation in most of this work. Our goal is to study the physics of the coupling between
the air fluid dynamics in the airway tree and the deformation of the elastic medium, and to
analyse the stresses felt by the mucus inside the tree. First, based on literature data, we show
the efficiency of the model at mimicking ventilation at rest in healthy and non-healthy lungs.
Meanwhile, we take an interest at understanding the role of its parameters. Then, with a di-
mensionless formulation of the model and comparative numerical simulations, we propose the
use of a specific variable also known as the quality factor. Defined from the parameters of the
lungs, this variable can suggest the capability of the lung to resonate with stimulations whose
it is submitted. From the data observed in the literature, we suggest a range of frequencies
that maximizes the effects of the HFCWO and potentially the displacement of the mucus in the
tree. We show that this interval is directly linked to the fundamental natural frequency of the
elastic material. The natural frequencies computed with our model are similar to the resonance
frequencies deduced from clinical studies found in the literature. The end of the work propose
prospects for improvement of the model such as the use of 3D lungs geometries constructed
from CT-scan, the use of a splitting method to optimize the numerical time calculation or the
establishment of a clinical study of the air flows at mouth induced by the HFCWO.

    Keywords : Chest physiotherapy, HFCWO, Mathematical modelling, Fluid mechanics,
Solid mechanics, Numerical simulation


    Le poumon humain est un organe complexe jouant le rôle d’interface pour les échanges de
gaz (oxygène et dioxide de carbone) entre l’air ambient et le sang. Il est composé de deux
structures arborescentes interconnectées assurant la circulation de l’air générée par la venti-
lation : l’arbre trachéo-bronchique et le parenchyme pulmonaire, un matériau poreux où les
échanges de gaz entre l’air et le sang se produisent. Etant accessible aux polluants extérieurs,
le poumon est protégé entre autres grâce à une sécrétion spécifique, aussi appelée le mucus
pulmonaire. Ce dernier peut s’accumuler et obstruer les voies aériennes lors de maladies res-
piratoires. Cela peut modifier et perturber le bon fonctionnement du poumon. L’utilisation
de méthodes thérapeutiques est donc essentiel pour les patients afin de maintenir une bonne
qualité de vie. L’Oscillation à Hautes Fréquences de la Cage Thoracique (HFCWO) est une
technique respiratoire, appartenant à la kinésithérapie respiratoire, qui prodigue une thérapie
automatisée permettant de mobiliser le mucus et de favoriser son expectoration. Elle est basée
sur l’application de pressions à de relatives hautes fréquences et faibles amplitudes sur le thorax
du patient. Ce traitement mécanique semble efficace mais son usage et ses effets sur le poumon
humain sont basés sur des connaissances empiriques et sont donc peu compris de nos jours. La
compréhension de cette thérapie repose sur l’étude du poumon, système complexe où intervi-
ennent des comportements spécifiques. Dans ce sens, la modélisation mathématique peut être
un outil utile. Cette thèse s’intéresse à construire et à comprendre un modèle mathématique et
numérique des poumons adapté à l’étude des influences de la HFCWO sur le poumon humain.
Il est utilisé afin de proposer de nouvelles perspectives quant à l’utilisation de cette technique.
Nos travaux sont basés sur le couplage entre deux modèles idéalisés : un modèle 0D d’arbre
mimant l’arbre trachéo-bronchique et un modèle multi-D d’une matière élastique et homogène
mimant le parenchyme pulmonaire. Ce dernier est utilisé sous sa formulation unidmensionelle
dans une grande partie de ces travaux. Notre objectif est d’étudier la physique du couplage entre
la dynamique de l’écoulement de l’air dans les voies aériennes et la déformation du matériau
élastique, et d’analyser les contraintes ressenties par le mucus dans l’arbre. D’abord, en se basant
sur des données de la litérature, nous montrons l’efficacité du modèle à mimer la ventilation de
repos chez des poumons sains et malades. Dans un même temps, nous nous intéressons à com-
prendre le rôle de ses paramètres. Ensuite, avec une formulation adimensionnée du modèle et
des simulations numériques comparatives, nous proposons l’utilisation d’une variable spécifique,
aussi connue sous le nom de facteur de qualité. Définie à partir des propriétés du poumon, cette
variable informe sur la capacité du poumon à résoner avec les stimulations dont il est soumis.
A partir de données observées dans la litérature, nous suggérons une plage de fréquences qui
optimise les effets de la HFCWO et potentiellement le déplacement du mucus dans l’arbre. Nous
montrons que cet intervalle est directement lié à la fréquence propre fondamentale du matériau
élastique. Les fréquences propres calculées à partir du modèle sont similaires aux fréquences de
résonance déduites à partir d’études cliniques trouvées dans la litérature. Le contenu final de ces
travaux propose des perspectives d’amélioration du modèle comme l’utilisation de géométries
3D des poumons construites à partir de CT-scan, l’utilisation d’une méthode de splitting pour
optimiser les temps de calcul numérique ou la mise en place d’une étude clinique des flux d’air
à la bouche induits par la HFCWO.

   Mots clés : Kinésithérapie respiratoire, HFCWO, Modélisation mathématiques, Mécanique
des fluides, Mécanique des solides, Simulation numérique


Remerciements

Je tiens tout d’abord à remercier Céline Grandmont et Philippe Poncet pour avoir rapporté ce
travail de thèse. Je remercie également Laurent Monasse, Plamen Bokov et Hélène Politano
d’avoir accepté de faire partie de mon jury de thèse.
    Mes remerciements vont ensuite à Benjamin Mauroy, mon directeur de thèse. Benjamin,
merci infiniment pour ton investissement, tes conseils et ta rigueur au travail. J’ai énormément
appris grâce à toi et ton enseignement me suivra pour la suite. Cette thèse n’aurait pas été ce
qu’elle est aujourd’hui sans toi, merci beaucoup.
    Je dédie un remerciement particulier à Bernard Rousselet, professeur émérite qui m’a accom-
pagné et conseillé pendant cette thèse. Je te remercie Bernard pour tous tes avis et remarques
pertinents au sujet de mes travaux. J’espère pouvoir continuer notre collaboration.
    Je remercie l’entreprise RespInnovation de m’avoir proposé cette aventure et de m’avoir
suivi pendant ces années. Barry, merci pour ta vision industrielle de la recherche et pour
toutes les perspectives d’études que tu m’as proposées. Sophie, merci pour tous ces échanges
et ton investissement dans mes travaux. Brent, merci de m’avoir montré qu’allier la déconne
à la rigueur peut amener, de manière intéressante, à des résultats parfaitement productifs. Je
remercie particulièrement Sébastien avec qui j’ai partagé le bureau de RespInnovation pendant
ces années. Séb, merci pour tout, tant professionellement qu’amicalement. Merci d’avoir pris
le temps de me faire découvrir une partie du monde industriel et d’avoir eu la sympathie et
la patience de m’écouter te raconter mes problèmes de recherches. Au plaisir de la prochaine
session fractionnée en course à pied. Je remercie également Fausto et Céline ; et plus récemment
Charles et Lilian pour m’avoir soutenu dans ces derniers mois en proposant une atmosphère
autant sérieuse que plaisante. J’espère avoir de nouveau l’occasion de partager quelques balles
avec vous sur un court de tennis. Enfin, je remercie Christophe pour son investissement sur les
derniers mois.
    Je remercie toute l’équipe de recherche du laboratoire J.A. Dieudonné autour du poumon.
Merci pour tous ces échanges, ces cafés et ces réunions du lundi. Je remercie particulièrement
Jonathan, partenaire de bureau. Jonathan, merci pour ta clairvoyance et ta persévérance qui
m’ont toujours profondément inspiré. Merci également à André, Frédérique, Cyril, Thomas et
Riccardo pour toutes ces discussions intéressantes et pour votre sympathie. Je remercie aussi
Valentin pour son investissement dans les prémices de l’étude clinique ; j’espère pouvoir continuer
cette collaboration.
    Mes prochains remerciements s’adressent aux amis qui m’ont fait grandir pendant ma pre-
mière et ma deuxième jeunesse. Pour cette deuxième jeunesse, je remercie tous les copains de
la team Polytech - plus les amis par extension. Je m’adresse à vous tous directement sans vous
nommer car vous êtes nombreux et je serai trop inquiet d’omettre un nom :-). Merci pour votre
soutien et votre joie de vivre pendant tous ces voyages, ces soirées et ces sorties sportives. Ma
première jeunesse a été partagé avec les copains d’enfance, Valentin, Victor et Mikael, à qui
j’adresse un profond remerciement. Merci les gars pour avoir faconné la personne que je suis
aujourd’hui. Les heures passées ensemble sont indénombrables et ont toutes été singulières et
inspirantes pour moi.
    Je tiens également à remercier celle avec qui je partage ma vie depuis maintenant plus de
quatre années et qui m’a soutenu depuis le début de cette thèse. Laura, vivre à tes côtés a été
pour moi une source d’inspirations et de motivations. Merci pour ta patience, ton écoute, tes
conseils et pour tout cet amour que tu m’offres.


  vi                                                                           Remerciements


    Mes derniers remerciements s’adressent à ma famille proche et "éloignée", qui m’ont soutenu
et encouragé depuis toutes ces années. Merci les parents, le frère et sa petite famille, pour tout
ce que vous m’avez apporté. Votre aide et amour sont inestimables à mes yeux.


Contents



Remerciements                                                                                                                                    v

1    Background of the study and objectives                                                                                                       1
    1.1 Introduction . . . . . . . . . . . . . . . . .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    2
    1.2 The human lungs . . . . . . . . . . . . . .      .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    2
        1.2.1 Anatomy and characteristics . . .          .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    2
        1.2.2 Mechanics of breathing . . . . . .         .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    6
    1.3 Protection against respiratory diseases . .      .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    8
        1.3.1 Mucus : characteristics and role .         .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    8
        1.3.2 Respiratory diseases . . . . . . . .       .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    9
    1.4 The chest physiotherapy . . . . . . . . . .      .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .    9
    1.5 Objectives of the thesis . . . . . . . . . .     .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   10

2    Modelling the lungs to simulate tidal breathing for healthy and non-healthy
    lungs                                                                                                                                        13
    2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                               14
    2.2 The model of the lungs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                                 14
        2.2.1 Modelling the air flow in the tree region . . . . . . . . . . . . . . . . . . .                                                    15
               2.2.1.1 The tree region . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                                   15
               2.2.1.2 Pressure–flow relationship . . . . . . . . . . . . . . . . . . . . . .                                                    15
               2.2.1.3 Feeding the respiratory region with air . . . . . . . . . . . . . .                                                       17
        2.2.2 Modelling the mechanics of the respiratory region . . . . . . . . . . . . . .                                                      18
        2.2.3 Weak formulation of the system of equations . . . . . . . . . . . . . . . .                                                        20
        2.2.4 Numerical method : the finite element method . . . . . . . . . . . . . . .                                                         21
    2.3 The unidimensionnal formulation of the model of the lungs . . . . . . . . . . . .                                                        23
        2.3.1 Unidimensional formulation . . . . . . . . . . . . . . . . . . . . . . . . . .                                                     23
        2.3.2 The finite element method and numerical scheme . . . . . . . . . . . . . .                                                         24
        2.3.3 Analytical solution of the unidimensional model . . . . . . . . . . . . . .                                                        25
    2.4 Study of the coupling between the tree and the elastic material through non-
        physiological numerical simulations . . . . . . . . . . . . . . . . . . . . . . . . . .                                                  28
        2.4.1 Effect of the tree structure on the propagation of the wave deformation .                                                          29
        2.4.2 The resonance phenomenon in the coupled model . . . . . . . . . . . . . .                                                          33
    2.5 Rest ventilation of healthy and non-healthy lungs . . . . . . . . . . . . . . . . . .                                                    38
        2.5.1 Calibration of the model using rest ventilation . . . . . . . . . . . . . . .                                                      38
        2.5.2 Tidal breathing between individuals with healthy lungs . . . . . . . . . .                                                         41
        2.5.3 Tidal breathing for non-healthy lungs . . . . . . . . . . . . . . . . . . . .                                                      41
               2.5.3.1 Asthma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                                    42
               2.5.3.2 Chronic Obstructive Pulmonary Disease . . . . . . . . . . . . . .                                                         44
               2.5.3.3 Cystic fibrosis . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                                   46
    2.6 Discussions and conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                                                 48


  viii                                                                                             Contents


   2.A Details of calculation for the resistance of the tree . . . . . . . .   .   .   .   .   .   .   .   .   .   50
   2.B Finite element method . . . . . . . . . . . . . . . . . . . . . . . .   .   .   .   .   .   .   .   .   .   51
       2.B.1 An example of FEM calculation in 1D : the Mass matrix             .   .   .   .   .   .   .   .   .   52
   2.C Angular eigen-frequencies . . . . . . . . . . . . . . . . . . . . . .   .   .   .   .   .   .   .   .   .   53
   2.D A case of damped harmonic oscillator with one degree of freedom         .   .   .   .   .   .   .   .   .   54
   2.E Configurations of parameters for the numerical simulations . . .        .   .   .   .   .   .   .   .   .   57

3 Mechanics of the lungs and optimization of HFCWO                                                                 61
  3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                   63
      3.1.1 Recall of the equations of the coupled model . . . . . . . . . . . . . . . .                           63
  3.2 Physical analysis of the parameters of the model with a dimensionless formulation                            64
      3.2.1 Determination of the dimensionless parameters . . . . . . . . . . . . . . .                            65
      3.2.2 The coupled model reduced to one degree of freedom . . . . . . . . . . . .                             67
             3.2.2.1 Hypothesis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                        68
             3.2.2.2 Formulation of the single DoF model . . . . . . . . . . . . . . .                             68
             3.2.2.3 Numerical simulations . . . . . . . . . . . . . . . . . . . . . . . .                         69
             3.2.2.4 Application of the Q-factor to the HFCWO . . . . . . . . . . . .                              70
      3.2.3 Predicted behaviors of healthy and non-heatlhy lungs with the dimension-
             less parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                     71
      3.2.4 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                       73
  3.3 Modelling the High Frequency Chest Wall Oscillation in healthy and non-healthy
      lungs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                  73
      3.3.1 Modeling the stress in the mucus . . . . . . . . . . . . . . . . . . . . . . .                         73
      3.3.2 Effects of the HFCWO on the healthy lungs model . . . . . . . . . . . . .                              75
             3.3.2.1 Modeling HFCWO with our model . . . . . . . . . . . . . . . . .                               75
             3.3.2.2 Influence of the amplitude A of the applied pressure . . . . . . .                            75
             3.3.2.3 An optimal range of frequencies . . . . . . . . . . . . . . . . . .                           75
             3.3.2.4 Stress in the mucus in the optimal configuration. . . . . . . . . .                           76
      3.3.3 Airflows at mouth induced by HFCWO for the range of healthy lungs
             resistances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                   77
      3.3.4 Idealized HFCWO for non-healthy lungs models . . . . . . . . . . . . . .                               78
      3.3.5 Estimation of the operational hydrodynamic resistance of the airway tree
             from HFCWO mouth airflow . . . . . . . . . . . . . . . . . . . . . . . . .                            79
      3.3.6 Estimation of the compliance using the fundamental frequency . . . . . .                               80
  3.4 Discussions and conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                     80
  3.A Behaviors of the solution according to the dimensionless parameters . . . . . . .                            83
  3.B Extension of the definition of the dimensionless parameter E . . . . . . . . . . . .                         84
      3.B.1 Numerical simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                         84
      3.B.2 Alternative definition of the dimensionless parameter E . . . . . . . . . .                            86
  3.C A one degree of freedom equation. . . . . . . . . . . . . . . . . . . . . . . . . . .                        86
  3.D Estimation of the stress in the mucus layer induced by the airway walls oscillations                         87
      3.D.1 Estimation of the evolution of the airways radii . . . . . . . . . . . . . . .                         88
      3.D.2 Estimation of the stress in the mucus layer . . . . . . . . . . . . . . . . .                          89
  3.E Operational resistance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .                     90

4 Towards the improvement of the model of the lungs                                                                91
  4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .           .   .   .   .   92
  4.2 Hypotheses of the model . . . . . . . . . . . . . . . . . . . . . . . . . . . .              .   .   .   .   92
      4.2.1 Assumptions of the tree region . . . . . . . . . . . . . . . . . . . .                 .   .   .   .   92
             4.2.1.1 Considering circulation of air in the pulmonary tree . . .                    .   .   .   .   92
             4.2.1.2 Towards more realistic geometries of the respiratory tree                     .   .   .   .   93
      4.2.2 Assumptions about the lung’s parenchyma . . . . . . . . . . . . . .                    .   .   .   .   93
             4.2.2.1 On the heterogeneity of the lung’s parenchyma . . . . . .                     .   .   .   .   94
             4.2.2.2 Spatial composition of the thorax . . . . . . . . . . . . .                   .   .   .   .   94


Contents                                                                                              ix


        4.2.3 To an enhanced model of the mucus . . . . . . . . . . . . . . . . . . . . .                  95
  4.3   Towards the modeling of the lungs with 3D geometries . . . . . . . . . . . . . . .                 96
        4.3.1 Three dimensional geometries of the lungs . . . . . . . . . . . . . . . . . .                97
        4.3.2 Solving the 3D model using the finite element library deal.II . . . . . . .                  98
                4.3.2.1 Quick presentation of the library deal.II . . . . . . . . . . . . . .              98
                4.3.2.2 Multi-dimensional formulation . . . . . . . . . . . . . . . . . . .                98
                4.3.2.3 Numerical scheme . . . . . . . . . . . . . . . . . . . . . . . . . .               99
                4.3.2.4 Overview of the implementation of the finite element method in
                          deal.II . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .    100
        4.3.3 The splitting method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .         101
                4.3.3.1 The splitting method . . . . . . . . . . . . . . . . . . . . . . . .           102
                4.3.3.2 The splitting method for the model of the lungs . . . . . . . . .              102
                4.3.3.3 Some preliminary feedback on the use of the splitting method .                 104
  4.4   Investigation of the efficiency of a HFCWO device through a clinical study . . . .             105
        4.4.1 Method and protocol . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .          107
        4.4.2 Preliminary results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .        108
        4.4.3 On the perspectives of the clinical study . . . . . . . . . . . . . . . . . . .          113

5 Conclusion                                                                                          115


x   Contents


Chapter      1
Background of the study and
objectives




"Les poumons sont placés dans un sanctuaire sacré, dans un lieu tellement caché, qu’il semble
     que la nature se soit appliquée à abriter ces organes contre l’observation directe des yeux,
                           l’intelligence et l’industrie des hommes."
                                                                                    John Mayow,
                                                          Traité deuxième de la respiration, 1668.

        From Traduction des oeuvres chimiques et physiologiques de Jean Mayow, 1840, p.100.




Contents
       1.1    Introduction      . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       2
       1.2    The human lungs         . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       2
             1.2.1   Anatomy and characteristics . . . . . . . . . . . . . . . . . . . . . . . .         2
             1.2.2   Mechanics of breathing . . . . . . . . . . . . . . . . . . . . . . . . . . .        6
       1.3    Protection against respiratory diseases . . . . . . . . . . . . . . . . .                  8
             1.3.1   Mucus : characteristics and role     . . . . . . . . . . . . . . . . . . . . . .    8
             1.3.2   Respiratory diseases . . . . . . . . . . . . . . . . . . . . . . . . . . . . .      9
       1.4    The chest physiotherapy . . . . . . . . . . . . . . . . . . . . . . . . . .                9
       1.5    Objectives of the thesis . . . . . . . . . . . . . . . . . . . . . . . . . . .            10


   2                                                    Background of the study and objectives


1.1     Introduction
The oxygen is one of the essential elements needed by almost all the living multicellular organ-
isms. It composes twenty percents of the ambient air in the form of dioxygen (O2 : two atoms of
oxygen). In specific cells, the dioxygen reacts with the glucose to produce carbon dioxide (CO2 ),
water and the Adenosine Triphosphate (ATP) molecule which stores the energy, a fundamental
molecule of the metabolism. This reaction, called the cellular respiration, happens every second
in the millions or billions of those cells that compose large and complex organisms, such as ani-
mals. Consequently, they have to maintain a necessary concentration of those reagents (O2 and
glucose) according to the energetic needs and in order to eliminate non-useful products (CO2 ).
    Focusing on human, two complex and intertwined structures of distribution act for that
purpose : the blood network and the lung. The role of the blood network is to carry the oxygen
and glucose toward the cells and to collect the carbon dioxide they produce, thanks to the heart
that set the cadence of the blood circulation. The glucose is brought directly into the blood
mainly by general nutrition (it is also produced by the liver in lower quantity). Meanwhile, the
oxygen has to pass from the air to the blood and the carbon dioxide has to do the way around.
This complex task is performed in the lungs while breathing.
    The lung is an organ which is in direct contact with air. Consequently, it is a place easily
accessible for bacteria, virus (recently : SARS-CoV-2„COVID-19) or airborne pollutants. The
lung has developed ways to protect itself, as for example cough with the mucus. The mucus is
a secretion lining the interior of the lungs which catches such intruders. It is then evacuated to
the outside of the lung by cough. However some pulmonary diseases alter the proper evacuation
of the mucus. Hence therapeutic methods have been developed to overcome this dysfunction
such as chest physiotherapy.
    This thesis aims at studying the lung in the framework of a therapeutic technique of chest
physiotherapy called High Frequency Chest Wall Oscillation. The main tools used for that
purpose are mathematical modelling and numerical simulation. This thesis has been funded
by RespInnovation SAS (Seillans, France) and the Enseignement supérieur, de la recherche et
de l’Innovation by a CIFRE contract managed by the Association nationale de la recherche et
de la technologie (ANRT). This work is a collaboration between RespInnovation SAS (Seillans,
France) and the Laboratoire Jean Alexandre Dieudonné (Nice, France).
    This chapter introduces the context of the study and the motivations. The human lungs,
is detailed in section 1.2. The section 1.3 details how the structure of these organs has to be
protected against any external pollutants to avoid infections and diseases. In the section 1.4, we
explain the chest physiotherapy technique, used in the frame of obstructive respiratory diseases.
Finally, the objectives of this thesis are presented in the section 1.5.


1.2     The human lungs
The main role of the lungs is to perform the exchange of gases between the blood and the ambient
air. Millions of years of evolution have steered these organs toward maximizing the exchange
surface in small volumes while minimizing the thickness of the interface, and the result is the
tree-like structure of the lungs described in subsection 1.2.1. Then, the correct flows of gazes
inside the tree is ensured by breathing , see subsection 1.2.2. As stated in [58, 76], we notice that
the lungs have other functions as filter and reservoir of blood, metabolizer of some vasoactive
substances or the phonation, which will not be discussed in this manuscript.

1.2.1     Anatomy and characteristics
   Around the lungs. The lungs are composed of two parts, the left lung and the right lung
that are respectively formed of two and three lobes. They are located inside the thorax1 , and
   1
    Interestingly, the term thorax signifies "breastplate" in the ancient greek language, and contains the main
important organs (lungs and heart) operating in the cardiovascular system (also called the circulation system).


The human lungs                                                                                 3


share the space protected by the rib cage with, among others, the heart and the esophagus.
Under them, a skeletal muscle separating the thorax from the abdomen, called the diaphragm,
is tied to the lungs and participate in breathing. The rib cage consists of twelve pairs of ribs
hinging on the spinal column and the sternum. With a partly cartilaginous constitution, it has
a flexible structure that can easily follow all the thoracic movement during the lung ventilation.
The intercostal space, between the ribs, contains essentially the intercostal muscles.
    The external surface of the lungs and the internal part of the rib cage are covered with the
pleura containing a cavity, called the pleural cavity, filled with a fluid at subatmospheric pressure
(a negative pressure in comparison to the atmospheric pressure). The role of the pleura is to
ensure the interconnected movements of the lungs and the rib cage during breathing. Sketches
of the thorax is illustrated in the figure 1.1.




Figure 1.1: Illustrations of the thorax. Top left: Front view of the rib cage. Top right: Side
view of the rib cage with the intercostal muscles. Bottom left: Front view of the external
surface of the lungs surrounded by, among others, the pleural cavity, the rib cage and the
intercostal muscles. The five lobes of the lungs are visible. Bottom right: Front view of the
inside of the thorax without the lungs. Are mainly displayed the heart in its pericardial sac and
the diaphragm. Adapted from [55], hand-written by [133].

    In the interior of the lungs. The path of the dioxygen through the lungs, from the
ambient air to the exchange surface with the blood, is winding. The journey of the dioxygen
(opposite journey for the carbon dioxyde) begins at the mouth and the nose, and goes through
pharynx and larynx to reach the trachea, a fibrous and cartilaginous pipe which is the entrance
to the pulmonary airways. In the depth of the trachea, dioxygen is carried to one of two possible
directions : to the left lung or to the right lung. There, the ducts are narrower than the trachea


   4                                                    Background of the study and objectives


and are called bronchi. No matter the way, the rest of the trip will bring the molecule to take one
direction over two several times to reach the exchange surface with pathways becoming smaller
and smaller as sinking in the tree. This illustrates the tree-like structure of the pulmonary
tree which is detailed in the next paragraph. Following the tree-like of the human pulmonary
tree to its depths, the bronchi become bronchioles, terminal bronchioles and finally respiratory
bronchioles, which are the first branches of the acinar region. An acinus is the lung’s element
that acts as the gas exchanger. An acinus is composed of alveolar ducts leading to alveolar sacs.
At the acinar level, the size of the airways2 does not decrease much at bifurcations. Respiratory
bronchioles are partially covered with alveoli whereas alveolar ducts and alveolar sacs are fully
covered with it. The pulmonary alveoli, as its latin origin indicates3 , are small cloud-shape cav-
ities whose membrane, surrounded by blood capillaries, is the exchange surface with blood. An
alveolus is the unit base of gas exchange. The trachea is about 10cm long for barely 2 cm of di-
ameter. The diameter of an alveolus is about 400µm for a length of 500µm [76], see the figure 1.2.

    The pulmonary tree. The trachea is the root branch, or the mother branch, of the pul-
monary network that branches globally in a way that can be seen as nearly dichotomous. In
other words, two daughter branches with smaller size stem from the trachea and each of them
divides into two smaller daughters branches and so on and so forth. The connection between
the mother and the daughters branches is called a bifurcation. We call by generation all the
branches resulting from a same number of bifurcations. The pulmonary airways do not branch
symmetrically, i.e. two daughters can have different sizes. Hence, the number of bifurcations
between different pathways from the trachea to the acini can be different. The total number
of generations in the pulmonary tree vary from eighteen to thirty [40] ; this is mainly due to
the physiological differences between the individuals. Nevertheless, commonly in the literature
[135], it is estimated to be of about twenty-three. From that perspective, we can estimate that
the pulmonary tree is being composed of about 224 ´ 1 branches (more than sixteen millions)
including 223 terminal branches at the last generation (more than eight millions).

    Approximately, the part of the pulmonary tree from the generation one to the generation
sixteen constitutes the bronchial tree or, by adding the trachea (at the generation zero), the
tracheo-bronchial tree. Then the region consisting of the generation seventeen to twenty-three
(more or less) is the respiratory zone, see the figure 1.2.

    The bronchial tree. The main role of the bronchial tree is to conduct dioxygen and
carbon dioxyde between the ambient air and the respiratory zone. It is called the conductive
zone and the air inside is transported by convection and diffusion4 [76, 58, 98]. In the proximal
(close to the trachea) and central part of the bronchial tree, the main conducting transport
is the convection. While sinking in the tree, the cumulative volume of the airways increases.
Hence, the air velocity reduces progressively towards the distal part of the tree (far from the
trachea) and a transition between convection and diffusion occurs. Typically, at a given point,
the diffusion becomes the dominant transport phenomenon in front of the convection. Actually,
this transition could occur either in the deepest part of the bronchial tree or in the respiratory
zone. It relies on the morphology of the lung and on the ventilation intensity [99]. The bronchial
tree does not participate in the gas exchanges. This remark leads to call the volume of all the
bronchi and the bronchioles of this region, the dead space. The mean volume of the dead space
is generally about 150 mL [76]; their value can differ between individuals [78]. All the airways in
the bronchial tree are covered by smooth muscles. Although its main role is generally associated
with the control of the opening of the airways, the physiological function of the smooth muscle
remains not clear as of today [22, 8].
   2
     In this work, the term airway is used to designate any anatomical element of the pulmonary tree such as the
bronchus, the bronchioles, etc. It is a general duct in the tree structure of the lungs.
   3
     In latin language, alveolus means "little cavity".
   4
     The convection is the transport of a quantity due to the neighboring speed. The diffusion designates the
capacity of an environment to homogenize its composition that lead to the motion of the particles.


The human lungs                                                                                 5




Figure 1.2: Schematic and illustrative representations of the dichotomous structure of the pul-
monary tree. Left: Taken from [76]. Right: Painting of the first generations of the bronchial
tree with a idealised zoom of an acinus. Adapted from [55, 127], hand-written by [133].


    In the bronchial tree, the length and the diameter of the branches decrease as the generation
index increases. Hence the way the branches size is decreasing acts on the shape and on the
properties of the tree. The lungs tend to maximise the exchange surface in a finite volume
while minimizing the resistance of the air flowing inside [136]. Thus, the branches reduction at
bifurcations tends to be homothetic with an optimal reduction factor. The Hess-Murray law
established in 1914 tells that to minimize the resistance of the flow of air inside a finite volume,
                                                                                            1
the reduction factor through the generations has to be constant and equal to h “ p 12 q 3 « 0.79
[80]. In reality, the bronchial tree is adapted to the available space around him and the airways
rather branch asymmetrically. On average through the generations, the human lungs exhibit
a homothetic coefficient slightly larger than h. Interestingly, this shift corresponds to a safety
margin that might allow anatomical variations between individuals or that might compensate
variations of the bronchi calibers during the life of an individual [80].
    The use of idealized models of the lung simplifies the complexity of the organ structure and
facilitates its modeling. The homogeneous model of bronchial tree proposed by Weibel [135],
extensively used in the literature [123, 98], uses the optimal factor h « 0.79 and makes the
assumption that the bronchial bifurcations are symmetrical. Thus the tree-like structure is con-
sidered perfectly dichotomous and symmetrical, i.e. the reduction factor does not vary through
the generations and is the same at a given generation.

    The respiratory zone. The respiratory zone is the part of the lungs involved directly in
gaz exchanges. It contains all of the respiratory bronchioles, the alveolar ducts and the alveolar
sacs. The bronchioles and the alveolar ducts also adopts a tree structure but their sizes does
not change that much after bifurcation. There, the flow of air, brought by convection and
diffusion through the bronchial tree, is very slow and, in general, the main phenomenon acting
for that purpose is the diffusion [76, 58, 98]. Actually, in the respiratory zone, the diffusion
is dominant toward the convection for low ventilated volume, as for ventilation at rest. The
acini are contained in a viscoelastic medium called the lung parenchyma. A dense network of
blood capillaries surround all the surface of the lung parenchyma which is the region where the
dioxygen passes from the air to the blood. The opposite mechanism unfolds for the carbon


  6                                               Background of the study and objectives


dioxide. The phenomenon ensuring the gaz transfer is also the diffusion. The alveolar–capillary
barrier is the interface between the air and the blood, with a thickness of about 0.2 to 0.5 µm
[76], namely at least 50 times thinner than the thickness of a sheet of paper. Thanks to the
tree-like of the pulmonary airways, the surface of all the alveoli reaches around fifty to a hundred
square meters. Those dimensions are necessary to fulfill the metabolic needs and to enable peaks
of energy consumption during activities.




Figure 1.3: Illustrations of a semi-opened lungs (left) and a cut view of an acinus (right).
It proposes a glimpse of the complex interconnection between the pulmonary and the blood
networks. Adapted from [55], hand-written by [133].

    We have described the anatomical elements composing the human lungs with some of their
properties. The exchanges of oxygen and carbon dioxide have to be continuously assured to fulfill
the metabolism energetic needs. The mechanism making this process possible is breathing, also
named ventilation.

1.2.2    Mechanics of breathing
Breathing is the mechanism ensuring the transport of gas into and out of the pulmonary tree,
necessary for a proper control of the concentration of oxygen and carbon dioxide in blood. The
ventilation is often characterized by a flow rate in mL/s. At rest, the lungs ventilate about 500
mL per respiratory cycle, called the tidal volume [76]. By subtracting the dead space, which is
not involved in the gas exchanges, the effective volume is about 350 mL.
    Breathing relies on the principle that a difference of pressure between two connected envi-
ronments leads the molecule of a Newtonian fluid to move from the higher pressure environment
to the lower one. Hence, regarding the human lung, in order to create a movement of air (an
air flow) from the ambient air to the exchange surface, the pressure inside the lungs has to be
lower than the pressure of the ambient air (depression). Typically, it is performed by increasing
the volume of the lungs. The opposite action of decreasing the volume of the lungs increases
the pressure inside (overpression) and produces a flow of air from the lungs to the outside.
    Mechanically speaking, different agents take part in the pulmonary ventilation and partici-
pate in the volume change of the lungs. One of the main actor is the diaphragm. Being attached
at the bottom of the lungs and the rib cage, its contraction leads the lungs to stretch and to


The human lungs                                                                                                    7


increase its volume, thanks to the elastic properties of the pulmonary tissues. Then, the inter-
costal muscles help the action of the diaphragm to act on the outward displacement of the rib
cage. The lungs, being connected to the rib cage by the pleura, follow the movement of the
bones and also stretch sideways. Hence, the induced advection of air inside the lung, called the
inspiration, is an active phenomenon because it is caused by controlled muscular efforts. At
rest, the expiration (the evacuation, to the outside, of the air inside the pulmonary airways)
is based on a different mechanism. The lungs, acting as an elastic medium, tend to return to
their initial state (before inspiration) after having been stretched by inspiration. Hence, globally
during tidal breathing, the different muscles involved during inspiration relax and release the
lungs that go back to their resting state and, consequently, decrease back the pulmonary volume.
Thus, at rest, the expiration is a passive phenomenon because it is not directly controlled by
muscles. Nevertheless, the muscles involved in the inspiration may hold the lungs back during
expiration to not let them go back too quickly [76]. During exercice5 , the main difference is
that both inspiration and expiration are active phenomena. Specifically, the diaphragm and
the intercostal muscles, also helped by the abdominal muscles, accompany the reduction of the
pulmonary volume.




Figure 1.4: Graphic representations of the main bio-mechanical phenomena during inspiration.
Taken from [109].

    The pleura has a specific role during breathing [76]. Mainly, it links the motion between the
lungs and the rib cage. The pleural liquid, the fluid in the pleural cavity, lubricates the two
layers and consequently favours the sliding movement between the lungs and the rib cage. In
addition, as mentioned in the previous subsection, the intrapleural pressure in the pleural cavity
is negative, which allows to maintain a proper functioning of the ventilation6 . The negative
pressure maintains equal two pressures : the transpulmonary and the transthoracic pressures.
The transpulmonary pressure is the pressure across the lungs wall, it is the difference between the
alveolar pressure and the intrapleural pressure. The transthoracic pressure is the pressure across
the chest wall, it is the difference between the intrapleural and atmospheric pressures. Moreover,
the difference in pressure across an interface is called a transmural pressure. Going back to the
topic, at the end of the expiration, the alveolar pressure is the same as the atmospheric pressure
    5
      The human state designated by "exercice" indicates the state when the energetic needs are higher than at
rest and they are relative to the effort intensity.
    6
      If the pressure inside the pleural cavity is null (or positive), and for example if it is connected to the ambient
air by an injury, the lungs would collapse and the rib cage would extend, due to the inward elastic recoil of the
lungs and to the outward elastic recoil of the rib cage; this pathology is called pneumothorax.


  8                                                Background of the study and objectives


that act on the thorax. As the intrapleural pressure is negative, the transpulmonary and the
transthoracic pressures are acting on each other in opposite direction, the pressures balance
each other out. The chest wall holds the alveoli open and the lungs hold the chest wall in.
During inspiration, the muscles pull and tend to increase the volume of the thoracic cavity. The
intrapleural pressure becomes more negative, the transmural pressure increases and the alveoli
enlarge. The alveolar pressure becomes negative and establishes the needed pressure gradient for
air to flow in. Several studies have shown that even the alveoli located in the center of the lungs
are sensitive to the variation of the transmural pressure by their interdependence structure, i.e.
their mechanical dependence due to their geometric shape [76].
    Another essential element is the pulmonary surfactant [76]. If we take a look at the alveoli
structure, we can observe that a liquid lines their surface and that their volume may differ.
Consequently, due to the surface tension between the air inside and the liquid around them as
well as the elastic property of their tisue, the smaller alveoli would collapse in favor of the bigger
one which would expand. The pulmonary surfactant diminishes this tension and keeps opened
all the alveoli during expiration by equalizing the different pressures inside. Moreover it helps
the widening movement of the alveoli during inspiration and consequently reduces the work of
breathing [62, 76]. Like the mucus, it is one of the pulmonary secretion which also participates
to the protection of the body against pollutants and infections.


1.3     Protection against respiratory diseases
The previous sections show the complexity of the structure and the functioning of the lungs.
We can understand already how a defective link in the chain of the pulmonary bio-mechanical
mechanisms can be the cause of respiratory diseases. We have seen that the lungs have evolved to
facilitate and to optimize the gases exchanges with the blood. However, the lungs form a direct
interface with ambient air and is thus sensitive to aggression by airborne pollutants, bacteries,
virus, etc.


1.3.1    Mucus : characteristics and role
The mucus, also produced in other organs as the vagina or in the gastrointestinal tract, is a
gel-like substance lining the inner surface of the tracheo-bronchial tree. The mucus protects
the lungs and the body by trapping all kind of foreign particles. It is present in most of the
bronchial tree [56] as a thin layer of about 10 µm [59]. The mucus is a viscoelastic fluid whose
main property is to exhibit a yield stress that has to be overcome for the mucus to flow. In broad
terms, it behaves as a solid at low stress and as a liquid at high stress. The order of magnitude
of the yield stress σ0 for an healthy mucus is typically σ0 » 0.1 ´ 1 Pa [70, 83, 84]. The mucus is
composed of more than 90% of water and 1 to 5% of mucins [102], a protein that forms a slimy
polymeric substance when hydrated. The rest of the structure contains macromolecules. The
mucus is continuously secreted by the lungs, and the secretion rate increases during the intrusion
of non wanted particles or during exercice that stimulates the bronchi wall. Consequently, it
has to be expelled from the bronchial tree to evacuate the pollutants and to avoid constriction
of the pulmonary airways.
    Two main natural mechanisms participate in the airway mucus clearance, i.e. the evacuation
of the mucus : the mucociliary clearance (MCC) and cough. First, the cilia, a slender hair-like
structure or organelle lining the inner surface of the bronchial airways, propels the mucus from
the distal to the proximal airways by their rhythmic and synchronous beating. This beating
motion carries the mucus to the larynx where it is usually swallowed or expelled by coughing.
The ciliary beating is facilitated by an airway surface liquid that lubricates the inner sol layer
of the respiratory tracts. The mucociliary clearance corresponds to the combination of the
proper quality of the airway surface liquid and the ciliary beating [17]. The second mechanism
is cough that induces strong air flows in the bronchi. Cough is the most efficient phenomenon to


The chest physiotherapy                                                                                           9


expectorate the mucus from the proximal airways. However, those mechanisms7 can be altered
and impeded by some pulmonary diseases.


1.3.2     Respiratory diseases
The main symptom of the pulmonary diseases is breathlessness, for example in Chronic Ob-
structive Pulmonary Disease (COPD) or asthma [94, 15]. Typically, for those diseases, it comes
from the obstruction of the airways due to the inflammation of the pulmonary tissue, to mucus
hypersecretion, or to the contraction and the hypertrophy of the smooth muscle [117, 14, 94].
The COPD damages also the alveolar sacs by diminishing their elastic capacity, even to the
point of making them no longer operational. It leads to parenchymal destruction and this is
called the emphysema. Those factors causes limitations in the circulation of the air inside the
airways, coughs, and wheezing. Wheezing symptom is also a typical sign of bronchiolitis in
infants and young children. The etiology identifies different causes for those diseases. In most of
the cases, bronchiolitis is due to viruses whereas smoking, generally, is the cause of COPD. For
asthma, not well known and understood as of today, several origins are pointed out, tied to the
environment and lifestyle, such as exercise, emotional stress, air pollutants, etc, as enumerated
in [139]. Mutations in genes can also lead to an abnormal functioning of the lungs. For example,
Cystic Fibrosis (CF) is a genetic disease that disturbs the hydration of the mucus inside the
pulmonary airways making it too thick and sticky, and thus, hard to move. The Primary Ciliary
Dyskinesia (PCD), also due to the mutation of a gene, disrupts the capacity of the pulmonary
cilia to move the mucus. In both cases (CF and PCD), the disease allows the bacteria to remain
in the respiratory tracts, and increases the risk of infections and reduces the bronchi lumen8
area, hence altering the circulation of the air inside the bronchial tree.
     None of the diseases cited above is easily curable. Treatments mainly help people affected
by respiratory disease in their day-to-day life by reducing their symptoms. Several treatments
are prescribed or advised, such as drugs9 , oxygen and ventilatory support, change in lifestyle
habits10 , or manual therapy [103]. This manuscript focuses on one of those techniques, the chest
physiotherapy, that is detailed in the next section.


1.4      The chest physiotherapy
The chest physiotherapy (CP) is a term referring to a large range of physical and mechanical
therapeutic methods administered to patient with respiratory disorders [128]. CP favours the
mobilization11 and the removal of excess accumulation of pulmonary secretions in the tracheo-
bronchial tree. It consists in changing the volume of the lungs to produce mechanical stresses
and air flows in the respiratory airways that can, potentially, affects the secretions and move
them. The methods can be identified by one of the two following groups or both groups : the
one that mobilizes the secretions and/or the one that transports it [128, 21]. Depending on the
pathology, they are also often combined together for optimal efficiency [128]. In addition, it
might also bring the work of breathing closer to its healthy state, improving oxygenation and
exercise tolerance [51].

   Actually, CP is also named without clear distinction respiratory physiotherapy, pulmonary
physiotherapy or most of the time airway clearance technique [68, 21, 100]. To the best of my
knowledge, all terms are used and can be used similarly. It seems that chest physiotherapy was
    7
      More specifically, the mucus clearance relates to the synchronisation of different factors : ion transport, water
flow, mucin secretion, cilia action, and cough [18].
    8
      Meaning ’light’ or ’an opening’ in the Latin language, the lumen, in biology, is the interior of tubular
structures.
    9
      We refer, for example, to bronchodilators or anti-inflammatory agents.
   10
      It consists in identifying and reducing exposure to risk factors, such as smoking, allergens or even stress.
   11
      The mobilization of the mucus refers to the different actions that act on setting the mucus in motion.


  10                                             Background of the study and objectives


one of the first statement introduced in the 1960s in order to describe the conventional and tra-
ditional method, i.e. performed by a physiotherapist [128]. It may appear that the development
of new mechanical devices performing automated CP has led to rather employ the term airway
clearance technique [100]. Nevertheless, recent studies used both terms equivalently. Then, the
distinction between the methods is emphasized by the use of adjectives such as conventional,
manual, self-administred or mechanical.

    The chest physiotherapy can be either performed autonomously by the patient, manually
by a practitioner or automatically by specific mechanical devices. We can cite, as typical self-
administered methods, the autogenic drainage [1] or huffing (also called forced expiratory tech-
nique when combined with breathing control) [4]. One of the main manual therapies involve
chest percussion or vibration techniques and consist on applying either clapping pressures or
vibrating pressures on the patient’s chest with hands. However the two latters are not rec-
ommended anymore as showing a lack of efficiency [108]. Manual CP also refers to postural
drainage or breathing control [128]. Those traditional techniques request either human and
geographic dependencies or an active concentration from the patient, that can lead to the aban-
donment of the therapy [50, 68]. Hence, since a few decades, mechanical devices are often
favored or used as a complement of other methods. Many of these devices apply pressures in
or on the lung to help the draining of the mucus, such as the Positive Expiratory Pressure
technique (PEP), the Intrapulmonary Percussive Ventilation (IPV), the high frequency chest
compression (HFCC) or the High Frequency Chest Wall Oscillations (HFCWO), and seem to
be quiet effective [65, 24, 50, 30, 96]. However, the democratization of these devices has led
to the development of several new automated methods, but has animated the debate about the
choice of the respiratory physiotherapy technique that is best adapted to the pathology or to the
patient, with optimal functioning parameters. Indeed, there is, as of today, a lack of evidence
regarding the efficiency of these mechanical devices since the knowledge of their therapeutic
effects remains mainly empirical [89, 93, 29, 68, 97, 115]. However, as highlighted in [45], the
absence of evidence does not necessarily mean an absence of benefit but further appropriate and
methodological studies, along with validation and improvements, are needed to bring new clear
insights.
    In this work, we will particularly focus on the HFCWO technique. We define the HFCWO
method as the technique that applies relatively small pressure at high frequency - about five to
twenty-five Hertz - at localised spots on the thorax [96]. In the frame of the CIFRE contract, we
had a full access to the HFCWO device of RespInnovation SAS called RespIn 11 (RespInnovation
SAS, Seillans, France), see Figure 1.5. The jacket (blue), called the Wrap (RespInnovation SAS,
Seillans, France), is worn by the patient during the therapy. The Wrap contains two lines of
pistons at the front and three lines of pistons at the back. The main device (white and orange)
is connected to the lines of pistons in the Wrap with five medical tubes, two for the front part
of the Wrap and three for the back part of the Wrap. A strong blower in the main device
feeds with air the pistons which inflate. The depression is made by rotating valves in the main
device. By rotation, the valves connect successively the pistons with the ambient air, then the
pistons with the blower, and so on. Consequently, the pistons inflate and deflate according
to the frequency of the rotating valves. The pressures applied by the device come from the
pistons inflation/deflation process. All the lines of pistons in the Wrap do not inflate/deflate
synchronously. The back and the front parts are controlled independently by one valve. Then
for each part, the lines inflate/deflate asynchronously.


1.5    Objectives of the thesis
The previous sections presented the need to study and understand the effects of mechanical
devices of chest physiotherapy on the lungs. They also showed the complex tree-like structure
of the lungs which highlights the intricate nature of its study. Several measurement tools can
assess some lungs properties and are quite efficient [109]. For example, the ventilated flow and


Objectives of the thesis                                                                    11




Figure 1.5: Mechanical device of chest physiotherapy called RespIn 11 using High Frequency
Chest Wall Oscillation technique. It is developed and commercialized by RespInnovation SAS,
Seillans, France. Left:    The jacket called Wrap (blue) with the controller device (orange
and white). Right: Lines of pistons contained in the Wrap. The front part of the jacket
contains two lines and the back part contains three lines. The pictures have been provided by
RespInnovation SAS.


volume of air can be measured with spirometer, or a plethysmograph can measure resistance
to air flow in the lungs. However, although being useful, such measuring instruments inform
only on global properties of the lungs and not on local behaviors in the pulmonary tree. More-
over, as discussed previously, the results proposed by clinical studies (using such instruments)
do not allow to infer on the efficiency of mechanical devices of chest physiotherapy. Hence,
the use of mathematical modeling and of numerical simulations can be useful. Mathematical
modelling allows to cut the complexity of a problem to favour its global comprehension. How-
ever, mathematical modelling is not the magic remedy. This science is based on hypotheses
and, usually, it produces only estimations or predictions. Nevertheless, mathematical modelling
has been often used in the framework of the lungs and has demonstrated its strength by the past.

    Hence, a mathematical model is used in this thesis to bring new insights on the use of chest
physiotherapy and particularly of High Frequency Chest Wall Oscillation (HFCWO) technique.
For that purpose, we build a model of the lung inspired from the literature. In this work, this
model has been studied, validated and applied to HFCWO. Ways to improve the model have
also been investigated. It is following those steps that this thesis is written.

    The chapter 2 presents the model of the lung and the way to solve it numerically. The model
is based on the coupling between two models : a zero dimensional quasi-fractal tree mimicking
the bronchial tree and a multi-dimensional linear and isotropic elastic medium mimicking the
lung’s parenchyma. The tree submits damping pressures at localized areas in the elastic medium,
which affects the material deformation. In order to have a better comprehension of the model in
three dimensions, we analyze thoroughly the model in one dimension which is more tractable.
The model is first studied on idealized non-physiological cases. We analyze the effect of the tree
on the deformation of the material. We show that the tree alters the natural modes of vibration of
the material and consequently, the resonance of the material. Resonance relates on the capacity
of a vibrating system at amplifying its motion according to the pulsation of a driving force. This
phenomenon presents interesting features for HFCWO. The chapter introduces the resonance
phenoman which is used in the chapter 3. The model is then applied to model the ventilation
at rest for idealized healthy and non-healthy lungs. This application allows to validate the
model. It allows also to tune the set of parameters to get model predictions compatible with


  12                                              Background of the study and objectives


the physiology of the lungs. This configuration is then used to apply the model to HFCWO.
    The chapter 3 presents the application of the model to the HFCWO. It also describes a dimen-
sionless formulation of the equations of the model, which raises two dimensionless parameters.
Those dimensionless parameters inform on the different interactions between the parameters of
the model. This chapter also presents a simplified formulation of the model, which is based on
the theory of harmonic oscillators. This formulation proposes a parameter known as the quality
factor, which relates the intensity of the damping of the tree to the deformation of the elastic
material. It informs particularly on the properties of resonance of the material. The model
is then applied to an idealized HFCWO. The model suggests that a frequency can maximize
the air flows in the tree induced by the deformation of the material during a HFCWO therapy.
This frequency is related to the fundamental natural frequency of the material. We also show
that this frequency, computed from lungs data taken in the literature, is in accordance with the
resonance frequency of the respiratory system measured in the literature. Finally, we propose
the use of HFCWO as an non-invasive tool to measure lungs resistance and compliance.
    The chapter 4 proposes future perspectives of improvement of the model and shows prelimi-
nary results. It discusses the hypotheses of the model and proposes a splitting method to reduce
computational time of the numerical simulations. It also presents the setup of a clinical study
that aims at investigating the efficiency of a HFCWO device. Particularly, this study takes an
interest on measuring the air flows at mouth induced by the HFCWO therapy isolated from the
ventilation flows. Indeed our model suggests that a resonance frequency may exist for the lungs,
and might be measured from the mouth air flows induced by HFCWO. This experimental setup
aims at studying the theoretical results in a clinical framework.

   Part of this work is the the topic of a scientific article, submitted :

    Optimal efficiency of high frequency chest wall oscillations and links with resis-
tance and compliance in a model of the lung - Michaël Brunengo, Barrett R. Mitchell,
Antonello Nicolini, Bernard Rousselet, and Benjamin Mauroy. arXiv:2108.02437 [physics.med-
ph]


Chapter       2
Modelling the lungs to simulate tidal
breathing for healthy and
non-healthy lungs

"Puisque l’air nous est si absolument necessaire, il étoit bon que nous pussions nous en fournir
          pour quelque temps, & cet avantage nous a été assés adroitement ménagé."
                                                                   Jean Claude Adrien Helvetius,
                                         Histoire de l’Académie royale des Sciences, 1718, p.14.


Contents
        2.1    Introduction      . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     14
        2.2    The model of the lungs . . . . . . . . . . . . . . . . . . . . . . . . . . .            14
              2.2.1   Modelling the air flow in the tree region . . . . . . . . . . . . . . . . . .    15
              2.2.2   Modelling the mechanics of the respiratory region . . . . . . . . . . . . .      18
              2.2.3   Weak formulation of the system of equations . . . . . . . . . . . . . . .        20
            2.2.4 Numerical method : the finite element method . . . . . . . . . . . . . . 21
        2.3 The unidimensionnal formulation of the model of the lungs . . . . . 23
              2.3.1   Unidimensional formulation . . . . . . . . . . . . . . . . . . . . . . . . .     23
              2.3.2   The finite element method and numerical scheme . . . . . . . . . . . . .         24
              2.3.3   Analytical solution of the unidimensional model      . . . . . . . . . . . . .   25
        2.4    Study of the coupling between the tree and the elastic material
               through non-physiological numerical simulations . . . . . . . . . . .                   28
              2.4.1   Effect of the tree structure on the propagation of the wave deformation          29
              2.4.2   The resonance phenomenon in the coupled model . . . . . . . . . . . . .          33
        2.5    Rest ventilation of healthy and non-healthy lungs . . . . . . . . . . .                 38
              2.5.1   Calibration of the model using rest ventilation . . . . . . . . . . . . . .      38
              2.5.2   Tidal breathing between individuals with healthy lungs . . . . . . . . .         41
              2.5.3   Tidal breathing for non-healthy lungs . . . . . . . . . . . . . . . . . . .      41
        2.6    Discussions and conclusion . . . . . . . . . . . . . . . . . . . . . . . . .            48
        2.A Details of calculation for the resistance of the tree . . . . . . . . . .                  50
        2.B Finite element method . . . . . . . . . . . . . . . . . . . . . . . . . . .                51
              2.B.1 An example of FEM calculation in 1D : the Mass matrix            . . . . . . . .   52
        2.C Angular eigen-frequencies . . . . . . . . . . . . . . . . . . . . . . . . .                53
        2.D A case of damped harmonic oscillator with one degree of freedom .                          54
        2.E Configurations of parameters for the numerical simulations . . . . .                       57


       Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  14                                                                         lungs

2.1    Introduction
As discussed in the first chapter of this manuscript, the HFCWO technique is a therapeutical
method based mainly on empirical knowledge. During a HFCWO procedure, both ventilation
and the action of the therapy act on and in the lungs. Hence, the comprehension of the global
behavior of the lungs during HFCWO can be facilitated by studying separately each influence
- ventilation and HFCWO. In this chapter, we take an interest first and foremost mimicking
healthy and pathological lungs to which HFCWO is primarily dedicated to. For these different
cases, we model the ventilation at rest. Prior to that, this chapter introduces the construction
of the model of the lungs that we will use in this manuscript. We dedicate most of the chapter
on the comprehension of the model and on the phenomenon that take part in it, and on its
application through numerical simulations of non-physiological and physiological behaviors of
the lungs. This chapter allows to prepare our model of the lungs, from the building to the
calibration, to study the HFCWO.
    We develop a mathematical and numerical model of the core biomechanical phenomena
involved in HFCWO by linking the flow of the air into the bronchial tree with the HFCWO-
induced displacement of the lung parenchyma. The number of airways in the lung is very large
and prevents from an exhaustive modeling of these airways. Hence, as in [13, 111], we couple
two distinct models: the air circulation in a model of the bronchial tree, and the deformation
of a material that mimics the respiratory zone. Different frameworks have been used in the
literature to model the bronchial tree, from the most complex, based on 3D geometries that
are reconstructed from CT-scans (Computerized Tomography scan) of the lungs [129, 118], to
idealised tree geometries. Idealised tree geometries allow to develop more tractable models.
They are either generated by algorithms that mimic the statistics of the airways [63, 131] or
by using data-based models, with different levels of complexity, going from fractal-like models
(one or two parameters) [135, 80, 81] to more complex geometries where each level of bronchi is
described independently [72, 85, 84, 125].
    In this work, we use a one parameter model of the bronchial tree. The bronchial tree is
represented using a symmetrical dyadic tree composed of a cascade of rigid cylinders [80, 83].
The deformation of the lung tissue is modeled using linear elasticity, considering the tissue as
an isotropic and homogeneous material, as in [137, 110]. We use the theory of small strains
which is well adapted to the relative low pressures induced by HFCWO on the thorax. To define
the coupling between the two models, described in section 2.2, we assume that the lung tissue
is incompressible. Hence, the rate of volume change of the material in a region of the lung is
assumed to correspond to the amount of air flow that is exchanged with the airway that feeds
that region, as in [13, 111].
    Although defined for any space dimension, the model is used in only one dimension in order
to understand the influence of the coupling on the deformation of the lungs. Particularly, we
observe some similarities between the behaviors of the model and the ones of oscillator systems
that suggests the interest of studying the phenomenon of resonance, see section 2.4. Moreover,
the unidimensional formulation is used to understand the intrinsic effects of each parameter on
the deformation of the lungs and on the induced air flows and pressures in the tree in the case
of the rest ventilation of healthy and pathological lungs, see section 2.5.
    The contents of the appendices describe mostly the details of the mathematical computations.
It explains more precisely some hypothesis and properties of the model and the way the numerical
method is computed. Moreover it gathers in the form of tables the different configurations of
parameters for the numerical simulations that we use in this manuscript.


2.2    The model of the lungs
We assume that the lungs fill a thee-dimensional reference domain Ω Ă R3 at rest. We consider
the lungs as two regions with different physics that are interacting together [13, 111]. The first
region, called the tree region, corresponds to the bronchial airways and the alveolar ducts. The


The model of the lungs                                                                        15


second region, called the tissue region, corresponds to the lung’s parenchyma. Our model of
the lungs consists in the coupling between two models idealizing the two regions. The tissue
region is modelled as an homogeneous deformable medium. It is considered incompressible and
any rate of change of the volume of the material is related to a flow of air to and from the
respiratory zone. The tree region gathers the airflows getting in or out of the respiratory region
and consists in a cascade of bifurcating cylinders mimicking the bifurcating bronchi. The airflow
in the airways has to overcome viscous friction that is represented by the airway hydrodynamic
resistance to the air flow. The hydrodynamics resistance participates to the mechanics of the
respiratory region by inducing a volumetric pressure in the material. The two next sections
are dedicated to detail respectively the models of the bronchial tree (subsection 2.2.1) and of
the lung’s parenchyma and their coupling (subsection 2.2.2). The equation of the model is
then written with the weak formulation suited to the numerical simulations (subsection 2.2.3).
Finally, we present a numerical method to solve the equations of our model (subsection 2.2.4).

2.2.1     Modelling the air flow in the tree region
2.2.1.1    The tree region
Three different levels of modelling are used to describe the tree region, see Figure 2.1. The
three levels of modelling are connected to mimic the bronchial airways and alveolar tracts. All
the airways are considered as rigid cylinders assembled into a bifurcating tree. The size of the
cylinders is decreasing at each bifurcation with a specific ratio h. The generation index of a
cylinder in the tree corresponds to the number of bifurcations between the root of the tree and
that cylinder. The root of the tree mimics the trachea and corresponds to the first generation
with index 0.
    The first level of the tree corresponds to n ` 1 successive generations. Here, the homothetic
ratio between the generations is constant and is denoted h “ hb . We use the value of hb from
                         ` ˘1
Weibel’s model, hb “ 21 3 » 0.79 [135, 80]. In this tree level, all the branches in the same
generation have the same geometrical properties, but their inner air fluid dynamics can be
different. The total number of terminal branches is N “ 2n .
    The number of generations for the first level is n`1 and it can be lower than the approximate
average of 17 generations of the conductive airways [136]. Hence, the second modelling level
mimics the 17 ´ pn ` 1q generations of conductive airways. This level corresponds to a set
of virtual subtrees, connected by set of two at each terminal branches of the tree of the first
modelling level. The subtrees geometry is similar to the geometry of the tree of the first level,
namely the homothetic ratio through the generations is still constant and h “ hb . However,
within one of these subtrees, we assume that the air physics is identical in all the airways with
the same generation index. The total number of terminal branches of the second modelling level
is 216 .
    Finally, the third modelling level mimics the acini. An acinus can be viewed as a 6 gen-
erations dichotomous subtree with rigid cylindrical branches. In the acinus, we can consider
that the size of the branches remain the same at each bifurcation, i.e. the size reduction ratio
between two successive generations is hac “ 1 [40]. The third modelling level corresponds to two
acinus models connected to each terminal branches of the second modelling level.

    With this model of tree, we study the air fluid dynamics in the first airways level only.
The second and third level of modelling are virtual and only contribute in adding additional
resistances into the first level of modelling tree, see below.

2.2.1.2    Pressure–flow relationship
The air in the branches is considered as an incompressible Newtonian fluid with viscosity η. We
assume that air flows according to the steady-state Poiseuille’s regime, i.e. the flow is low, fully
developed and axisymmetric, and the acceleration of the fluid is neglected. We also neglect the


            Modelling the lungs to simulate tidal breathing for healthy and non-healthy
    16                                                                            lungs

                            r0

                                                                                          Conductive tree – generations 0 to n.
                                                                                          First level of modeling.
                                              lengths,                                    The branches size is reduced by a factor hb = 2!"/$ at each bifurcation.
             l0                  0
                                              diameters
                                                                                          The air flow and pressure are computed for each branch.
                                              ×hb

                                                  lengths,
                      1               1           diameters
                                                  ×hb

.....                                                 ....
        2




                                                 2
 ...              2                       2

                                                     ....                                 Conductive tree – generations n+1 to 16.
                                                                                          Second level of modeling.
                                     ....
            .....



                                     .....


                                                      ×hb ×hb
              ...




                                                                                          The branches size is reduced by a factor hb = 2!"/$ at each bifurcation.
                                          ..


                                                                                          The air flow and pressure are assumed identical in all the branches of
                                                                        ×hac              the same generation.
                          ....                                   ....                     Acini – generations 17 to 22.
                                                                                          Third level of modeling.
                                                          ....
                             ....




                                                                                          The branches size is reduced by a factor hac = 1 at each bifurcation.
                                                                                          The air flow and pressure are assumed identical in all the branches of
                                                                                          the same generation.



Figure 2.1: The airway tree is modelled as a cascade of bifurcating cylinders representing the
bronchi and the alveolar ducts. At each bifurcation, the size of the branches is decreasing by
                                         ` ˘1
an homothetic factor, fixed to hb “ 12 3 » 0.79 in the conductive tree (17 first generations)
[135, 80] and to hac “ 1 in the acini (6 last generations) [136, 129]. The number written in the
cylinders corresponds to the generation index of the branches, i.e. the number of bifurcations on
the path between the root of the tree and the branch studied. The first generation corresponds
the root of the tree that mimics the trachea, its index is 0. The airway tree model decomposes
into three levels: the first level corresponds to the first n ` 1 generations where the air flows and
pressures are determined in each airway; the second level corresponds to the next 17 ´ pn ` 1q
generations where the air flows and pressures are assumed identical in all the airways belonging
to a same generation; the third level corresponds to the acini (last six generations) where the
air flows and pressures are also assumed identical in all the airways belonging to the same
generation.


influence of the bifurcations on the air flow and the pressure drop in the nasopharyngeal pathway
[87]. We consider the pressures at the mouth and at the opening of the trachea equal, and the
reference pressure (i.e. the zero pressure) is the atmospheric pressure [87]. We choose the sign
of the volumetric flow rate to be positive if it exits the tree through the root. Poiseuille’s flow
corresponds to a linear regime and a linear relationship between pressure drops and flows can
be derived [86]. If the pressure drop between the outlet and the inlet of the branch is pin ´ pout ,
then the flow F going through the cylinder checks

                                                                        pin ´ pout “ R F

where R is the hydrodynamic resistance of the cylinder. The hydrodynamic resistance depends
on the geometry of the cylinder and on the properties of the fluid (i.e. the air),
                                                                                    8ηl
                                                                               R“
                                                                                    πr4
with r and l the respective radius and length of the cylinder.
    In a quasi-fractal tree, radii and lengths of the branches in the generation i can be derived
from the size of the root branch, whose radius is r0 and length is l0 , and from the factor h:
ri “ hi r0 and li “ hi l0 . Similarly, we can derive a scaling law on the hydrodynamic resistances,
      ´ ¯i                                                                           ` ˘1
Ri “ h13 R0 , with R0 the hydrodynamic resistance of the trachea. Since hb “ 12 3 , we can
            b


The model of the lungs                                                                         17


conclude that Ri “ 2i R0 . We underline here that the index 0 of the resistance R0 corresponds
to the first generation (the trachea). In parallel, the resistance Ri is associated to the resistance
of the branches at the generation i ` 1, see Figure 2.2 for a simple case.
    From the pressure–flow relationships in the cylinders, we can derive a linear relationship for
the whole airway tree. We define the flows vector F “ pFj qj“1,...,N , that represents the airflows
at the terminal branches of the tree and the pressures vector P “ ppj qj“1,...,N , that represents
the air pressures at those same branches. The linear relationship between the pressures and
flows vectors can be written using the resistance matrix R of the airway tree [37, 25],

                                             P “ RF                                             (2.1)

The coefficients of the resistance matrix R are sums of the hydrodynamic resistances of the
cylinders in the paths and the subpaths linking the root of the n ` 1 generations tree and the
terminal branches of the n ` 1 generations tree. R is a symmetrical and positive definite matrix,
thus invertible [25]. For example, the resistance matrix of a tree with three generations is
                  ¨                                                                 ˛
                     R0 ` R1 ` R2      R0 ` R1            R0              R0
                        R0 ` R1     R0 ` R1 ` R2          R0              R0
                                                                                             (2.2)
                  ˚                                                                 ‹
            R“˚                                                                     ‹
                  ˝        R0             R0        R0 ` R1 ` R2        R0 ` R1     ‚
                           R0             R0            R0 ` R1      R0 ` R1 ` R2


   The equivalent resistance Req of the tree corresponds to the scalar that relates an identical
pressure p applied at each terminal branch with the total amount of airflow in the tree F0 (i.e.
the air flow in the first generation): p “ Req F0 . The pressures vector at terminal branches is
then P “ pJ with J “t p1, ..., 1q P RN . The flows vector is then computed using the resistance
matrix P “ RF . Then we can derive the scalar relationship, using F0 “t JF , p “ t JR1´1 J F0 ,
and
                                                      1
                                          Req “   t JR´1 J

    In order to account for influence of the subtrees of the second and third modelling levels,
the hydrodynamic resistances of the terminal branches of the tree of the first modelling levels
are modified. Since the physics of air in the second and third modelling levels are assumed
identical per generation of subtrees, the pressures at the terminal branches of a single subtree
are all the same. Hence, each subtree hydrodynamic response is determined based on its equiv-
alent hydrodynamic resistance only. The hydrodynamic resistance of one subtree of the second
                                        ´ ¯i
modelling level is Rst,n “ Rh3n 17´n´2    1
                                               “ p17 ´ pn ` 1qq Rh3n and for the third modelling
                                ř
                             b
                                 i“0     2h3b                     b
                           ´     ¯i
level, it is Ra “ R16 i“0 2h3 . To each terminal branch of the first modelling level of the
                     ř5        1
                               ac

tree are connected two subtrees of the second modelling level and 217´pn`1q subtrees of the third
modelling level. Finally, the resistance Rn`1 of the terminal branches of the tree of the first
modelling level is replaced by the resistance R̃n`1 that accounts for the subtrees,
                                                 Rst,n     Ra
                                    R̃n “ Rn `         ` 17´pn`1q                               (2.3)
                                                  2     2
    see the appendix 2.A for more details. Hence, as an example, the resistance matrix of a three
generations tree considering the three levels of modelling is different from (2.2) and is detailed
in Figure 2.2.


2.2.1.3   Feeding the respiratory region with air
The domain Ω which reflects the spatial occupation of the lung’s parenchyma is decomposed
into N “ 2n regions pAi qi“1..N . Each one of the Ai is fed (and feeds) with air by a single tree


        Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  18                                                                          lungs


branch among the terminal branches of the n ` 1 generations tree, as shown on Figure 2.2. We
neglect the volume of the bronchial tree, which represents a small fraction of the volume of the
lung, about 10% [136]. In order to mimic how the air is exchanged between the respiratory
region and the tree region, we assume that the airflow that goes through the branch i is equal
to the rate of volume change of the corresponding region Ai , see below.


                                           Generation 0
                                           Airway resistance: R0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           <latexit sha1_base64="zs9eOOxGB0I5tk8cOA467FWmliY=">AAACxnicjVHLSsNAFD2Nr1pfVZdugkVwVVIVdVl002V99AG1lGQ6rYN5kUyUUgR/wK1+mvgH+hfeGaegFtEJSc6ce8+Zufd6sS9S6TivOWtmdm5+Ib9YWFpeWV0rrm800yhLGG+wyI+Stuem3Bchb0ghfd6OE+4Gns9b3s2pirdueZKKKLyUo5h3A3cYioFgriTq4rzn9Iolp+zoZU+DigElmFWPii+4Qh8RGDIE4AghCftwkdLTQQUOYuK6GBOXEBI6znGPAmkzyuKU4RJ7Q98h7TqGDWmvPFOtZnSKT29CShs7pIkoLyGsTrN1PNPOiv3Ne6w91d1G9PeMV0CsxDWxf+kmmf/VqVokBjjWNQiqKdaMqo4Zl0x3Rd3c/lKVJIeYOIX7FE8IM62c9NnWmlTXrnrr6vibzlSs2jOTm+Fd3ZIGXPk5zmnQ3CtXDsv7Zwel6okZdR5b2MYuzfMIVdRQR4O8h3jEE56tmhVamXX3mWrljGYT35b18AGzrJAC</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Resistance matrix:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <latexit sha1_base64="sggZ+CriqqkCmlaaUvml8aJGef8=">AAADr3icjVFdb9MwFL1Z+NjCVxmPvFhUoKFJVTLQxsukCV54LBVdJ80jOK7bWnM+5DiTqqiCf4n4B8Cv2LXrSR3rBI6SHJ97zvW9vlmlZG3i+GewEd65e+/+5lb04OGjx086T7eP67LRXAx5qUp9krFaKFmIoZFGiZNKC5ZnSoyy8w82ProQupZl8dnMK3GWs2khJ5Izg1Ta+UNzZmacqXawIIeEKjExOxHNxFQWLdOazRctx7WIBmm8O0iTXWqkGguUp3vkFfHsEi2/lEbX2PWuVe0qc/sZ67XrXREVxdjXH1EtpzPzOu10417sFrkJEg+64Fe/7PwACmMogUMDOQgowCBWwKDG5xQSiKFC7gxa5DQi6eICFhCht0GVQAVD9hy/U9yderbAvc1ZOzfHUxS+Gp0EXqKnRJ1GbE8jLt64zJa9LXfrctra5vjPfK4cWQMzZP/lu1L+r8/2YmAC71wPEnuqHGO74z5L427FVk5WujKYoULO4jHGNWLunFf3TJyndr3bu2Uu/sspLWv33Gsb+G2rxAEnf4/zJjje6yX7vTef3naP3vtRb8JzeAE7OM8DOIKP0Ich8KAfXATfgu9hEo7CL+HXpXQj8J5ncG2F8hKXutVU</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          R0 + R1 + R̃2      R 0 + R1           R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            R0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        R 0 + R1       R0 + R1 + R̃2        R0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            R0       C
                                           Generation 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          R=B
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   @
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       C
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       A
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               R0               R0         R0 + R1 + R̃2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   R0 + R1
                                           Airways resistance: R1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <latexit sha1_base64="6OpsQCR888LZbwA9R9EUAuB1r4M=">AAACxnicjVHLSsNAFD2Nr1pfVZdugkVwVRIVdVl002V99AG1lGQ6rYNpEpKJUorgD7jVTxP/QP/CO+MU1CI6IcmZc+85M/dePw5EKh3nNWfNzM7NL+QXC0vLK6trxfWNRhplCeN1FgVR0vK9lAci5HUpZMBbccK9oR/wpn9zquLNW56kIgov5SjmnaE3CEVfME8SdXHedbvFklN29LKngWtACWbVouILrtBDBIYMQ3CEkIQDeEjpacOFg5i4DsbEJYSEjnPco0DajLI4ZXjE3tB3QLu2YUPaK89UqxmdEtCbkNLGDmkiyksIq9NsHc+0s2J/8x5rT3W3Ef194zUkVuKa2L90k8z/6lQtEn0c6xoE1RRrRlXHjEumu6Jubn+pSpJDTJzCPYonhJlWTvpsa02qa1e99XT8TWcqVu2Zyc3wrm5JA3Z/jnMaNPbK7mF5/+ygVDkxo85jC9vYpXkeoYIqaqiT9wCPeMKzVbVCK7PuPlOtnNFs4tuyHj4AtgyQAw==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               R0               R0           R0 + R 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    R0 + R1 + R̃2

                                           Generation 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Equivalent resistance:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <latexit sha1_base64="Sa0rZIzW54wKdjlGB4XB/KIuIFE=">AAADB3icjVHNTtwwGBwC5ScUuqVHLhYrJHpZJVBBL5VWcEGcqNQFJIKQ4/UuFtkkchyk1WofoG/CjVvVKy/AlfIG8Bb97BqpFFXgKM54vpmJPzstM1WZKLqbCCan3kzPzM6F828XFt813i8dVEWtheyIIiv0UcormalcdowymTwqteSDNJOH6fmOrR9eSF2pIv9mhqU8GfB+rnpKcEPUaWN7j31hSSZ7Zi1MUtlX+YhrzYfjkRizME6SJxMLE5l3vSJMtOqfmY+njWbUitxgz0HsQRN+7BeNWyToooBAjQEkchjCGTgqeo4RI0JJ3AlGxGlCytUlxgjJW5NKkoITe05zn1bHns1pbTMr5xb0l4xeTU6GVfIUpNOE7d+Yq9cu2bL/yx65TLu3IX1TnzUg1uCM2Jd8j8rX+mwvBj18dj0o6ql0jO1O+JTanYrdOfurK0MJJXEWd6muCQvnfDxn5jyV692eLXf1e6e0rF0Lr63xYHdJFxz/e53PwcF6K95sbXz91Gxv+6uexTJWsEb3uYU2drGPDmVf4ga3+BV8D66CH8HPP9Jgwns+4MkIrn8D2iymsA==</latexit>




                                           Airways resistance:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Rst,2  Ra                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               1              R1   R̃2            B 1 C
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      with J = B   C
                                           <latexit sha1_base64="dFDTKyxUBnThlnZ2JBrOnJDI75M=">AAADB3icjVHLTtwwFD2ER3kzbZdsrI6QkECjZECUTSUEmy4BdQCJgZHj8YA1mSRyHCQU5QP6J+y6q9j2B7oF/oD+Ra9NQDyEwFHic8+958TXN0wjlRnfvxnyhkdGxz6MT0xOTc/MztU+ftrLklwL2RJJlOiDkGcyUrFsGWUieZBqyQdhJPfD/pbN759Jnakk/mHOU3k04Cex6inBDVGd2mbbqKgri92yUzRL9o3tun2JsXZPc1FQmJnlZlnesQ8kt8xxEayWZadW9xu+W+wlCCpQR7W2k9oV2ugigUCOASRiGMIRODJ6DhHAR0rcEQriNCHl8hIlJkmbU5WkCk5sn74nFB1WbEyx9cycWtBfIno1KRkWSJNQnSZs/8ZcPnfOln3Nu3Ce9mzntIeV14BYg1Ni39LdV75XZ3sx6GHd9aCop9QxtjtRueTuVuzJ2aOuDDmkxFncpbwmLJzy/p6Z02Sud3u33OVvXaVlbSyq2hz/7ClpwMHzcb4Ee81GsNZY2Vmtb2xWox7HPL5gkeb5FRv4jm20yPsCf3GFa++n98v77V3elXpDleYznizvz387Wak+</latexit>




𝜏(𝑡)                                       R̃2 = R2 +
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          + 14
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Req =                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    t JRJ
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  = R0 +
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 4             @ 1 A
        A1        A2        A3    A4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             1


   x1=0      x2        x3        x4 x5=L                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        x

Figure 2.2: Unidimensional schematic of the coupling between the tree region and the tissue
region describing the hypothesis of the tree. The airway tree is modelled as a cascade of bifur-
cating cylinders representing the bronchi and the alveolar ducts. At each bifurcation, the size of
                                                                   ` ˘1
the branches is decreasing by an homothetic factor, fixed to hb “ 12 3 » 0.79 in the conductive
tree (17 first generations) [135, 80] and to hac “ 1 in the acini (6 last generations) [136, 129].
The number written in the cylinders corresponds to the generation index of the branches, i.e.
the number of bifurcations on the path between the root of the tree and the branch studied.
The first generation corresponds the root of the tree that mimics the trachea, its index is 0.
The airway tree model decomposes into three levels: the first level corresponds to the first n ` 1
generations where the air flows and pressures are determined in each airway; the second level
corresponds to the next 17 ´ pn ` 1q generations where the air flows and pressures are assumed
identical in all the airways belonging to a same generation; the third level corresponds to the
acini (last six generations) where the air flows and pressures are also assumed identical in all
the airways belonging to the same generation.


2.2.2   Modelling the mechanics of the respiratory region
We model the lung tissue as an homogeneous elastic material [73] and use small strains theory.
This choice is well adapted to HFCWO, since this technique applies small oscillating pressures on
the thorax. This assumption has also been done in the literature for tidal ventilation modeling
purposes and is considered valid since the tidal breathing frequency is low [109].
    Lung’s tissue displacesments at a location x P Ω and at a time t P R` are represented by
the variable upx, tq P R3 , with 3 the spatial dimension considered. The displacements check the
equation,
                                          B2u
                                        ρ 2 ´ divpσpuqq “ 0                                 (2.4)
                                          Bt
where ρ is the volumetric mass density and σpuq is the stress tensor describing the local stress
of a material with the displacement u. The boundary BΩ of Ω is decomposed into two sub-
boundaries: Γ1 represents the part of the boundary where the stress is known, either due to the
action of the respiratory muscles or to the action of the HFCWO device; and Γ2 represents the
zones where the displacement is known (typically zero). Then, the boundary conditions on BΩ
and the initial conditions in Ω are
                                                         on Γ1
                                $
                                & σpuq.n “ τ ptq
                                    u “ ub               on Γ2                              (2.5)
                                    upx, t “ 0q “ u0 pxq for x P Ω
                                %


The model of the lungs                                                                                           19


    The applied force τ is assumed to be periodic in time unless specifically said. To cancel any
rigid movement, the boundary Γ2 is fixed (ub “ 0).

    Stress-strain relationship. We assume the material to be isotropic and to follow linear
elasticity. We denote the stress σelastic puq, with u the local displacement. With I the identity
matrix, we have
                                σelastic puq “ λ tr ppuqq I ` 2µ puq                      (2.6)

with the strain tensor puq “ 12 ∇u ` t ∇u and where λ and µ are the Lamé parameters, with
                                 `            ˘

λ the first Lamé coefficient and µ the shear modulus of the material. These coefficients can be
related to the Young’s modulus E and Poisson’s ratio ν of the material: λ “ p1´2νqp1`νq
                                                                                      Eν
                                                                                             and
     2p1`νq .
        E
µ“

    The air flowing out of the respiratory region has to travel through the bronchial tree, so
any change of the volume of the material is counteracted by the resistance to the air flow
induced by the tree structure. This is reflected in the material stress–strain relationship by a
supplementary local stress, actually a pressure, that depends on how the air is conveyed in the
tree. Each terminal branch i induces a homogeneous pressure pi in its corresponding region Ai
in Ω. The pressures are determined by the rate of volume change of the Ai along time. In the
case of small displacements, this rate, which corresponds to the air flow, can be approximated
with
                                            ż
                                  Fi rus
                                      9 “          ´divpuqdx
                                                        9           r111s
                                              Ai

    with u9 “ Bu
              Bt . Because of the pressures–flows relationship in the terminal branches expressed
in the equation (2.1), the pressure pi in one Ai depends on the air flows in all the tree terminal
branches. Hence, denoting Frus           9 1ďiďN and P “ ppi q1ďiďN , the pressure is a piecewise
                                9 “ pFi rusq
continuous function that depends on the hydrodynamic resistances of the airways tree:

                                                       N
                                                                                                                 (2.7)
                                                       ÿ
                                   ptree pFrusq
                                            9 “               pi pFrusqχ
                                                                    9 i
                                                      i“1


                                                         1,    if x P Ai
                                                     #
                                  with χi pxq “
                                                         0,    otherwise

   and

                                                                            ¨                               ˛
                                          N                                     N
                                      ˜                   ¸                               ż
                                          ÿ                                     ÿ                     Bu
             9 1ďiďN “ RFrus
  P “ ppi pFrusqq                             Rij Fj rus                            Rij        divp
                                                                          ˚                                  ‹
                          9 “                         9                “ ´˝                              qdy ‚
                                        j“1                                  j“1
                                                                                                      Bt
                                                               1ďiďN                      Aj                 1ďiďN

   Hence, the inner stress tensor induced by the tree is

                                            9 “ ´ptree pFrusqI
                                     σtree puq            9

   Finally,
                         σpu, Frusq λTrppuqqI ` 2µpuq looooooomooooooon
                                9 “ looooooooooomooooooooooon ´ptree pFrusqI
                                                                        9                                        (2.8)
                                                σelastic puq            σtree puq
                                                                               9

The resulting stress–strain relationships in equation (2.8) is that of a viscoelastic material, with
a non-local viscous behavior.


        Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  20                                                                          lungs


2.2.3    Weak formulation of the system of equations
The model of the lung developed in the previous section consists in the equation of the mechanics
for the respiratory zone (2.4), its boundary and initial conditions (2.5), the viscoelastic stress–
strain relationship for the model of the respiratory zone (2.8), and the matrix pressures–flows
relationship at the terminal branches of the bronchial tree model (2.1).
    To compute an approximated solution, the system is solved numerically using its weak for-
mulation and the finite element method. The weak formulation and the finite elements method
are convenient for dealing with the divergence of piecewise constant functions, such as the pres-
sures pi . A detailed description of the method is given in the appendix 2.B.

    Weak formulation of the system of equations. The stress tensor is not everywhere
differentiable, hence equation (2.4) should be written using a principle of virtual work [11], or
mathematically speaking, with the weak formulation, suited to the finite elements method. For
any proper smooth test function w : Ω Ñ R3 , the weak formulation of the equation (2.4) is
                                ż ˆ 2                 ˙
                                      B u
                                     ρ 2 ´ divpσpuqq wdx “ 0
                                 Ω     Bt
   or in other words with (2.8)
                      ż ˆ 2                                    ˙
                             B u
                           ρ 2 ´ divpσelastic puq ` σtree puqq
                                                           9     wdx “ 0                               (2.9)
                        Ω    Bt
   Using integration by parts and (2.7), the previous equation becomes

                                                      ˜ż                        ¸
ż ˆ 2                         ˙     ż                      N
    B u
   ρ 2 w ` σelastic puq : pwq dx ´                                                                     “0
                                                          ÿ
                                        σpuq.n w dS ´        pi pFrusqχ
                                                                   9 i divpwqdx
 Ω  Bt                               BΩ                 Ω i“1
                                                                                                1ďiďN
                                                                                      (2.10)
    with the colon denoting double contraction of two tensors of rank 2. Hence, the equation
(2.10) writes

 ż ˆ 2                         ˙     ż                 N         ż
     B u
    ρ 2 w ` σelastic puq : pwq dx ´                                 div pwq dx “ 0 (2.11)
                                                      ÿ
                                         σpuq.n w dS ´ pi pFrusq
                                                             9
  Ω  Bt                               BΩ              i“1         Ai


   Finally, for any proper smooth test function w : Ω Ñ R3 , the weak formulation of (2.4) with
boundary conditions gives the system :

                                                              N
$ ş ´                                 ¯
         B2 u
                                :                                           Ai div pwq dx “ 0   on Ω
                                              ş               ř            ş
’
’
’  Ω   ρ Bt 2 w ` σ elastic puq   pwq   dx ´  Γ1  τ  w dS ´    p i pFrusq
                                                                        9
                                                             i“1
’
’
& upx, t “ 0q “ u0 pxq                                                                          for x P Ω
’
’

’ u “ ub and w “ 0 ˜                                     ¸                                      on Γ2
’
’                                N      ż
                                            divp Bu
’                               ÿ
% ppi pFrusqq                       Rij
’
’
’         9 1ďiďN “ ´                             Bt qdx
                             j“1       Aj
                                                        1ďiďN
                                                                                                    (2.12)


   This system holds for any smooth test function which cancels on Γ2 .

    The solution of the system of equations (2.12) defines the three-dimensional displacement,
for all points in space and for all time, of a visco-elastic material stimulated at boundaries. This
mimicks the lung’s parenchyma locally subjected to the dissipation of a network of connected
pipes idealising the bronchial tree. In our model, the effects of the tree on the lung’s tissue


The model of the lungs                                                                      21


arise as much from the deformation of the medium as from the different circulations of air inside
the bronchus tracks. Hence, inside a 23 generations tree with millions of airways, at each time,
different behaviors occur and act on different local regions of the elastic medium. In order to
bring a better understanding of those phenomena and to suggest new insights on the physiology
of the lungs, we will use numerical simulations with the finite element method.

   We gather all the variables of the model in the following table 2.1 for a better distinction.


                                    Model input parameters

        Physical quantity                             Parameter name             Unit

        Lung volumetric density                                ρ                kg.m´3
        Characteristic lungs size                              L                  m
        Lamé parameters                                     λ ` 2µ                Pa
        Tree root radius (trachea radius)                      r0                 m
        Tree root length (reduced trachea length)              l0                 m
        Resistance matrix of the airway tree                   R            cmH2 O.s.L´1
        Hydrodynamic resistance of the airway tree            Req           cmH2 O.s.L´1
        Frequency of the applied pressure                      f                  Hz
        Amplitude of the applied pressure                      A                  Pa

                            Table 2.1: Input parameters of the model.



2.2.4     Numerical method : the finite element method
The system of equations (2.12) has been defined for three dimensions. However, the system
(2.12) is also valid for one or two dimensions. In this chapter and the next one, we focus the
numerical study to one spatial dimension. This choice is explained in the next section. Never-
theless, we aim at applying and studying the model for multi-dimensions. Hence, the numerical
method is introduced here for three dimensions and we send the reader to the chapter 4 for more
details on the perspectives of its use. We will then study the unidimensional formulation of the
model.

    To solve the system of equations (2.12), we will use the finite element method. The Finite
Element Method (FEM), very popular tools among engineers and researchers, is a numeri-
cal method approximating the solution of partial differential equations [11]. Every numerical
method approximates solution of equations on a finite number of points in space, as the FEM.
The FEM works with discrete systems based on the weak form of a partial differential equation
with boundary conditions. Basically, a given structure, for example a beam, is represented as
an assemblage of finite elements on which the solution is calculated, see below. The calculation
details of the application of the method in our case is described in the appendix 2.B.

    Using the finite element method, the continuous equation (2.10) is turned into a discrete
one. Typically, the domain is splitted into a finite number ne of identical elements, also called
cells. The solution will be computed on specific points in the cells such as vertices, edges or
faces. In three dimensions, the main element geometries are tetrahedron or hexahedron. The
number of cell vertices (also called nodes) depends on the geometry of the element. Typically,
while tetrahedron have four vertices, regular hexahedron (cube) have eight vertices. We denote


          Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  22                                                                            lungs


by nv the number of vertices per cell. The goal, in our case, is to look for the displacement field.
For that, it is expressed in the subspace spaned with the basis functions, denoted φ, which are
polynomial with a specific order. The latter indicates the spatial points where the solution will
be expressed on each cell. Those points are known as degrees of freedom. Hence, the more there
are degrees of freedom, the more precise the approximated solution is. For example, if we use a
1st order polynomial function, the degrees of freedom will be associated with the nodes of the
mesh and we would have ne ˆ nv degrees of freedom. Let’s denote by nd the number of degrees
of freedom. For higher order elements, the degrees of freedom can be associated also to faces,
edges, etc, and the number of degrees of freedom increases.

    For any proper smooth test function w : Ω Ñ Rm , the weak formulation of the equation
(2.4) is

 ż ˆ 2                         ˙     ż                 N         ż
     B u
    ρ 2 w ` σelastic puq : pwq dx ´                                 div pwq dx “ 0 (2.13)
                                                      ÿ
                                         σpuq.n w dS ` pi pFrusq
                                                             9
  Ω  Bt                               BΩ              i“1         Ai


     The displacement field is approximated using the basis functions of the finite element upx, tq “
nd                                                  nd
     uk ptqφk pxq as well as the test function, w “    wl ptqφl pxq, with x P R3 , t P R. Injecting the
ř                                                   ř
k“0                                                      l“0
approximated u and w in the equation (2.13) leads (2.13) to be written as a linear matrix-vector
equation :

                               d2 U ptq        dU ptq
                              M     2
                                        ` D            ` KU ptq “ τ ptqh                  (2.14)
                                 dt              dt
The vector U ptq “ pui ptqq0ďiďnd is the unknown displacement vector containing the nd displace-
ment components ui at the degree of freedom i for all time t P R` . The matrices M and K are
known as the mass and the stiffness matrix. The matrix D is the damping matrix arising from
the coupling with the tree structure. It is defined as D “t GRG whose terms are defined above.
The vector h is the vector of loads. Finally the equation (2.18) has only a time dependency.
With x P R3 , those objects are defined as
                             $
                             ’                  ş
                             ’
                             ’
                             ’          Mkl “ Ω ρφk pxqφl pxqdx
                             ’
                             ’
                             ’
                             & Kkl “ σelastic pφk pxqq : pφl pxqqdx
                             ’
                             ’          ş
                                                                                          (2.15)
                                         Ω
                             ’                    ş
                             ’
                             ’
                             ’             h l “      φ
                                                    Γ1 l pxqdS
                             ’
                             ’
                             ’
                                                      divpφk qdx
                             ’                    ş
                                          Gik “
                             ’
                             %
                                                    Ai



      More specifically, the components of the stiffness matrix are computed as
                            ż
                    Kkl “      rλ divpφk pxqqdivpφl pxqq ` µ pφk pxqq : pφl pxqqs dx
                             Ω
    We recall that the calculation details are described in the appendix 2.B. Then, in order to
solve the linear system (2.14), the time has to be discretized. However, for now, we refer the
reader to the chapter 4. The numerical scheme is presented as well as the perspectives of the
use of the multi-dimensional model.

   In order to understand the physics hidden in the set of equations (2.12) in a tractable frame-
work, we will focus, in most parts of this manuscript, on unidimensional cases and limit the
spacial dimension to a single coordinate, say x1 . Actually, with one dimension, we will see that
an analytical solution of the model equation can be computed in a particular case. In the next


The unidimensionnal formulation of the model of the lungs                                      23


section, we describe the unidimensional formulation of the model, the application of the FEM
with one dimension and the way to compute the analytical solution.



2.3     The unidimensionnal formulation of the model of the lungs
The core of our application of the model is the understanding of the lungs, particularly during
a HFCWO therapy. However, as the previous paragraphs have pointed out, the interaction
between the tree and the tissue region, as well as the non negligible number of variables in the
model, can lead to numerous different behaviors. In order to catch the essence of the coupling
and of the influence of the parameters, we decide to study the model with simple cases. For
that purpose, we restrict now the study to one spatial dimension. The unidimensional (1D)
formulation allows us to analyze the behaviors involving in the coupling more easily. The reduc-
tion of the spatial dimension decreases the number of degrees of freedom and leads inevitably
to a reduction of the complexity and of the calculation time of the solving numerical method.
Validating the numerical method on simple case (1D) eases the implementation and the com-
prehension of more complex cases (3D). Additionally, we found out that an analytical solution
of the strong formulation (2.4) in 1D can be calculated on a particular case. The analytical
solution is used to reduce computational time and to validate the resolution of the 1D numerical
method. We present in this section the unidimensional formulation of our model (subsection
2.3.1), the application of the numerical method with one dimension (subsection 2.3.2) and the
way to compute the analytical solution (subsection 2.3.3).

2.3.1    Unidimensional formulation
The unidimensional geometry can be viewed in the three dimensional space as a cylinder that
is the extrusion along the axis x1 of a surface in the plane p0, x2 , x3 q. In terms of mechanics,
we assume that the virtual displacement w1 depends only on x1 and that the displacements w2
and w3 are zero. We assume also that 11 puq is the single non zero term in the strain tensor.
For the sake of simplicity, when using the unidimensional formulation, we will improperly drop
most of the index 1 and use respectively x, u, w and τ instead of x1 , u1 , w1 and τ1 ; the rest of
the manuscript will be careful to distincly highlight the use of this formulation.
    In this case, the material spans on the domain Ω “ r0, Ls and x P R. We assume that the
extruded surface is a square with side length L and surface area SL “ L2 . Then, the rate of
volume change can be rewritten
                               ż                                      ż xj`1
                                    Bu                                          B Bu
                    Fj rus
                        9 “´    divp qdx1 dx2 dx3 “ ´SL                          p qdx
                             Aj     Bt                                  xj     Bx Bt

    where the projection of Aj on the axis x1 is the segment rxj , xj`1 s. For the sake of simpli-
fication, we will now identify the set Aj with its projection on the x1 axis, i.e. Aj “ rxj , xj`1 s.
Then, the tree pressure in the stress–strain relationship reformulates as

                         9 “ ppi pFrusqq
                ptree pFrusq        9 1ďiďN
                                     ˜N                                   ¸
                                            ż            xj`1
                                           ÿ                     B Bu
                               “ ´SL           Rij                p qdx
                                        j“1          xj         Bx Bt
                                                                             1ďiďN            (2.16)
                                           N
                                       ˜             ˆ                              ˙¸
                                           ÿ             Bu              Bu
                               “ ´SL           Rij          pxj`1 , tq ´    pxj , tq
                                        j“1
                                                         Bt              Bt
                                                                                     1ďiďN

    where Rij is the i, j component of the matrix R.
    With the definition (2.8) of the stress tensor, σelastic can be rewritten as σelastic puq “ pλ `
    Bx . The case studied here assumes an active constraint applied at x “ 0 and no displacement
2µq Bu


        Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  24                                                                          lungs


at x “ L. Then, for any smooth function w such that wpLq “ 0, the weak formulation of our
model in one dimension with boundary conditions is
      $                                        N
         şL B2 u
                            2µq                                 Bx dx ´ τ ptqwpt, 0q “ 0
                                Bu Bw         ř            ş
      ’
      ’
      ’
      ’      ρ
          0 Bt   2 w ` pλ `     Bx Bx  dx ´             9 Ai Bw
                                                 pi pFrusq
      ’
      ’                                      i“1
      & up0, xq “ u0 pxq
      ’
         upt, Lq “ ub pLq ˜and wpLq “ 0 ¸                                                (2.17)
      ’
      ’
      ’                       N       ż
                                          B2 u
                                                       i “ 1, . . . N
      ’                      ÿ
         p      usq              Rij      BxBt dx
      ’
      ’
      ’
      %   i pF r 9   “ ´S L
                           j“1      Aj

   In the next subsection, we adapt the finite element method described previously.

2.3.2   The finite element method and numerical scheme
Here, we present the application of the finite element with one dimension and the numerical
scheme used to solve the unidimensional set of equations (2.17).

   The finite element method
We apply the finite element method to the uni-dimensional set of equations (2.17), as explained
previously in the subsection 2.2.4. We recall that a description of the method is detailed in the
appendix 2.B. The unidimensional domain Ω “ r0, Ls is splited into nx segments of two nodes,
and we define pxi q0ďiďnx , xi “ i ˆ δx , δx “ nLx . Using the finite element method, and
polynomial of order 1 as basis functions, the main equation of (2.17) is expressed as a linear
matrix-vector relation :

                             d2              dU ptq
                          M     2
                                  U ptq ` D           ` KU ptq “ τ ptqh                 (2.18)
                             dt                 dt
   where U ptq “ pui ptqq0ďiďnx is the unknown displacement vector containing the nx ` 1 dis-
placement elements ui at point xi for all time t P R` . For one dimension, the matrices M , K
and D as well as vector of load h are defined as
                              $
                              ’               şL
                              ’
                              ’
                              ’        Mkl “ 0 ρφk pxqφl pxqdx
                              ’
                              ’
                              ’
                              & Kkl “ L pλ ` 2µq Bφk pxq Bφl pxq dx
                              ’
                              ’          ş
                                                                                        (2.19)
                                           0            Bx      Bx
                              ’
                              ’
                              ’
                              ’              hl “ φl p0qδl0
                              ’
                              ’
                              ’
                                         Gik “ Ai BφBx k pxq
                              ’                  ş
                                                             dx
                              ’
                              %

   As an example, the calculation of the mass matrix in one dimension can be found in the
appendix 2.B.

    Numerical scheme
The matrix-vector equation (2.19) is transformed into a system of two equations of order 1 by
             dt . The numerical scheme is directly applied by the numerical tool we use. We use
setting V “ dU
the solver ode15s of Octave [27] that uses variable order method based on backward difference
formulas [20]. The system of two equations solved by ode15s is :
                              $
                              & V ´ dU “ 0
                              ’
                                                                                          (2.20)
                                       dt

                              % M dV “ ´KU ´ DV ` τ ptqh
                              ’
                                    dt



    Space and time discretization
In the unidimensional simulations of this manuscript, the maximal number of generations that


The unidimensionnal formulation of the model of the lungs                                            25


we consider for the tree structure is eight. Consequently the domain Ω “ r0, Ls is never splitted
into more than N “ 27 “ 128 Ai sub-domains. In order to get a satisfying spatial precision,
the space step is always lower than L{128. Specifically, for a eight generations tree, we choose
5 space steps per Ai sub-domain. The Ai sub-domains share N ´ 1 spatial points. Hence, the
necessary number of points is nx ` 1 “ 5N ´ N “ 4N “ 512. And consequently, the space step
is δx “ L{511. We set δx “ L{511 for all unidimensional numerical simulations.
    We denote by T “ 1{f the period of the periodic pressure τ applied on the boundary and by
δt the time step. The time step is chosen experimentally. As we apply pressures with different
frequencies, the time step is adapted to the case studied. We compare several solutions computed
from several time steps : δt “ T {200, δt “ T {250 and δt “ T {300. Globally, we observe that the
computed solution is smoother with δt “ T {250 than with δt “ T {200. Moreover, the computed
solution is similar with δt “ T {250 and δt “ T {300. Hence we set the time step to δt “ T {250.


2.3.3    Analytical solution of the unidimensional model
We recall that we set Ω “ r0, Ls “ YN  i“1 Ai and that the resistance matrix of the n ` 1 tree is
R. To get the proper dimension for the air flows in 1D, we denote Rs “ SL R with SL “ L2 a
surface area.
    Here we denote by xi and xi`1 the spatial coordinates of the boundaries of the Ai such as
Ai “ rxi , xi`1 s. The equation of the lung model can be written on each Ai with boundary
conditions at xi and xi`1 . The solution of the equation on a Ai is denoted by ui .


     B 2 ui               B 2 ui
    ρ        ´ pλ `  2µq         “0                                        on Ai “ rxi , xi`1 s @i   (2.21)
       Bt2                Bx2
               Bui´1                             Bui
    pλ ` 2µq          pt, xi q ´ pi´1 “ pλ ` 2µq     pt, xi q ´ pi                       for i ě 2   (2.22)
                 Bx                              Bx
               Bu1
    pλ ` 2µq       pt, x1 q ´ p1 “ A1 cospcκtq ` A2 sinpcκtq                             for i “ 1   (2.23)
                Bx
    ui pt, xi`1 q “ ui`1 pt, xi`1 q                                                    for i ă N     (2.24)
    uN pt, xN `1 q “ 0                                                                 for i “ N     (2.25)
                                           Bui            Bui
    p “ ppi qi “ Rs ˆ pFi qi with Fi “         pt, xi q ´     pt, xi`1 q                             (2.26)
                                           Bt             Bt

   Here, κ is in rad.m´1 and the time pulsation is cκ which is in rad.s´1 .
   We search a solution of the type

                     ui pt, xq “ pai cospκxq ` bi sinpκxqq pci cospcκtq ` di sinpcκtqq

with ai , bi , ci , di four constants and c “    pλ ` 2µq{ρ. It can be rewritten in the form
                                                a


  ui pt, xq “ αi cospκxq cospcκtq ` βi cospκxq sinpcκtq ` γi sinpκxq cospcκtq ` δi sinpκxq sinpcκtq

with αi , βi , γi and δi four other constants. With this formulation, the equation (2.21) in Ai is
always verified. We will now focus on the conditions at the boundaries of the Ai , i.e. at the
pxi qi . We denote
                                 Cl,i “ cospκi xi q and Cr,i “ cospκi xi`1 q
                                                                                                     (2.27)
                                 Sl,i “ sinpκi xi q and Sr,i “ sinpκi xi`1 q

The boundary equations at the pxi qi form a linear system on the αi , βi , γi and δi . Since the
functions t Ñ sinpcκtq and t Ñ cospcκtq are linearly independent, we obtain two equations for
each boundary condition. Hence,


       Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  26                                                                         lungs




Equation (2.22), for i ě 2 :
                                                          ´                                        ¯
On cospcκtq: pλ ` 2µqp´αi´1 Sr,i´1 ` γi´1 Cr,i´1 q ´ c Rs pβj pCl,j ´ Cr,j q ` δj pSl,j ´ Sr,j qqj
                                                                                                     |i´1
                                   ´                                            ¯
“ pλ ` 2µqp´αi Sl,i ` γi Cl,i q ´ c Rs pβj pCl,j ´ Cr,j q ` δj pSl,j ´ Sr,j qqj
                                                                                  |i
                                                          ´                                          ¯
On sinpcκtq: pλ ` 2µqp´βi´1 Sr,i´1 ` δi´1 Cr,i´1 q ´ c Rs p´αj pCl,j ´ Cr,j q ´ γj pSl,j ´ Sr,j qqj
                                                                                                       |i´1
                                   ´                                               ¯
“ pλ ` 2µqp´βi Sl,i ` δi Cl,i q ´ c Rs p´αj pCl,j ´ Cr,j q ´ γj pSl,j ´ Sr,j qqj
                                                                                     |i




Equation (2.23), i “ 1 :
                                               ´                                           ¯
On cospcκtq: pλ ` 2µqp´α1 Sl,1 ` γ1 Cl,1 q ´ c Rs pβj pCl,j ´ Cr,j q ` δj pSl,j ´ Sr,j qqj     “ A1 {κ
                                                                                            |1
                                              ´                                              ¯
On sinpcκtq: pλ ` 2µqp´β1 Sl,1 ` δ1 Cl,1 q ´ c Rs p´αj pCl,j ´ Cr,j q ´ γj pSl,j ´ Sr,j qqj     “ A2 {κ
                                                                                              |1




                      Equation (2.24), i ă N :
                       On cospcκtq: αi Cr,i ` γi Sr,i “ αi`1 Cl,i`1 ` γi`1 Sl,i`1
                       On sinpcκtq: βi Cr,i ` δi Sr,i “ βi`1 Cl,i`1 ` δi`1 Sl,i`1


                      Equation (2.25), i “ N :
                       On cospcκtq: αN Cr,N ` γN Sr,N “ 0
                       On sinpcκtq: βN Cr,N ` δN Sr,N “ 0

     In order to solve the system, we reformulate the equations using a matricial formulation. We
define the vectors α “ pαi qi , β “ pβi qi , γ “ pγi qi and δ “ pδi qi .
     First, we define the two diagonal matrices Clr “ ppCl,j ´ Cr,j qδij qij and Slr “ ppSl,j ´
Sr,j qδij qij . With these matrices, we can express the flow terms that appear after the resistance
matrix Rs in the linear version of the equations (2.22) and (2.23):

                         ppβj pCl,j ´ Cr,j q ` δj pSl,j ´ Sr,j qqj “ Clr β ` Slr δ

and
                      pp´αj pCl,j ´ Cr,j q ´ γj pSl,j ´ Sr,j qqj “ ´Clr α ´ Slr γ
   The linear versions of the two equations (2.22) and (2.23) can then be written using matrices:
                                                                    ˆ                          ˙
                         c                                               A1
       Sl α ´ Cl γ `           LRs pClr β ` Slr δq “ v1 with v1 “ t
                                                                                , 0, . . . , 0
                     pλ ` 2µq                                         pλ ` 2µqκ
                                                                    ˆ                          ˙
                         c                                               A2
       Sl β ´ Cl δ ´          LRs pClr α ` Slr γq “ v2 with v2 “  t
                                                                                , 0, . . . , 0
                     pλ ` 2µq                                         pλ ` 2µqκ
with
                                       0    0                0       0
                           ¨                                                          ˛
                                Sl,1               ...
                         ˚     ´Sr,1 Sl,2   0      ...       0       0                ‹
                                 0                           0       0
                         ˚                                                            ‹
                         ˚           ´Sr,2 Sl,3    ...                                ‹
                    Sl “ ˚                                                            ‹
                         ˚      ...   ...  ...     ...      ...     ...               ‹
                                 0     0                             0
                         ˚                                                            ‹
                         ˝                 . . . ´Sr,N ´2 Sl,N ´1                     ‚
                                 0     0   ...      0     ´Sr,N ´1 Sl,N


The unidimensionnal formulation of the model of the lungs                                     27



                                       0    0                0       0
                           ¨                                                        ˛
                                Cl,1               ...
                           ˚   ´Cr,1 Cl,2   0      ...       0       0              ‹
                                 0                           0       0
                           ˚                                                        ‹
                           ˚         ´Cr,2 Cl,3    ...                              ‹
                      Cl “ ˚                                                        ‹
                           ˚    ...   ...  ...     ...      ...     ...             ‹
                                 0     0                             0
                           ˚                                                        ‹
                           ˝               . . . ´Cr,N ´2 Cl,N ´1                   ‚
                                 0     0   ...      0     ´Cr,N ´1 Cl,N

and
                                            1   0   0        ... 0    0
                                       ¨                                   ˛
                                   ˚       ´1 1     0        ... 0    0    ‹
                                            0 ´1 1           ... 0    0
                                   ˚                                       ‹
                                   ˚                                       ‹
                                 L“˚                                       ‹
                                   ˚       ... ... ...       ... ... ...   ‹
                                            0   0 ...        ´1 1     0
                                   ˚                                       ‹
                                   ˝                                       ‚
                                            0   0 ...         0 ´1 1

   The linear versions of the two equations (2.24) and (2.25) become

                                    Cr α ` Sr γ “ 0 ÝÑ γ “ ´Sr´1 Cr α
                                    Cr β ` Sr δ “ 0 ÝÑ δ “ ´Sr´1 Cr β

with
                                                0                 0      0
                                ¨                                               ˛
                                    Sr,1 ´Sl,2              ...
                               ˚     0   Sr,2 ´Sl,3         ...   0      0      ‹
                                     0     0                      0      0
                               ˚                                                ‹
                               ˚               Sr,3         ...                 ‹
                          Sr “ ˚                                                ‹
                               ˚    ...   ...  ...          ...  ...    ...     ‹
                                     0     0                 0 Sr,N ´1 ´Sl,N
                               ˚                                                ‹
                               ˝               ...                              ‚
                                     0     0   ...           0    0    Sr,N

and
                                                0                  0      0
                               ¨                                                ˛
                                    Cr,1 ´Cl,2               ...
                               ˚     0   Cr,2 ´Cl,3          ...   0      0     ‹
                                     0     0                       0      0
                               ˚                                                ‹
                               ˚               Cl,3          ...                ‹
                          Cr “ ˚                                                ‹
                               ˚    ...   ...  ...           ...  ...    ...    ‹
                                     0     0                  0 Cr,N ´1 ´Cl,N
                               ˚                                                ‹
                               ˝               ...                              ‚
                                     0     0   ...            0    0    Cr,N

   Finally, mixing the matricial formulations leads to
                 c                               `              ˘       c       ``                ˘ ˘
Sl β´Cl δ´            LRs pClr α ` Slr γq “ v2 Ñ Sl ` Cl Sr´1 Cr β´          LRs Clr ´ Slr Sr´1 Cr α “ v2
             pλ ` 2µq                                               pλ ` 2µq

and                                           ˆ                                           ˙
                      `                 ˘´1           c       ``                ˘ ˘
                  β “ Sl `   Cl Sr´1 Cr                    LRs Clr ´ Slr Sr´1 Cr α ` v2
                                                  pλ ` 2µq
Then,
                 c                               `              ˘       c       `                 ˘
Sl α´Cl γ`            LRs pClr β ` Slr δq “ v1 Ñ Sl ` Cl Sr´1 Cr α`          LRs Clr ´ Slr Sr´1 Cr β “ v1
             pλ ` 2µq                                               pλ ` 2µq

and
ˆ                                                                                                     ˙
                         c          `                ˘`             ˘´1     c       `               ˘
  Sl ` Cl Sr´1 Cr `                           ´1
                              LRs Clr ´ Slr Sr Cr Sl ` Cl Sr Cr  ´1                             ´1
                                                                                 LRs Clr ´ Slr Sr Cr α
                     pλ ` 2µq                                           pλ ` 2µq
           c         `                 ˘`               ˘´1
“´                LRs Clr ´ Slr Sr´1 Cr Sl ` Cl Sr´1 Cr     v2 ` v1
       pλ ` 2µq


         Modelling the lungs to simulate tidal breathing for healthy and non-healthy
   28                                                                          lungs


Finally, the linear system to solve in order to determine α, β, γ and δ is
$
’
’ Mα “ b
’
’                            ˆ           ˙2
’
’                   ´1              c            `              ´1
                                                                       ˘`           ´1
                                                                                           ˘´1     `              ´1
                                                                                                                         ˘
  M      S    C   S    C                    LR     C      S   S    C     S    C   S    C       LR   C      S    S    C
’
     “      `              `                            ´                   `                            ´
                                pλ ` 2µq
          l     l        r                     s     lr    lr        r    l     l        r       s    lr     lr        r
’
’                  r                                            r                  r                             r
’
’
’
’
’            c             `                ˘`                  ˘´1
&b “ ´              LRs Clr ´ Slr Sr´1 Cr Sl ` Cl Sr´1 Cr           v2 ` v1
’
         pλ ` 2µq
                               ˆ                                              ˙
                                      c
’
’      `                   ˘´1                ``                    ˘ ˘
’                   ´1                                        ´1
’β “ Sl ` Cl Sr Cr               pλ ` 2µq
                                          LRs Clr ´ Slr Sr Cr α ` v2
’
’
’
’
’
  γ “ ´Sr´1 Cr α
’
’
’
’
’
’
  δ “ ´Sr´1 Cr β
%

Then for x P Ai and t P R` ,

   ui pt, xq “ αi cospκxq cospcκtq ` βi cospκxq sinpcκtq ` γi sinpκxq cospcκtq ` δi sinpκxq sinpcκtq

    An analytical solution of the unidimensional equation of our model can then be computed.
However, the solution is valid on the particular case where a Neumann boundary condition in
the form of a sum of a sine and a cosine, is applied on one boundary. Nevertheless, with the
unidimension formulation of the model, we will mostly use this boundary condition. Addition-
ally, the analytical solution allows to validate the numerical resolution. In the next sections, we
will use either the analytical solution or the numerical method depending on the case and on
the computational time.

    In order to numerically investigate how our model of the lungs behaves, we will apply our
model to non-physiological cases. Particularly, we want to study the influence of the damping
of the tree on the deformation of the elastic material.


2.4      Study of the coupling between the tree and the elastic ma-
         terial through non-physiological numerical simulations
Before numerically studying physiological cases of the lungs, here, we will apply our model to
simple non-physiological cases with the unidimensional system of equations (2.17). Actually,
from an unidimensional point of view, without the tree structure (namely pi “ 0 @i), the strong
formulation (2.4) is the linear elasticity equation for an isotropic and homogeneous material.
From that perspective, we can already dig out some interesting information. It allows us to
study, for materials of fixed size with homogeneous elastic properties, the propagation of the
deformation wave and interestingly, the natural angular frequencies [114, 41, 69]. The natural
angular frequencies1 of an oscillatory system (such as an elastic material) are the pulsations
at which the system oscillates in the absence of any external forces (driving or damping force)
[120, 43]. Furthermore, if the oscillator is stimulated continuously by an external periodic
force whose frequency is close to one of those natural frequencies, the motion of the oscillator
amplifies through time more or less strongly depending on a potential damping. This is the
phenomenon of resonance which we will investigate in this section. The resonance allows a
potential amplification of the deformation of a material. For our study, this phenomenon could
be interesting for the HFCWO. Hence, this section investigates the potential effect of the tree
structure on the deformation (subsection 2.4.1) and the resonance of the material (subsection
2.4.2). The way the natural angular frequencies of the elastic material are computed is detailed
in the appendix 2.C.
   1
     Also named angular eigenfrequencies or natural pulsations. Equivalently, the frequency associated to a
natural pulsation is named eigen frequency or natural frequency. The relation between a given frequency f and
a given pulsation ω is ω = 2πf.


Study of the coupling between the tree and the elastic material through
non-physiological numerical simulations                                                      29


2.4.1   Effect of the tree structure on the propagation of the wave deformation
With the tree structure, hence pi ‰ 0 @i, we see in (2.16) that the effect of the tree structure
act on the boundaries of the Ai regions but we do not know its general influence on the solu-
tion. Here, we study the influence of the tree on the propagation of the deformation wave by
comparing the displacements of the material with or without the coupling with different tree
structures. The cases studied here are not physiological. This analysis also allows to check the
pertinence for the coupled case of the angular eigenfrequencies calculated in the absence of the
tree, see the appendix 2.C. From thebappendix 2.C, we also deduce the definition of the velocity
of the wave propagation that is c “     pλ`2µq
                                           ρ   .

    The domain is Ω “ r0, Ls with L “ 1 m and corresponds to a homogeneous material coupled
with a three generations tree structure, as shown in Figure 2.2. We consider first a tree structure
with a very few numbers of generations in order to study in a tractable framework the influence
of the hydrodynamic resistance on the material.

    Boundary conditions.         We chose the domain to be fixed (zero displacement) on one
boundary and stimulated on the other. The pulsations ωi denote the ith angular eigenfrequency
of the system without the tree, see the appendix 2.C. We set the Dirichlet condition up1, tq “ 0,
and the Neumann condition τ ptq “ A sinpω2 tq on x “ 0 @t P R` .
    We chose the pulsation of the boundary condition to be ω2 for getting a visual point of
comparison.

   Initial conditions. A zero initial condition is imposed on displacement and velocity, the
material is initially at rest.

    Values of the physiological and physical parameters. We enforce the combination
pλ ` 2µq and all the other parameters to be equal to 1 ; the velocity of the wave deformation
is then c “ 1 m.s´1 . As most of the variables are normalized to one, we also enforce the equiv-
alent resistance of the resistance matrix to be equal to 1. For that purpose, we use the matrix
Rnorm “ RReq . The resistance matrix R is computed from the size of the first generation airway
which is assumed of length l0 “ 6 cm and of radius r0 “ 1 cm. Since, the aspect ratio of the
trachea is larger than the other airways, those values correspond to a reduced trachea. We do
not attach equivalent resistance of the subtrees to the terminal branches. This configuration
of parameters modeling non-physiological lungs is summed up in the appendix 2.E. We use it
again in the next subsection.


   Wave propagation and dissipation with a three generations tree                      b
The numerical simulations are performed from t “ 0 to t “ Tf , with Tf “ 2{c “ 2 s, c “ pλ`2µq
                                                                                            ρ   .
The final time Tf is then the time needed for the wave to do a round trip between one boundary
(x “ 0) and the other (x “ L “ 1 m).
    The black curves (4-curves) in Figure 2.3 show the propagation of a wave in the absence
of the tree, pi “ 0 @i. As the final time is Tf “ 2 s, the wave propagates through the material
without any loss of energy, reaches x “ 1 at time t “ 1 s and comes back to x “ 0 m at time
t “ 2 s, as expected.
    The red curves (o-curves) in Figure 2.3 show the propagation of the wave in the presence
of the tree structure. The wave is damped by the dissipation due to the viscosity of the air
occurring in the tree. Moreover, several regions of the domain are deformed before the arrival
of the deformation wave, see Figure 2.5. Actually, since we use Poiseuille’s model for the air
fluid mechanics in the tree, any change in pressures and airflows propagates instantaneously
throughout the tree. Hence, all the material is instantaneously affected by the change of the air
properties in the Ai .


                              Modelling the lungs to simulate tidal breathing for healthy and non-healthy
                   30                                                                               lungs


                                         time : 1/2s                                                                time : 1s
                   0.4                                                                            0.4
displacement (m)




                                                                               displacement (m)
                   0.2                                                                            0.2



                     0                                                                              0



                   -0.2                                                                           -0.2
                                                       without tree                                                              without tree
                                                       with level 2 tree                                                         with level 2 tree
                                                       acini boundary                                                            acini boundary
                   -0.4                                                                           -0.4
                          0       0.2   0.4      0.6        0.8            1                             0   0.2   0.4     0.6        0.8            1
                                         space (m)                                                                 space (m)

                                         time : 3/2s                                                                time : 2s
                   0.4                                                                            0.4
                                                                                                                                 without tree
                                                                                                                                 with level 2 tree
                                                                                                                                 acini boundary
displacement (m)




                                                                               displacement (m)
                   0.2                                                                            0.2



                     0                                                                              0



                   -0.2                                                                           -0.2
                                                       without tree
                                                       with level 2 tree
                   -0.4                                acini boundary                             -0.4
                          0       0.2   0.4      0.6        0.8            1                             0   0.2   0.4     0.6        0.8            1
                                         space (m)                                                                 space (m)

Figure 2.3: Propagation of the wave deformation with (o-red) and without (4-black) tree struc-
ture constraint at time t “ 4f “ 12 s, t “ 2f “ 1 s, t “ 4f “ 32 s and t “ Tf “ 2 s. The dash
                            T              T            3T

vertical lines show the boundaries of the pAi q1ďiďN .


    The Figure 2.3 also shows that the wave propagation, stimulated at the second natural angu-
lar frequency of the material, is perturbed by the tree. In the absence of the tree, if the material
is stimulated continuously by a periodic force with this pulsation its motion amplifies through
time and the phenomenon of resonance occurs. According to the theory of linear elasticity,
the vibration of the material would continuously amplify and the material would never break.
This is what we can observe from the displacement computed without considering the tree if we
extend the time of the simulation, see Figure 2.4. However, we observe that the displacement,
computed with the tree consideration, does not amplify in the course of the time. Hence, it
suggests that the tree affects the resonance phenomenon of the material. The subsection 2.4.2
studies specifically this behavior.


    Influence of the number of generations on the wave propagation
As the tree affects the deformation of the material, the size of the tree affects the material
displacement. Increasing the number of generations of the tree induces more terminal branches
and smaller Ai , and the deformation of the overall domain of the material becomes smoother,
see Figure 2.5 (left). This is due to smaller pressure shifts between two neighboring Ai , as seen
in the figure 2.5 (right). Let us denote by pis the pressure shift between Ai and Ai`1 , 1 ď i ă N .
We compute the mean pressure shift between all pressure shifts pis of a tree. We display, in
the Figure 2.5, the mean pressure shift for the different trees. As expected, we observe that in
average, the pressure shift between two neighboring Ai decreases as the generation in the tree
increases. Finally, the figure 2.5 (left) tends to suggest that different numbers of generation in


                     Study of the coupling between the tree and the elastic material through
                     non-physiological numerical simulations                                                                                                                                                 31


                                                                     time : 6s                                                                                        time : 10s
                                          2                                                                                          2
                                                                                   without tree                                                                                          without tree
                                                                                   with level 2 tree                                                                                     with level 2 tree
                                                                                   acini boundary                                                                                        acini boundary
                       displacement (m)




                                                                                                                  displacement (m)
                                          1                                                                                          1



                                          0                                                                                          0



                                          -1                                                                                         -1



                                          -2                                                                                         -2
                                               0         0.2     0.4         0.6         0.8           1                                        0           0.2       0.4          0.6         0.8            1
                                                                     space (m)                                                                                        space (m)

                     Figure 2.4: Propagation of the wave deformation with (o-red) and without (4-black) tree struc-
                     ture constraint at time t “ 6 s and t “ 10 s. The dash vertical lines show the boundaries of the
                     pAi q1ďiďN .


                     the tree induce different damping influences in the elastic material. However, the displacements
                     are displayed for a small time, when the deformation wave has not propagated yet. Actually,
                     after a small increment of time (t “ 1{3 s), we can observe that for different tree sizes, the
                     damping influence on the displacement amplitude is quite similar, see Figure 2.6. We recall
                     that for this numerical simulation, the equivalent resistances of the different trees are equal.
                     This suggests then that, for two symmetrical trees with same equivalent resistances, one with a
                     small number of generations and the other one with a large number of generations, the induced
                     damping influences on the displacement amplitude are quite similar.


                                                               time : 1/10s                                                                                                     time : 1/10s
                                                                                                           between the terminal branches (Pa)




                                                                                                                                                0.5
                    0.01                                               without tree                                                                                                      2 terminal branches
                                                                                                                                                                                         4 terminal branches
                                                                                                               mean pressure difference




                                                                       with level 1 tree structure
                                                                       with level 2 tree structure                                              0.4                                      8 terminal branches
                   0.008                                                                                                                                                                 128 terminal branches
displacement (m)




                                                                       with level 3 tree structure
                                                                       with level 7 tree structure
                   0.006                                                                                                                        0.3


                   0.004                                                                                                                        0.2

                   0.002
                                                                                                                                                0.1
                      0
                                                                                                                                                    0
                           0                       0.2         0.4         0.6          0.8            1                                                2         3         4        5           6            7   8
                                                               space (m)                                                                                    number of generations in the tree

                     Figure 2.5: Left: Deformation of the material without tree structure (4-black) and with tree
                     structures of 2 (`-blue), 3 (o-red), 4 (˚-purple) and 8 (`-green) generations at time t “ 20f “ 10
                                                                                                                   T     1

                     s. The time t is intentionally small for a better visualization. Particularly, at this time, the wave
                     has not propagated much. However we can observe displacements all along the domain at the Ai
                     boundaries that depends of the size of the tree. Indeed, more regions in the material are affected
                     if the number of generations of the tree is large. Right: Mean pressure difference between the
                     terminal branches of a tree for different tree sizes. The pressure difference is computed from
                     two neighboring Ai for all couples of terminal branches in a tree. Then the mean is computed
                     for each tree. Four size of tree are considered : 2, 3, 4 and 8 generations tree.


       Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  32                                                                         lungs


                                                      time : 1/3s
                                     0.5
                                                                               without tree
                                                                               with level 1 tree structure
                                     0.4                                       with level 2 tree structure



                  displacement (m)
                                                                               with level 3 tree structure
                                     0.3                                       with level 7 tree structure


                                     0.2

                                     0.1

                                       0

                                     -0.1
                                            0   0.2   0.4                          0.6         0.8           1
                                                      space (m)
Figure 2.6: Deformation of the material without tree structure (4-black) and with tree structures
of 2 (`-blue), 3 (o-red), 4 (˚-purple) and 8 (`-green) generations at time t “ 31 s.

    Wave propagation and dissipation with a level 2 tree with a local increase of
resistance
If the hydrodynamic resistance of one terminal branch increases, the region Ai in the material
fed by this branch would be less prone to deform. We arbitrarily increase by a factor 100 the
resistance of a branch of the 3 generations tree associated to the region A4 , see (a) on the Figure
2.7. As we enforce no displacement at x “ L, the material does not deform much in the region
A4 , see (b) in the Figure 2.7. Note that the tree in this case is not anymore symmetrical.

                                                                                                             time : 1/2s

                                                                                0.15
                                                            displacement (m)




                                                                                 0.1


                                                                                0.05


                                                                                   0
                                                                                   level 2 symmetrical tree structure
                                                                               05
                                                                                   level 2 tree structure with local increased resistance
                                                                               -0.05
                                                                                   acini boundary


                                                                                       0        0.2          0.4        0.6       0.8       1
                                                                                                             space (m)

Figure 2.7: Comparison between the material displacements in the case of a three generations
symmetrical tree and in the case of a three generations tree with a local increase of resistance.
Left: A three generations tree. The resistance of the branch indicated by the arrow and feeding
the region A4 is increased. Right: Displacement at time t “ 12 s in the case of a three generations
symmetrical tree and a three generations tree with a local increase of resistance (see left). The
displacement associated to the region A4 is close to zero, as expected. The dissipation of the
tree feeding the regions A4 becomes strong enough to prevent the deformation of the material.


Study of the coupling between the tree and the elastic material through
non-physiological numerical simulations                                                         33


2.4.2    The resonance phenomenon in the coupled model
The previous subsection shows the influence of the tree on the material displacement. Typically,
the tree acts as a damping which decreases the amplitude of the material deformation. The effects
of the tree are applied instantaneously at each time step and particularly at the Ai boundaries.
It also shows the influence of the size of the tree. Finally, it suggests that the damping of the tree
acts on the resonance of the material. The phenomenon of resonance of the elastic material can
be interesting for our purposes. In our model, the deformation of the elastic material induces
flow of air in the tree structure. This mimics the deformation of the lung’s tissue and the induced
flow of air inside the pulmonary tree. If the material resonates, its deformation is maximized as
well as the induced air flow in the tree. Similarly, if the flow of air inside the pulmonary tree is
maximised, this would favour the displacement of the secretions. The resonance of the material
occurs around the natural pulsations of the material. The deformed shape of the material when
the latter vibrates at one of its natural pulsations represents a natural mode [114]. Hence, first,
the subsection studies the impact of the tree on the natural modes of vibration of the material.
    The phenomenon of resonance arises in oscillatory systems [114]. A simple way to analyze
such system is to study harmonic oscillators with one degree of freedom. With one degree of
freedom, an harmonic oscillator describes, for example, the oscillations of a mass tied to a spring,
of a pendulum or of an electronic circuit. The motion of such oscillator can be analytically com-
puted and we can derive from it properties of resonance. Then, this subsection also studies, with
numerical simulations, the impact of the tree on the resonance of the motion by comparison with
harmonic oscillators with one degree of freedom. The configuration of parameters is the same as
previously. We recall that, in this work, the degrees of freedom (DoF) are the positions where
the unknown elements of a system are computed.

    Impact of the tree on the natural modes
As described above, the natural modes of a vibrating system (such as an elastic solid) with
several degrees of freedom are the deformed shape of the motion of the oscillator when vibrating
at its natural pulsations [114]. The first natural mode corresponds to the motion of the oscillator
vibrating at its first natural pulsation, the second natural mode is associated with the second
natural pulsation and so on. The number of natural pulsations of a vibrating system is equal
to the number of degrees of freedom of the vibrating system. Here we compare the four first
natural modes of vibration of our elastic material with and without the damping tree.
    In the absence of the tree, the unidimensional system of equations (2.17) with a zero dis-
placement boundary condition at one boundary and a sinusoidal Neumann condition on the
other boundary, can be assimilated to the deformation of an elastic bar fixed at one end and
stimulated on the other end. Hence, as detailed in the appendix 2.C, the natural pulsations of
the material can be computed and are the ωk “ p2k´1qcπ  2L     for k P J1, `8K, with c the velocity of
the wave deformation and L the length of the 1D material. We compare the displacements of
the material without and with the damping induced by the tree, using two different trees with
three and eight generations. We use the same configuration as in the previous subsection.
    As seen earlier, we can observe in the figures in Figure 2.8 the influence of the tree and
of its size on the material displacements at the four first natural angular frequencies. As the
number of generations of the tree increases, the damping influence of the tree is spread over
the material. As seen previously, the deformation over the domain is smoother with the eight
generations tree than with the three generations tree. Then, without the tree, we observe the
four natural modes of vibrations of the material. With higher natural pulsation (ω4 ), we observe
that the frequency of the deformation wave is higher, as expected. However, with the tree, we
see that the natural modes of vibration of the tree are altered. Moreover, we observe that the
amplitude of the displacement is lower for higher natural pulsations than for lower ones. As the
phenomenon of resonance occurs around the natural pulsations, this suggests that the damping
effect of the tree, which is spread in several regions of the domain, tends to alter the phenomenon
of resonance. To understand how the damping of the tree acts on the resonance of the material,
we will describe somme properties of harmonic oscillatory system.


                                 Modelling the lungs to simulate tidal breathing for healthy and non-healthy
               34                                                                                      lungs




                                     Natural angular frequency : ω                                                        Natural angular frequency : ω
                                                                        1                                                                                    2
                           0.6                               without tree                                       0.4                               without tree
                                                             with level 2 tree                                                                    with level 2 tree
                                                             with level 7 tree                                                                    with level 7 tree
                           0.5
        displacement (m)




                                                                                             displacement (m)
                                                             0.225                                              0.3
                           0.4

                           0.3                                0.22                                              0.2

                           0.2
                                                                                                                0.1
                                                                            0.245
                           0.1

                            0                                                                                    0
                                 0    0.2     0.4      0.6        0.8            1                                    0    0.2     0.4      0.6        0.8            1
                                               space (m)                                                                            space (m)

                                     Natural angular frequency : ω                                                        Natural angular frequency : ω
                                                                        3                                                                                    4
                   0.25                                      without tree                                                                         without tree
                                                             with level 2 tree                                                                    with level 2 tree
                                                             with level 7 tree                          0.15                                      with level 7 tree
                           0.2
displacement (m)




                                                                                     displacement (m)



                   0.15
                                                                                                                0.1

                           0.1
                                                                                                        0.05
                   0.05


                            0                                                                                    0
                                 0    0.2     0.4      0.6        0.8            1                                    0    0.2     0.4      0.6        0.8            1
                                               space (m)                                                                            space (m)

Figure 2.8: Comparison between the material displacements for the non coupled and coupled
cases with a three and a eight generations tree at the four first natural modes. The material is
stimulated at x “ 0 by a sinusoidal force whose pulsation varies between the fundamental and
the fourth eigen pulsations. The natural pulsations are computed in the absence of three are
defined as ωk “ p2k´1qcπ
                   2L    for k P J1, `8K. The displacements are displayed at the time when the
wave has propagated from x “ 0 to x “ L “ 1 (t “ 1{c “ 1s).


    Description and properties of resonance for a harmonic oscillator with one de-
gree of freedom
A harmonic oscillator is a system that oscillates around a position of equilibrium under the
action of a restoring force proportional to the displacement [120, 43]. The motion of a harmonic
oscillator is described by a sinusoidal pattern. The comprehension of a system of harmonic oscil-
lator on simple cases can eases the study of more complex systems like our. Harmonic oscillator
with one degree of freedom (DoF) is a typical simple case. In our model, the equation ruling our
model is not defined for one DoF but for either an infinite number of DoF for the continuous
system (2.17) or for a finite number of DoF for the discretized system (2.18). However, we will
see that they have similar behaviors. Here, we describe the main properties of a harmonic oscil-
lator with one degree of freedom. We refer the reader to the appendix 2.D and to the references
[120, 43] for more details.

    The motion of an oscillator can be forced by an external force, and/or damped by a damping
influence. Here, we will discuss the case of forced and damped oscillator. For the explanation,
we denote by m the mass of the oscillator, c the damping coefficient, k the stiffness coefficient
of the oscillator and f a driving force. The evolution in time of the motion of the forced and


Study of the coupling between the tree and the elastic material through
non-physiological numerical simulations                                                                  35


damped oscillator designated by xptq is described by the following equation :

                                 d2 xptq      dxptq
                                      2
                                         ` 2ξ        `ω 2
                                                        0 xptq “           lohptq                       (2.28)
                                   dt
                                 loomoon        dt
                                           looomooon  loomoon                omoon
                                                            stiffness    driving force
                               acceleration     damping
                                                        b
   with ξ “      b
                2m   the damping coefficient, ω0 “          k
                                                            m   the natural angular frequency of the oscillator
and h “   mf.
          1
                From the parameter of the system, the Q-factor or quality factor can be derived :
                                                            ω0
                                                       Q“
                                                            2ξ
It defines the intensity of the damping. The higher is Q, the lower is the damping. Solutions
of (2.28) can be calculated [120, 43]. Particularly, we know that the solution of (2.28) is a
combination of the homogeneous solution xh computed without the forcing term (h) and a
particular solution xp with the forcing term. The homogeneous solution tends to zero when the
time goes to infinity. Hence, the solution tends to the particular solution as the time progresses.

                                            xohmo
                                     xptq “ lo  on `xp ptq ÝÑ xp ptq
                                               ptq
                                                                  tÑ`8
                                                 ÝÑ0
                                                 tÑ`8

    This determines two regimes : the transient phase, for small time, and the steady-state phase
when the time is sufficiently large. The transient phase lasts a characteristic time of the order
of 1{ξ and, consequently, the solution tends quicker to the steady state when the damping is
large. In the case of sinusoidal driving force hptq “ Hcospωtq, the particular solution is

                                              xp ptq “ Xcospωt ` φx q
    where X and φx are constants determined according to the characteristics of the system and
                                                            ? 43], the amplitude X is defined
of the stimulation. From an algebraic or a complex method [120,
and we deduce that the amplitude X is maximized if Q ą 1{ 2 for pulsation equal to
                                             b
                                        ωr “ ω02 ´ 2ξ 2
    The pulsation ωr is the resonance pulsation of the damped and forced oscillator. We see
that the intensity of the damping influences the resonance pulsation of the system that leads
to three cases. Without damping, the resonance pulsation is exactly the eigen pulsation of the
oscillator. For small damping, the resonance pulsation is slightly less than the natural pulsation
and for high damping, it is actually not defined anymore : if the oscillator is too much damped,
no more resonance can occur. If the oscillator is continuously forced at the resonance frequency,
the amplitude of its motion amplifies through time or reaches a maximum compared to others
pulsations, this is called the displacement-resonance. Additionally, a similar phenomenon occurs
for the velocity. The latter is maximised if the oscillator is forced at the natural pulsation ω0
and for any value of the damping, this is the velocity-resonance.
    In the case of harmonic oscillator with one degree of freedom, we define the kinetic energy
                                  dt and the potential energy by Ep “ 2 kx ptq. The study of har-
by Ek “ 12 mv 2 ptq with vptq “ dxptq                                   1  2

monic oscillator also tells us that without damping, the kinetic and potential energies are equal
and in anti-phase. With damping, the behaviors of the kinetic and potential energies depend on
the intensity of the damping. The kinetic energy, defined with the velocity v, is maximised for
pulsation of the driving force equal to the natural pulsation. The potential energy, defined with
the displacement x, follows the same pattern as the amplitude X of the particular solution. We
recall that a more detailed description of the theory presented in this paragraph can be found
in the appendix 2.D.

   In our case, the coupled model involves several degrees of freedom with non-local damping
terms, hence the solution at each degree of freedom is not easily explicitly defined. However,


       Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  36                                                                         lungs


thanks to the numerical simulation, we can study the resonance of the material. Particularly, we
can study how the coupled system responds to different stimulations (different frequencies) and
compare the behaviors of the solutions to those of a simple damped oscillator with one degree
of freedom, see above.

   Response of the material to different stimulations with and without damping

    In order to study the response of the material submitted to different stimulations, we have
computed three quantities averaged over the final time Tf for the non-coupled and the coupled
system : the total kinetic (Ek ) and elastic (Ee ) energies and the total quantity of displacements
(Ru ) averaged over the domain. The unit of the kinetic and elastic energies is the Joule and
the one of Ru is the meter. We recall that a sinusoidal pressure τ “ Asinpωtq is applied at one
boundary (x “ 0) of the elastic material, with A “ 1. Here, the pulsation ω is set in the range
from ω101 to ω4 ` ω21 . We impose a zero-displacement condition on the other boundary (x “ L).
The quantities Ek , Ee and Ru are defined as

                                        1 ρ                    Bupx, tq 2
                                                 ż Tf ż L
                                 Ek “                                     dxdt
                                        2 Tf      0        0      Bt
                                     1 pλ ` 2µq                   Bupx, tq 2
                                                      ż Tf     żL
                              Ee “                                           dxdt
                                     2    Tf           0        0    Bx
                                                                           ˙ 21
                                           1
                                      ˆ          ż Tf ż L
                                                                 2
                               Ru “                            u px, tqdxdt
                                          Tf L    0        0
   We set the final time to the time that the wave deformation does six round trips between
one boundary (x “ 0) and the other (x “ L) in order to get significant results, namely Tf “ 12 s.

     In Figure 2.9, for the non-coupled case, the total displacement reaches a global maximum
at the fundamental angular frequency (ω “ ω1 ) and local maxima at the angular frequencies
ωi , i P J2, 4K, as expected. However, for the coupled case, the total displacement has only a
global maximum for a pulsation lesser than the fundamental pulsation (ω ă ω1 ). Looking at
the kinetic and elastic energies displayed on Figure 2.10, we observe that the maximum of the
total displacement for the coupled case is particularly due to the elastic energy which is larger
than the kinetic energy for pulsations below the fundamental natural pulsation (Ee ą Ek for
ω ă ω1 ). It is understandable in the sense that as the applied pressure acts with low pulsations
here, the material has the time to stretch and to stock energy under the form of elastic energy.
While it is true for low pulsation, it is not true for high pulsations as we can observe. The elastic
energy decreases as the pulsation increases to the point of being equal to the kinetic energy for
pulsations around the fundamental natural pulsation (Ee « Ek for ω « ω1 ). Then, for higher
frequencies, the elastic energy is lower than the kinetic energy. Additionnaly, the kinetic energy
is maximal for pulsations close to the natural pulsation. Moreover, as shown in Figure 2.10, the
average kinetic and elastic energies are globally equal in the absence of damping and reach global
and local maxima at the natural angular frequencies. The results show that the behaviors of
the solution of our model are similar to the one of a harmonic oscillator with one DoF. It shows
that in the absence of the tree, the amplitude of the displacement amplifies at the natural eigen
frequencies and that the kinetic and the elastic energy are equal over a period of the driving
force. With the damping of the tree, we observe that the maximum of the amplitude of the
displacement is not reached for pulsations around the eigen pulsations but only for the smallest
pulsation. According to the theory of harmonic oscillators, the damping is high compared to
the elastic properties of the material and prevent resonance.


                 Study of the coupling between the tree and the elastic material through
                 non-physiological numerical simulations                                                                                              37




                                                          ω                    ω                           ω                     ω
                                                              1                    2                           3                     4
                                         0.5

                                         0.4
                                 R (m)



                                         0.3                                                                       without tree
                                     u




                                                                                                                   with tree
                                         0.2

                                         0.1

                                          0
                                                          2            4                 6                 8            10
                                                                                                      -1
                                                                               ω (rad.s )
                 Figure 2.9: Spatial and temporal total displacement of the material (Ru ) for the non coupled
                 case and the coupled case with a eight generations tree. The displacement is computed over 12
                 s. The pulsation of the sinusoidal stimulation varies a range of pulsations r ω101 , ω4 ` ω21 s. The
                 vertical dashed lines display the values of the four first natural angular pulsations computed in
                 the absence of the non coupled case.

                               Without the tree structure                                                          With an eight generations tree
             5
                       ω                 ω                ω            ω                            0.25       ω             ω                ω            ω
                           1                 2                3            4                                       1             2                3            4
             4
                                                                                                     0.2
Energy (J)




                                                                                       Energy (J)




             3
                                                                                                    0.15

             2
                                                                                                     0.1

             1                                                                                      0.05

             0                                                                                        0
                        2           4            6        8       10                                           2         4           6        8       10
                                                     -1                                                                                  -1
                                         ω (rad.s )                                                                          ω (rad.s )

                 Figure 2.10: Temporal total kinetic Ek and elastic Ee energies for the non-coupled (left) and
                 coupled (right) system with a eight generations tree structure produced over 12 s by a sinusoidal
                 stimulation for several pulsations varying in r ω101 , ω4 ` ω21 s. The vertical dashed lines display the
                 values of the four first natural angular pulsations computed in the absence of the coupling with
                 the tree.


                     The comprehension of the resonance phenomenon of the lungs could help on the choice of
                 the configuration of the HFCWO device by suggesting optimal frequencies that could potentially
                 maximize the deformation. The previous results suggest that finding a fundamental pulsation
                 for the lungs in the absence of damping could lead to resonance and would maximize the defor-
                 mation, the displacement or the velocity. However, from the perspective of harmonic oscillators,
                 the resonance is driven by the intensity of the damping. Hence, we need to characterize the


        Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  38                                                                          lungs


physical property of the lungs (elastic properties as well as lungs resistance) to study the reso-
nance for physiological lungs model.

    With physiological data for the lungs, i.e. size, stiffness and volumetric density (see subsec-
tion 2.5.1 and the table in the 2.E), the definition 2.39 brings an estimation of f1 “ 2πω1 “ 6.5
Hz for the fundamental natural frequency of the lungs. Knowing that the numerical simulations
of this chapter are dedicated to the ventilation at rest, with a frequency of around 1{5 Hz, much
lower than f1 , we will focus on the resonance in the lungs in the frame of HFCWO, that is
studied in the next chapter. Before that, we need to calibrate our model for physiological cases.
In the next section, we will apply our model on physiological cases to study the ventilation at
rest in healthy and non-healthy lungs.


2.5     Rest ventilation of healthy and non-healthy lungs
This section aims at validating and applying the model on human lungs, by mimicking the ven-
tilation at rest. It allows to set the configurations of parameters of the model for physiological
simulations and it highlights the influence of the parameters of the model by comparisons be-
tween healthy and non-healthy situations. We will first calibrate the model with tidal breathing
(subsections 2.5.1 and 2.5.2). Then the model will be applied to cases of non-healthy lungs
(subsection 2.5.3). All the configurations of parameters used in this section are gathered in the
appendix 2.E and will be used in the next chapter.

2.5.1    Calibration of the model using rest ventilation
We want to use our model to mimic the dynamics of the human lung. However, several pa-
rameters need to be adjusted in order for our model to give predictions compatible with the
physiology. The ventilation at rest in human is thoroughly documented and studied in the liter-
ature [136, 76, 87, 109, 98], hence it is used to calibrate our model. Once calibrated, our model
is used to mimic different pathologies of the respiratory system.
    This subsection is then dedicated to mimic the pulmonary ventilation at rest for healthy rep-
resentative adult lungs. We consider the domain Ω “ r0, Ls, L P R composed of an homogeneous
material that mimics the lung’s tissue. Here, we decompose the domain into 128 subdomains
pAi qi“0,...,127 which are fed by a tree of eight generations. The size of the tree is chosen so that
the calculation time remains tractable. The deepest generations of the lung are mimicked using
equivalent resistances added at each terminal branches of the eight generations tree, as explained
in subsection 2.2.1.
    Our model of the bronchial tree is idealized and does not take into account the oesopha-
ryngeal pathway, the detail of the geometry of the bifurcation and the inertial effects of the
air flow [104, 105]. As a consequence, the hydrodynamic resistance of the tree and the result-
ing damping of the tissue deformation are underestimated if we base its computation on the
geometry of our idealized tree only. Hence, the hydrodynamic resistance of the idealized tree
needs to be adjusted in order to get pressures and airflows in the terminal branches of the tree
compatible with the physiological values. For that purpose, we introduced a corrective factor
rh for the hydrodynamic resistance of each branch of the tree that allows to reach satisfactory
orders of magnitudes for both pressures and airflows. The corrective factor is also applied to
the virtual subtrees attached to the terminal branches of the tree, see the subsection 2.2.1.2.
The equivalent resistance Req of the tree with the adjusted resistance is then compatible with
the physiological data, that estimates the lung’s hydrodynamic resistance to range from 0.5 to
4 cmH2O.L´1 .s in the case of healthy adults [87].

   Parameters values. The material properties are taken from [111].
   Since the lung’s parenchyma is filled with 10% of tissue and 90% of air, the volumetric
mass density ρ of the material is set to 10% of the volumetric density of water, i.e. ρ “ 100
kg/m3 [111, 32]. This value for the density is probably not adapted to large volume variations


Rest ventilation of healthy and non-healthy lungs                                             39


of the lung, for which the air–tissue ratio could be significantly affected, typically during forced
expiratory/inspiratory maneuver. However, for normal ventilation and especially for HFCWO
conditions, we can reasonably assume that an air–tissue volume ratio of 90% is a good approxi-
mation.
    We use the same Young’s modulus E “ 1256 Pa and Poisson’s ratio ν “ 0.4 as in [111].
From these data, we can compute the quantity λ ` 2µ used in our model using the equivalency
between pE, νq and pλ, µq and the relationships λ “ p1´2νqp1`νq
                                                            Eν
                                                                   and µ “ 2p1`νq
                                                                               E
                                                                                   .
    The resistance matrix R is built using physiological data for trachea radius and length :
r0 “ 1 cm and l0 “ 6 cm. The corrective factor is set so as to get the equivalent resistance
equal to around 1.5 cmH2O.s.L´1 : rh “ 30. The corrected resistance matrix is then denoted
Rh , mimicking representative healthy lungs resistance. For comparison, without the corrective
factor, the equivalent resistance of the tree is about 0.05 cmH2O.s.L´1 .
    We set the length L to be of the same order of magnitude of adult lungs, namely L “ 20 cm.
    Finally, the amplitude of the boundary constraint (σpuq.n “ τ ) A is set to 200 Pa. This
value for A allows our model to predict values for air flows and pressures in the airway tree that
are compatible with the physiology.

   For this configuration, the velocity of the deformation wave through the lungs is about 5
m.s´1 . The time the wave takes to propagates from one boundary to the other is then 40 ms.
Moreover, the corresponding fundamental natural frequency is equal to f1 “ 6.5 Hz.

    Initial conditions. The initial condition (t “ 0 s) corresponds to the material being at a
rest state, i.e. no initial displacement and no initial velocity.

    Boundary conditions. The Neumann condition at x “ 0 is adjusted to mimic the pres-
sure applied by the diaphragm to the lungs during rest ventilation, σpuq.n “ τ “ A2 pcospωtq ´
1q, with A P R and ω “ 2π  5 rad.s´1. It mimics a negative pressure that moves back and forth
the material, see Figure 2.11 (left). The angular frequency ω is chosen so that the duration of a
ventilation cycle is T “ 5 seconds (2.5 seconds inspiration and 2.5 seconds expiration) mimick-
ing an idealized symmetric ventilation at rest [136]. Moreover, we assume a zero displacement
Dirichlet condition at x “ 1.

    To go from computed 1D quantities to interpretable 3D quantities, we involve a section
whose surface area is denoted SL in section 2.2.3. We focus our analysis on the variations of
the mouth airflow Fm along time as this quantity is easily measurable in a clinical frame. The
mouth airflow Fm is computed as the sum of all the airflows in the terminal branches of the
tree,
                                    „           N     „ 
                                      Bu                Bu
                                                                                         (2.29)
                                                 ÿ
                                 Fm        “ SL     Fi
                                      Bt        i“1
                                                         Bt

   Results
At rest, a human ventilates around 6 to 8 L/min [136, 48] and a tidal volume of about 500 mL
per respiratory cycle. With the adjusted resistance, our model predicts a tidal volume of 512
mL. These results are shown in Figure 2.11 (right).

    For a future use, the configuration of parameters used here is the default configuration of
healthy human lungs during ventilation at rest. It is called the healthy lungs model. The next
subsections will play with values of parameters and only the difference regarding the healthy
lungs model will be denoted. The configurations of parameters mimicking non-healthy lungs are
called non-healthy lungs model.

  A more realistic respiratory function
We notice that other signals mimicking the action of the diaphragm can be used to model


                                   Modelling the lungs to simulate tidal breathing for healthy and non-healthy
                        40                                                                               lungs


                                   INHALATION     EXHALATION




                                                                                                   INHALATION


                                                                                                                  EXHALATION
                          A



    Figure 2.11: Left: Pressure applied to simulate the action of the diaphragm (two respiratory
    cycles are shown). The signal is sinusoidal in time with a period of 5 seconds and an amplitude
    A. Right: Mouth airflow and tidal volume during four respiratory cycles of 5 seconds each with
    the adjusted hydrodynamic resistance. The airflow and tidal volume data are displayed after
    they have reached a stationary state (t ě 10 s).


    more realistic ventilation instead of the sinusoidal one. For example, we can adapt the function
    proposed in [42] on a five seconds period per respiratory cycle
                                                                                πt
                                                                                           0 ď t ă 1.1
                                                                      $
                                                                      ’ ´A.sinp 2.2 q
                                                                                           1.1 ď t ă 1.3
                                                                      ’
                                                                      & ´A
                                                             σpuq.n “
                                                                      ’ ´A.sinp πpt´1.1q
                                                                                   0.4 q   1.3 ď t ă 1.5
                                                                        0                  1.5 ď t ă 5
                                                                      ’
                                                                      %

        In this case, our model predicts a tidal volume of 501 mL, see Figure 2.12. However, as the
    produced results are quite quantitatively equivalent, we will rather implicitly use the sinusoidal
    force to save time calculation (20 times faster using the sinusoidal force) and exclude any other
    functions, except explicitly stated.

                          INHALATION            EXHALATION
                          0
                                                                                                                EXHALATION
                                                                                            INHALATION
applied pressure (Pa)




                         -50



                        -100



                        -150



                        -200
                          A
                               0           2           4              6   8    10
                                                           time (s)

    Figure 2.12: Left: Pressure applied to simulate a more realistic action of the diaphragm [42] (two
    respiratory cycles are shown). The function models a five seconds period of a respiratory cycle
    with 1.5 seconds for inspiration and 3.5 seconds for expiration. Right: Mouth airflow and tidal
    volume during four respiratory cycles of 5 seconds each with the same adjusted hydrodynamic
    resistance as in Figure 2.11. The airflow and tidal volume data are displayed from the same
    time t ě 10 s as in Figure 2.11.


Rest ventilation of healthy and non-healthy lungs                                              41


2.5.2    Tidal breathing between individuals with healthy lungs
The previous subsection mimics the ventilation at rest for healthy adult lungs. For that purpose,
we chose the parameters to be in accordance with the data of average lungs. However, for healthy
adults, the literature proposes variations on the data between individuals that can induce, in
our model, significant differences in lungs behavior for a similar ventilation. This subsection
examines the influence of the size and resistance of the lungs as well as the amplitude of the
applied force mimicking the action of the diaphragm.
    As mentioned in the previous subsection, the lung’s hydrodynamic resistance in the case of
healthy adults ranges from 0.5 to 4 cmH2O.L´1 .s [87]. Actually some report 7 cmH2O.L´1 .s
[10] or even for infants 50 cmH2O.L´1 .s [66]. If we consider two healthy lungs of same volume
and of same elastic property but with different resistances, for example if they have differences
in their bronchial tree structure, the force needed to inflate a same volume would not have the
same amplitudes. For example, for two lungs with resistances of 0.5 cmH2O.L´1 .s and of 4
cmH2O.L´1 .s, both having the same size and elastic properties, our model predicts that the
amplitude of the force mimicking the action of the diaphragm varies respectively from 175 Pa to
325 Pa to ventilate a same tidal volume of 500 mL. That would imply that among individuals,
some would force more to ventilate than the others. If we compare with the lungs resistance of
infants which reach much stronger value because of the smaller size of their lungs, this argument
is even stronger. If we consider that the lungs with higher resistance have a lesser size, let’s say
L “ 15 cm and equivalently, the one with a lesser resistance have a bigger size, say L “ 25 cm,
our model predicts that the lesser size lungs would need a force five times bigger in amplitude
than the bigger size lungs to ventilate a same tidal volume of 500 mL.
    The previous results have to be interpreted with care and in the limit of the model, but they
show the influence of the variations of the resistance and the size of the lungs, as well as of the
amplitude of the action of the diaphgram, on the ventilation. In reality, there are nuances to
be taken into account about these factors. For example, the tidal volume of 500 mL used for
the calculation is an average for healthy adult lungs and vary among individuals according to
their size, gender, aging or ancestry [122]. For example, it is known that women have lesser
lungs volume than men that induce differences in the respiratory properties [88]. Moreover, the
lung’s hydrodynamic resistance expressed in the data found in the literature is a combination of
several resistances that air encounters during all the trip from the ambient air to the exchange
surface in the lungs and not of the resistance of the tree only as we use [87]. More specifically, as
mentionned in the previous subsection, the lung’s resistance is the combination of the resistance
of the upper airway (from the nose to the trachea), the resistance of the tree including the role
of inertial effects and of bifurcations and the one of the tissue [87]. All of those resistances are
more or less involved according to the respiratory behavior, namely the resistance of the upper
airway is stronger during nasal breathing or the resistance of the tissue is lower at TLC (total
lung capacity, when the volume is maximal) [87]. Finally as presented in the first chapter, the
diaphragm is not the only actor during the ventilation, although being the main one at healthy
rest ventilation. For example, we can name the intercostal or abdominal muscles.
    To be functional and efficient, the respiratory system deals then with numerous variables
which interact and induce differences among healthy individuals. As our unidimensional model
does not take into account all of those parameters and nuances, our use of lungs data found
in the literature has to be understood as a global and average view of the lungs. Typically,
the resistance of our tree mimics the overall lungs resistance ; the force modeling the action
of the diaphragm includes the action of all respiratory muscles ; or the size of the lungs is an
idealized and characteristic size. Our uni-dimensionnal model can then produces qualitative and
comparative predictions but cannot be completely quantitative.


2.5.3    Tidal breathing for non-healthy lungs
In the case of non-healthy lungs, the anatomic and physiological properties of the respiratory
system change and affect its functioning. This section investigates the impact of those changes on


          Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  42                                                                            lungs


the ventilation for different respiratory diseases, typically asthma, chronic obstructive pulmonary
disease (COPD) and cystic fibrosis (CF). It also shows that our model is able to reproduce known
behaviors. It also allows to set the configurations of parameters for non-healthy lungs.


2.5.3.1     Asthma

As described in the chapter 1, one of the main symptom of asthma is the constriction of the
bronchial airways due to perturbing stimulations such as the pollution, a emotional stress or a
respiratory overactivity, [94, 15, 139]. The constriction of the bronchi leads to an increase of
the lung’s hydrodynamic resistance that can reach 15 cmH2O.L´1 .s [116]. In this study we will
consider this value as the lungs resistance of an asthmatic lungs and use the values set in the
default configuration of healthy lungs for the other parameters.
     In the case of an asthma crisis, the airways of the bronchial tree constrict step by step,
that induces a raise of the resistance of the lungs and consequently, perturbs the flow of air
in the airways. Hence, the muscles involved in ventilation have to compensate the resistance
increase by intensifying their effort. We simulate an asthma attack by increasing step by step
the resistance of the 17 generations of the tree with another corrective factor denoted rnh . The
corrective factor rnh is used also for the COPD and the CF study. The corrective factor rnh is
applied on the healthy lungs resistance Rh for the airways of the bronchial tree only. We assume
that the airways constriction for asthma and COPD or the mucus overproduction for CF affect
the bronchial tree only. This allows us to estimate the order of magnitude of the constriction
of the bronchial airways when simulating non-healthy lungs. Our model predicts that to reach
an equivalent resistance of 15 cmH2O.L´1 .s, the radius of the bronchial tree airways has to be
reduced by a factor 1.8. In the case when the muscles involved in the ventilation do not intensify
their effort, with a resistance of 15 cmH2O.L´1 .s, the tidal volume is of 100 mL. Moreover, in
order to ventilate a tidal volume of 500 mL, the model suggests that the muscles have to apply
a force 5 times stronger which would represent the force needed for moderate activity in case
of healthy lungs (around 30 L.min´1 ). In our model, the quantity of air ventilated is linearly
dependant of the amplitude of the applied force, that was expected since our model is linear in
A.
     The Figure 2.13 shows the effects of the asthma crisis on the ventilation, starting at t “ 20
s with a lungs resistance increasing progressively from 1.5 cmH2O.L´1 .s to 15 cmH2O.L´1 .s.
Here, the respiratory muscles do not intensify their effort. We observe a progressive decrease of
the air flow coming in as well as the air flow coming out. It is understandable in the sense that,
as the muscles do not compensate the increase of the resistance, the lungs cannot completely run
out and fill up. In reality, during an asthma attack, the energy cost of ventilation is increased :
the force exerted by the diaphragm raises during inhalation and the exhalation is no longer done
passively but actively, with the help of intercostal and abdominal muscles, as during exercice.
Moreover, in addition to the raise of the work of breathing, the time period of the respiratory
cycle can also increase to allow the ventilation of a proper volume of air. However, airflow
limitation is not always compensated and the phenomenon of pulmonary hyperinflation, that
will be discussed in the next subsection (COPD), can occur in acute severe asthma.
     In the Figure 2.14, we observe that, in the range of healthy lungs resistances, the amplitude
of the applied pressure increases slower than at higher resistances as the resistance increases.
The variation of the amplitude is higher from 6 cmH2O.L´1 .s (actually linearly according to
the resistance). It would suggest that for average lungs in the range of healthy lungs resistances
(between 0.5 cmH2O.L´1 .s to 4 cmH2O.L´1 .s), a small variation in the resistance requires
a small variation in the effort amplitude of the respiratory muscles to ventilate a same tidal
volume. For higher lungs resistance (for constricted airways), this same small variation requires
a higher variation in the amplitude effort of the respiratory muscles. The model suggests, with
its limitations, that the structural properties of the lungs, in terms of elasticity and size, would
be adapted to authorize the variations of resistance between the individuals with relatively small
change in respiratory muscles effort.


Rest ventilation of healthy and non-healthy lungs                                                                                            43




              airflow (L/min)
                                                            10
                                                             0
                                                    -10

                                                                                            20        30         40         50         60
                                                                                                        time (s)
                                           500
            volume (mL)




                                           400
                                           300
                                           200
                                           100

                                                                                            20        30         40         50         60
                                                                                                        time (s)
Figure 2.13: Air flow and the associated volume for a ventilation at rest with a progressive
increase of the resistance of the tree from 1.5 cmH2O.s.L´1 .s to 15 cmH2O.s.L´1 .s from time
t “ 20 s, mimicking an asthma crisis. The data are plotted from the time where the solution
has adopted a stable equilibrium (t ě 10 s). We observe a progressive decrease of the airflow
and volume of air at mouth due to the progressive increase of the resistance of the tree. The
amplitude of the function mimicking the respiratory muscles is set constant. Hence, the increase
of the damping of the tree prevents the deformation of the lungs.
                                                                  Non-physiological lungs




                                                            920                              Healthy lungs             Asthma lungs
                       Respiratory muscles amplitude (Pa)




                                                            770



                                                            620



                                                            470



                                                            320



                                                            170
                                                                                                 1              3       5   7    9 11 1315
                                                                                             Equivalent resistance (cmH20.S/L)

Figure 2.14: Evolution of the amplitude effort of the respiratory muscles according to the increase
of the resistance of the lungs in order to ventilate a tidal volume of 500 mL. The axis of the
equivalent resistance is displayed in log-scale. This situation simulates the compensatory effort
that the respiratory muscles has to produce during an asthma crisis to keep a proper ventilation.


          Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  44                                                                            lungs


2.5.3.2     Chronic Obstructive Pulmonary Disease
We have seen in the first chapter that the constriction of the first generations of bronchi and
bronchioles is one of the main symptom of the COPD. This disease can also lead to the de-
terioration of the alveoli. Consequently, it induces a decrease of the stiffness of the lungs and
the exchange of gas at the acinar level is weaken. The combination of all those factors leads
to the phenomenon called pulmonary hyperinflation. The lungs hyperinflation refers to the rise
in functional residual capacity (FRC - lung volume at the end of tidal expiration) : the lungs
volume is above the volume usually used at rest. It is due to two main factors : the increase of
the resistance of the airways and the decrease of the elastic recoil (due to the loss of stiffness).
Consequently, as mentioned in the previous paragraph, the time needed to empty the lungs at
tidal volume increases and the expiration is not completely ensured. Moreover the degradation
of the aveoli increases ventilatory demands which reduces the expiration time and the volume
of exhaled air, that induces hyperinflation. Moreover, as the respiratory needs are higher, the
muscular work of breathing increases. This phenomena is somewhat compensated by the rise
of the lungs volume that enlarges the airways and consequently, decreases the resistance to air
flow [121].
    We use our model to illustrate and to explore the lungs hyperinflation phenomenon. We
use most of the data set in the default configuration of healthy lungs, but change the following
ones : the resistance of the tree is manually increased to reach physiological lungs resistance in
case of COPD, namely 10 cmH2O.L´1 .s [77]. To the best of our knowledge, we do not find any
satisfactory values in the literature on the elastic properties of a COPD lungs, then we decide
arbitrarily to reduce the Young’s modulus by a factor 2, namely E “ 628 Pa. Finally, for a
more realistic visualisation of the elastic recoil, we use the more realistic ventilatory function to
mimic the action of the respiratory muscles. We use three different time periods according to
the need : three, five and six seconds. Typically, the functions used are respectively :

                    πt
                                0 ď t ă 0.6                          πt
                                                                                 0 ď t ă 1.1
          $                                                $
          ’ ´A.sinp 1.2 q                                  ’ ´A.sinp 2.2 q
                                0.6 ď t ă 0.8                                    1.1 ď t ă 1.3
          ’
          & ´A                                             ’
                                                           & ´A
 τ1 ptq “                                         τ2 ptq “
          ’ ´A.sinp πpt´0.6q
                       0.4 q    0.8 ď t ă 1                ’ ´A.sinp πpt´1.1q
                                                                        0.4 q    1.3 ď t ă 1.5
            0                   1ďtă3                        0                   1.5 ď t ă 5
          ’
          %                                                ’
                                                           %

                                              πt
                                                          0 ď t ă 1.1
                                    $
                                    ’ ´A.sinp 2.2 q
                                                          1.1 ď t ă 1.3
                                    ’
                                    & ´A
                           τ3 ptq “
                                    ’ ´A.sinp πpt´1.1q
                                                 0.4 q    1.3 ď t ă 1.5
                                      0                   1.5 ď t ă 6
                                    ’
                                    %

    The Figure 2.15 illustrates the phenomenon of lungs hyperinflation by comparing the air
flows and the associated volumes between healthy and COPD lungs, while ventilating a same
tidal volume of 500 mL with a same respiratory cycle of five second. Our model predicts that
the COPD lungs need a respiratory muscles effort 3.5 times greater than the healthy lungs.
We observe that the COPD lungs do not deflate properly the inhaled air during expiration and
consequently the lungs progressively works with higher volume. We also see in our model that
the FRC increases of about 600 mL for the COPD case. It is not really surprising as the FRC
for healthy lungs is about 40% of the TLC (Total Lung Capacity “ 3-8 L) whereas it can reach
up to 80% of the TLC for COPD lungs [49]. For example for a TLC“ 6 L, the FRC increases
from 2.4 L to a maximum of 4.8 L for COPD lungs. Additionally, an other consequence of lungs
hyperinflation is the increase of the respiratory rate due to the deterioration of the alveoli and
less efficient gas exchanges. The Figure 2.16 shows that this increase accentuates the fact that
the lungs do not deflate properly and then work with higher volume. Despite the fact that a
higher respiratory rate involves higher air flows in average, a higher respiratory rate also involves
higher efforts from the respiratory muscles in average. Thus, the muscles need more and more
energy, hence the respiratory rate continues to grow and requires more effort from the muscles,
etc. The lungs hyperinflation often goes along with fatigue of the respiratory muscles.


Rest ventilation of healthy and non-healthy lungs                                                     45




                    airflow (L/min)
                                       40
                                       20
                                        0
                                      -20

                                            0         10            20            30             40
            volume (mL)




                            1000
                             800
                             600
                             400
                             200
                               0
                                            0         10            20            30             40
                                                                time (s)
                                                      Healthy lungs      COPD lungs

Figure 2.15: Comparison of the airflows and the associated volumes between healthy and COPD
lungs during ten respiratory cycles of five seconds. We can see that the increase of the resistance
and the reduction of the elastic recoil prevent the lungs to empty properly the air that flows in.
Consequently the COPD lungs have to work at higher volumes.
                    airflow (L/min)




                                       10
                                        0
                                      -10
                                      -20
                                      -30

                                            0         10            20            30
            volume (mL)




                            1000
                             800
                             600
                             400
                             200
                               0
                                            0         10            20            30
                                                                time (s)
                                                3s period ventilation    6s period ventilation

Figure 2.16: Comparison of the airflows and the associated volumes of COPD lungs during ten
respiratory cycles of three and five seconds. This figure underlines the fact that the increase
of the respiratory rate (reducing the time of the ventilating cycles) due to higher respiratory
demands (because of the loss of alveoli in case of emphysema) leads the lungs to work with
higher volume. This emphasizes the phenomenon of lungs hyperinflation.


          Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  46                                                                            lungs


2.5.3.3     Cystic fibrosis
One of the main symptom of the cystic fibrosis (CF) is a bad hydration of the mucus becoming
too stick and viscous. This alters its motion and its proper evacuation from the lungs. The
mucus is viscoelastic and its inner stress needs to be larger than its yield stress to be able to
move. We recall that the order of magnitude of the yield stress σ0 for an healthy mucus is
typically σ0 » 0.1 ´ 1 Pa [70, 83, 84]. For a non-healthy mucus, in case of CF, the order of
magnitude for the yield stress is about σcf » 1 ´ 10 Pa [70]. One of the main mechanism
to mobilize the mucus is cough. Cough induces strong air flows in the airways. Those air
flows apply a stress on the mucus, called shear stress, that mobilizes the mucus and favours its
expectoration. In healthy individuals, cough is sufficient to move the mucus toward the trachea
and the mouth. The mucus is then either swallowed or expelled. However, in CF individuals,
the mucus is overproduced and it is too stick to be shifted. Therapeutic methods are then
required, as chest physiotherapy. Here, we will compare the behaviors of the shear stress in the
airways between healthy and CF lungs during a maneuver of chest physiotherapy. We choose to
model an idealized maneuver of chest physiotherapy and let the next chapter (3) studying the
HFCWO. We consider a force that pushes and steers the lungs at low frequency to produce air
flow in the pulmonary tree.
    To the best of our knowledge, we did not find any satisfactory data about the resistance of
adult lungs with CF. However, in [44], the authors propose a mean lungs resistance measured
from thirty two patients with CF, aged fourteen on average. Hence our comparison focuses on
average healthy adult lungs and average CF young adult lungs.
    Then, we consider now the stress due to the air–mucus interaction [83, 84] in the airways,
during tidal ventilation. As the mucus layer is in general thin relatively to the diameter of the
airways, the stress in the mucus can be approximated by the wall shear stress induced by the
air flow in the airways [124, 125]. The amplitude of the applied force is set to the one used for
tidal ventilation. Hence, the order of magnitude of the induced air flows will be the same as
the ones observed for tidal breathing simulations. We assume that the airflows induced by the
ventilation at rest are quite small. Hence, we assume that the air fluid mechanics follows the
Poiseuille’s regime in the airways. The wall shear stress σa in an airway with radius r and an
airflow φ is then [124]
                                                 µa φ
                                            σa “
                                                 πr3
with µa the air viscosity, µa “ 1.8 10´5 Pa.s.
    The Neumann condition at x “ 0 mimicking the therapy is set to : σpuq.n “ τ “ Asinpωtq,
with A “ 100 and ω “ 1{5. The cystic fibrosis reduces the volume of air in the lungs due to to
the accumulation of mucus in the airways that reduces their lumen area. As a consequence, the
resistance and the stiffness of the lungs are increased [44, 132]. In our model, the CF is modeled
by setting the resistance of the tree to 17 cmH2O.L´1 .s and the lungs stiffness to E “ 2512 Pa.
The value of the resistance is taken from [44]. In our simulation, setting Req “ 17 cmH2O.L´1 .s
corresponds to reduce the lumen radius of the airways of a healthy bronchial tree by a factor
» 1.9. This indicates that almost half of the area of all the airways in the bronchial tree is filled
by mucus. In reality, the mucus is not necessarily distributed homogeneously in the bronchial
tree, some airways are more obstructed than others ; here we choose to keep the symmetrical and
fractal properties of our tree by homogenizing the distribution of the mucus along the bronchial
tree. Finally, in order to express the increase of the lungs stiffness, we multiply the Young’s
modulus for healthy tissue by a factor 2 (E “ 2512 Pa).
    Then, we calculate the mean shear stresses over one period of a force cycle of five seconds,
for each generation of the tree, that is displayed in the Figure 2.17. Globally, we observe a
constant pattern of the mean absolute wall shear stress through the tree with a trumpet-like
shape as we sink in the tree. Namely the standard deviation of the wall shear stresses of the
bronchi within a same generation grows as the generation index increases. The wall shear stress
applied by the air on the mucus is directly related to the size of the airways and to the amount
of airflow in the airway. We recall that the size of the branches from one generation to the


Rest ventilation of healthy and non-healthy lungs                                                      47

                                     ` ˘1
next is reduced by a factor h “ 12 3 . In these conditions, if the airflows were distributed
equally in all the branches of a single generation, the shear stress should decreases from one
generation to the next with a factor 2h1 3 “ 1, i.e. the shear stress should be constant through
the generations, see [124, 125]. In our case, the airflows are not distributed equally in the
airways of a same generation. However, most of the airways feel a wall shear stress of the same
magnitude, indicating that the distribution of the airflows in the airways of a same generation
remains relatively homogeneous. Moreover the Figure 2.17 reveals that the overall wall shear
stresses of the CF young adult lungs is of the same order of magnitude of the one of the healthy
adult lungs. It is not surprising with the definition of the shear stress. The air flow is inversely
proportional to the resistance, and the resistance is inversely proportional to the radius to the
power of four. However, the mucus in case of CF needs to feel a yield stress ten to hundred times
bigger than the healthy mucus. The ratio between the wall shear stress and the yield stress is
much smaller for CF mucus than for healthy mucus. Consequently, a respiratory therapy is less
efficient for CF individual than for healthy individual. It is then needed to understand the effect
of such therapies in order to improve their efficiency.


                                       0.0014
           shear stress in the mucus
            averaged over one cycle




                                       0.0012




                                        0.001




                                                                           CF lungs
                                                                           Healthy lungs
                                       0.0008

                                                    0    Distance of the   L
                                                        airways from


                                       0.0006
                                                0         1        2       3      4        5   6   7
                                                                       generation index

Figure 2.17: Comparison between the mean of the absolute shear stresses of healthy adult lungs
and of CF young adult lungs during a sinusoidal maneuver of chest physiotherapy. The mean
is computed over the duration of one maneuver cycle for all the bronchi of an eight generations
tree. The color reflects the location of the corresponding airway in [0, L], i.e. the mean position
of the Ai ’s fed by the airway. For example, the root of the tree is feeding all the Ai and its mean
position is L/2; the two branches of the second generation are located at L/4 and 3L/4, and so
on.


       Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  48                                                                         lungs


2.6     Discussions and conclusion
In this chapter, we propose, in the same spirit as in [137, 110], a mathematical model of the
biophysical mechanisms of the lungs in order to study the tidal breathing in healthy and non-
healthy lungs. In our model, we accounted for the interaction between two core physical processes
involved in the lung’s biomechanics: the viscous dissipation of air in the airways and the me-
chanics of the deformation of the lung’s tissues. The tree structure acts on the displacement of
the respiratory zone by applying a damping pressure that can even prevent the deformation, if
one or several branches are obstructed. Moreover, through the action of the air in the tree, a
deformation in the material propagates its influence very quickly –actually instantaneously in
our model– everywhere in the material once it has been stimulated.
    The unidimensional model suggests that the overall lung’s tissue displacements damped by
the tree behave similarly as harmonic oscillators whose theory is thoroughly studied in the liter-
ature. The general behavior of the coupled model could be described using its similarities with
harmonic oscillators that could bring interesting features regarding the resonance.The modelling
of the ventilation at rest strengthens the suitability of our model to simulate physiological lungs
behaviors. The study of the behaviors of pathological lungs such as in asthma, COPD or CF,
provides results in accordance with physiopathology and predicts lungs hyperinflation and its
improvement resulting from decreasing breathing frequency. It also shows the influence of each
parameter of the model on the response of the system. For example, it shows that the variations
of the lung’s stiffness plays a role on the elastic capacity of the lungs to return to a steady
state, or that the intensity of the lungs deformation is modulated by the resistance of the lungs.
However, the model shows the intrinsic influence of the parameters only. The results have to be
interpreted within the hypothesis and limitations of the model.
    The model is based on a set of simplification hypotheses for the geometry of the lungs, the
mechanics of the tissues and the air fluid dynamic. Actually, unlike the real lungs, we consider
a tissue that is elastic, isotropic and homogeneous, where the strains are small. We limit
the tissue evolution in a single spatial direction, since we use a unidimensional space domain.
Hence, we only capture the intrinsic influences of the parameters. The pulmonary tree structure
is idealized with symmetric bifurcations and cylindrical airways, it is not accounting for the
complex geometry of the bifurcations. Moreover, we assume that the air in this tree follows
the Poiseuille’s regime, i.e. with low velocities and fully developed axisymmetric profile. This
is not well adapted for the upper bronchial airways dynamics. Consequently, the resistance of
the tree does not reflect properly the overall resistance that the air encounters on its way from
the ambient air to the exchange surface. This is highlighted by the simulation of the human
ventilation at rest where a corrective factor for the resistance is needed to catch a realistic
behavior. Additionally, although the deformation propagates very quickly in the lungs, we do
not account for the the temporal evolution of the circulations of the air inside the tree : the
damping of the tree acts instantaneously on the lung’s tissue.
    Nevertheless, our model is able to successfully mimic the rest ventilation and to capture
the interactions between the tissue mechanics and the air flow in the airways. The results are
observed for biological and mechanical parameters of a typical average healthy and non-healthy
person. Hence, our model hypotheses are a way to get a first clear view of the intrinsic dynamics
of the system, and particularly during tidal breathing. Moreover, it suggests the significance of
studying the resonance in the lungs that could be an interesting tools for HFCWO. The next
chapter takes an interest on this phenomenon through HFCWO simulations and studies the
interconnected influences of the parameters with a dimensionless formulation of the system.


Discussions and conclusion                49




                             Appendices


       Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  50                                                                         lungs


2.A      Details of calculation for the resistance of the tree
Depending on the considered case and on its computational cost, the number of generations
n ` 1 in our model can be smaller than the estimated number of generations of the bronchial
tree, which is about 17 [136]. Hence, the rest of the generations of the bronchial tree and of
the alveolar tracts are mimicked using virtual quasi-fractal subtrees, see subsection 2.2.1.2. We
assume that the branches of a virtual subtree are all submitted to the same pressure. Conse-
quently, the hydrodynamic response of these subtrees is based on their equivalent hydrodynamic
resistance only. Then, in order to account for these subtrees (bronchial and acinar) in our model
of the pulmonary tree, the equivalent hydrodynamic resistance of the subtrees associated to a
terminal branch is added to the resistance of that terminal branch. We detail some calculation
for that purpose whose results are presented in the subsection 2.2.1.

    We set the number of generations of the bronchial tree to nt “ 17 [136] and the number of
generations of the alveolar tracts to na “ 6 [136]. However, for the calculation, we keep the vari-
able name nt and na if one would like to change their value. The reduction ratios in the bronchial
                                                                        ` ˘1
tree and in the respiratory zone (alveolar tracts) are respectively hb “ 12 3 and hac “ 1 [136, 40].

    Equivalent resistances. The resistances of the branches at a same generation are consid-
ered connected in parallel. Consequently, the equivalent resistance of the generation i of the
         i “ p2i´1 R´1 q´1 . Then the equivalent resistances of each generation of the tree are
tree is Req          i´1
connected in serial. Hence, the theoretical equivalent resistance of the n ` 1 generations tree is

                                                       1 i
                                                 ÿn ˆ      ˙
                                      Rth   “ R0
                                                 i“0
                                                      2h3b

   In the same way, the equivalent resistance of a single bronchial subtree of nt ´ pn ` 1q
generations is

                                                           1
                                                 17´n´2
                                                   ÿ ˆ           ˙i
                                            Rn
                                   Rst,n   “ 3
                                            hb    i“0
                                                          2h3b
    Similarly, , the equivalent resistance of a single acinar subtree that contains the generations
nt ` 1 to na is

                                                      1
                                              na ´1 ˆ   ˙i
                                         Rnt´1 ÿ
                                    Ra “
                                          hac i“0 2h3ac
   Equivalent resistance of the whole tree. The total resistance of the whole tree is the
sum of the equivalent resistances of the n`1 tree, the 2n`1 bronchial subtrees and the 2nt acinar
subtrees :

                                                  Rst,n   Ra
                                    Rlung “ Rth `       ` nt
                                                  2 n`1   2
    Including the contribution of the virtul bronchial and acinar region in the n ` 1
generations tree. We then need to include the contribution of the virtual subtrees in the
resistance matrix of the n ` 1 generations tree. For that, we supplement each resistance Rn of
the 2n terminale branches by adding the equivalent resistances of their two bronchial subtrees
and their 2nt ´n acinar subtrees. We denote by R̃n the adjusted resistance of the airways at the
generation n ` 1 :

                                            Rst,n     Ra
                                    R̃n “ Rn `    ` nt ´n
                                              2     2
    When computing the equivalent resistance of the adjusted resistance matrix R, we obtain
as expected


Finite element method                                                                                      51


                                                      1
                                           Req “   t JR´1 J
                                                              “ Rlung


2.B       Finite element method
The finite element method (FEM) is used to solve the system of equations (2.11). This appendix
details the calculus of our use of this numerical method in three dimensions.
    We split the domain into ne identical elements defined with an arbitrarily order basis func-
tions. Let’s denote by nd the number of degrees of freedom in our discretized domain and by ni
the ith degree of freedom, for 0 ď i ď nd .

    Let’s denote u : Ω Ñ R3 , w : Ω Ñ R3 , x P R3 and t P R, respectively the displacement
field, the test function, the spatial variable and the temporal variable. Using the FEM, the
                                                      nd
displacement field u is approximated by upx, tq “        uk ptqφk pxq as well as the test function
                                                      ř
                                                              k“0
               nd
                    wl ptqφl pxq. The element uk ptq stands for the values of the displacement, at time t
               ř
wpx, tq “
            l“0
and at the degree of freedom nk .

    For any smooth function w : Ω Ñ R3 verifying the boundary conditions, the weak formulation
of our model is

                                                                N
               B2u
     ż ˆ                                   ˙      ż                          ż
                                     :                                            div pwq dx “ 0          (2.30)
                                                               ÿ
           ρ       w ` σ elastic puq   pwq  dx ´     τ w dS `    p i pFrusq
                                                                          9
      Ω        Bt2                                 Γ1          i“1             Ai


    with σelastic puq “ λ tr ppuqq I ` 2µ puq and puq “            ∇u ` t ∇u .
                                                                 1
                                                                     `         ˘
                                                                 2

   Equation (2.30), which should hold for any w in this finite dimensional space, is written for
any element φl of the basis
   ż « ÿ   nd ÿ nd 2                              nd ÿnd
                                                                                                   ff
                   B uk ptq
                                                          uk ptqwl ptqσelastic pφk pxqq : pφl pxqq dx`
                                                 ÿ
        ρ                   wl ptqφk pxqφl pxq `
    Ω     k“0 l“0
                      Bt2                        k“0 l“0
  ż          nd                    N ÿ N      ż ˜ÿ  nd
                                                                              ¸ ż n
                                                                                           d
                                                         Buk ptq
                                                                 divpφk pxqq dx              wl ptqdivpφl pxqqdx “ 0
            ÿ                     ÿ                                                      ÿ
´     τ ptq     wl ptqφl pxqdS`           Rij
   Γ1       l“0                   i“1 j“1      Aj k“0      Bt                         Ai l“0
                                                                                                                (2.31)

     From the previous equation we can compute respectively M , K, h, and Gik , the mass,
stiffness and damping matrices as well as dimensionless vector of loads as
                           $
                           ’               ş
                           ’
                           ’
                           ’       Mkl “ Ω ρφk pxqφl pxqdx
                           ’
                           ’
                           ’
                           & Kkl “ σelastic pφk pxqq : pφl pxqqdx
                           ’
                           ’         ş
                                                                                    (2.32)
                                      Ω
                           ’                 ş
                           ’
                           ’
                           ’            hl “ Γ1 φl pxqdS
                           ’
                           ’
                           ’
                                       Gik “ Ai divpφk qdx
                           ’
                           ’                 ş
                           %

    Note that the formulation above express the matrices and vector without taking the ho-
mogeneous boundary condition into account. For example, we can enforce Dirichlet boundary
condition by setting uni “ 0 for chosen degrees of freedom i. Then matrices and vector need
to be adapted according to. Hence, the last column and/or line associated to the degree of
freedom blocked are eliminated in this case. We would rather use M̂ , K̂, Ĝ and ĥ to denote


        Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  52                                                                          lungs


respectively the mass, stiffness and damping matrices and vector of loads where boundary con-
dition are applied. Moreover, for a lumped mass matrix, we notice that the system mass and
rigidity matrices are those of vibrating masses linked with springs. The lumped matrix is an
approximation of the mass matrix by using a trapezoidal quadrature rule. The point of view of
a system of spring-mass may be used as a starting point for an homogenization process, see [39].

   With U “ puk q0ďkďnd the vector of displacement and D “t GRG, the equation (2.31) is
expressed as a linear matrix-vector system :

                                d2 U           dU
                                   2
                                    M ` K U `D    “ τ ptq h                                                                   (2.33)
                                dt             dt
   or applying the Dirichlet condition :

                                         d2 U             dU
                                    M̂        ` K̂ U ` D̂    “ τ ptq ĥ                                                       (2.34)
                                         dt2              dt
   with D̂ “t ĜRĜ.

2.B.1    An example of FEM calculation in 1D : the Mass matrix
As an example, here is detailed the calculation of the Mass matrix from (2.32) with one dimen-
sion. In one dimension we focus in only one spatial direction, thus x P R and the domain is
Ω “ r0, Ls, L P R. We split the domain Ω into nx (identical size) segments with 2 nodes. Hence,
we note pxi q0ďiďnx , xi “ i ˆ δx , δx “ n1x .
    The coefficients of M are
                                                           żL
                                               Mij “            ρφi pxqφj pxqdx
                                                           0

   with φ a polynomial of order 1 defined as
                                                  $    x´xi´1
                                                  &      δx          if x P rxi´1 , xi s
                                    φi pxq “           xi`1 ´x
                                                         δx          if x P rxi , xi`1 s                                      (2.35)
                                                       0
                                                  %
                                                                     otherwise
    Knowing the definition of φ, we notice that the product φi ˆ φj @i, j P N, is different from
zero when i “ j and when i “ j ˘ 1. Then, we focus the calculation on the interval rxi´1 , xi`1 s
when i “ j and i “ j ˘ 1. We also focus on the specific case where i “ j “ 0 and i “ j “ nx .
    ‚ When i “ j, the coefficients Mii for all i are computed with
                 ż xi`1                        ż xi ˆ                    ˙2          ż xi`1 ˆ              ˙2
                                                           x ´ xi´1                             xi`1 ´ x
                          φi pxqφi pxqdx “                                    dx `                              dx
                  xi´1                          xi´1          δx                      xi           δx
Setting u “ x ´ xi´1 and v “ xi`1 ´ x, the coeffcients Mii are equaled to

                                                                                    2δx
                                    ż δx ´                      ż δx ´
                                               u ¯2                       v ¯2
                                                    du `                       dv “
                                     0         δx                0       δx          3
   ‚ When i “ j ˘ 1, the coefficients Mipi`1q for all i and are calculated with

        ż xi`1                           ż xi`1                                ż xi`1 ˆ               ˙ˆ             ˙
                                                                                           xi`1 ´ x        x ´ xi
                 φi pxqφi`1 pxqdx “               φi pxqφi`1 pxqdx “                                                     dx
         xi´1                             xi                                    xi            δx             δx

   Setting u “ x ´ xi , previous calculation becomes
                           żδ ˆ                   żδ ˆ
                                                          u2
                                      ˙                      ˙
                                δx ´ u ´ u ¯           u          δx
                              x              dx “    x   ´ 2 du “
                            0     δx    δx         0   δx δx       6


Angular eigen-frequencies                                                                      53


   The term Mipi`1q is equaled to Mpi´1qi .

   ‚ Moreover
                                                   δx
                                         M00 “ Mnx nx “
                                                    3
   Therefore the Mass matrix M for the one dimensional case is



                                                                           0
                                         ¨ δx   δx                              ˛
                                           3     6
                                                         ..
                                                              .
                                     ˚                                        ‹
                                     ˚ δx       2δx                           ‹
                                     ˚6          3
                                                ..       ..       ..
                                                                              ‹
                                                     .        .        .
                                     ˚                                        ‹
                                M “ ρ˚                                        ‹
                                                         ..
                                     ˚                                        ‹
                                                              .

                                                0
                                     ˚                            2δx
                                                                              ‹
                                                                           δx ‹
                                     ˚
                                     ˝                             3        6 ‚
                                                                  δx       δx
                                                                   6        3


2.C     Angular eigen-frequencies
In this subsection, we describe a specific property of the equation (2.11) written with the finite
element method described on the previous subsection for the unidimensional case. Here, we con-
sider the system without taking into account the tree structure, namely pi “ 0 for all i. It allows
us to study, for materials of fixed size with homogeneous elastic properties, the propagation of
deformation wave and the natural frequencies of the material.
    The unidimensional domain is Ω “ r0, Ls, L P R. We use the unidimensional linear matrix-
vector relation (2.18) presented in the subsection 2.3.2. Without considering the coupling with
the tree, the matrix of damping D is not taking into account. Hence the relation is

                                     d2 U
                                    M      ` K U “ τ ptq h                         (2.36)
                                     dt2
   The matrices M , K stand for the matrices of Mass and Stiffness. The vector of load is
denoted by h.
   We decompose the matrix M as M “ Lt L using Cholesky factorization. Setting S “ t LU ,
K “ L´1 K t L´1 and Gptq “ τ ptqL´1 h, the equation becomes

                                        d2 S
                                               ` K S “ Gptq
                                         dt2
    K is symmetrical and invertible so it can be diagonalised using its eigenvectors qi associated
to its eigenvalues k i . With Q “ pqi q1ďiďnx , U “ Q´1 S and Hptq “ Q´1 Gptq, we finally have :
                                         d2 U
                                              ` DU “ Hptq                                     (2.37)
                                         dt2
where the vector unknowns is U. As presented in 2.B, the equation (2.37) is adapted in the
case of Dirichlet boundary condition and the same calculation process used is applied to M̂
and K̂. The diagonal matrix D contains the square of the natural angular frequencies (called
pωi q1ďiďnx ). For example, to obtain the two first angular eigen-frequencies ω1 (fundamental)
and ω2 used in our numerical simulations, we compute the square root of D and take the two
smallest values ; the smallest between the two is the fundamental natural angular frequency ω1 .
The relation between the frequency and the angular frequency is f “ 2πω. We note that there
are as much natural angular frequencies as there are degrees of freedom and that the accuracy of
their values is improved when the number of degrees of freedom increases. Actually, the natural
angular frequencies ωn are such that

                      |K ´ ωn2 M | “ 0    or    |K̂ ´ ωn2 M̂ | “ 0              (Dirichlet)   (2.38)
    It is interesting to get natural frequencies of our system to get an idea about the resonance and
to link the frequencies used with HFCWO devices with the theoretical eigen angular frequencies.


       Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  54                                                                         lungs


   Analytical definition of the natural angular frequencies
The natural frequencies are computed with the discrete system without tree. However, they can
be computed directly from the continuous system in a classical way [114, 41, 69]. The natural
angular frequencies are linked to the boundary conditions. For example, considering the case of
axial vibrations of elastic bars with one end fixed and the other end free similar to our case, the
natural angular frequencies are defined as :

                                                p2k ´ 1qcπ
                                         ωk “                ;       1 ď k ď `8             (2.39)
                                                    2L
               b
    with c “     pλ`2µq
                    ρ   the velocity of the wave deformation. For our numerical cases we do
not change the boundary conditions : a Neumann condition on the boundary x “ 0 (τ ) and a
Dirichlet condition on x “ L (u “ 0). Consequently, we do not need to compute the natural
frequencies from others boundary conditions.

    Through simulations, we display the four first natural modes in Figure 2.18. We set the
values of the parameters of the model to those used in the non-physiological configuration in
subsection 2.4.1. We use Rnorm “ RReq with R the resistance matrix computed from l0 “ 6cm and
r0 “ 1cm, and c and all other variables are equal to one. The natural pulsations computed with
the experimental definition (2.38) are similar to those computed with the theoretical definition
(2.39).

                                                         time : 1s
                               0.6

                               0.5
            displacement (m)




                               0.4

                               0.3

                               0.2

                               0.1

                                0
                                     0    0.2          0.4       0.6        0.8   1
                                                        space (m)
Figure 2.18: Material displacements along the domain at time t “ 1c “ 1 (i.e. the time the wave
takes to propagate from one boundary to the other with a velocity of c “ 1). The material is
fixed at one boundary (upL, tq “ 0) and stimulated at the other (x “ 0) by a sinusoidal force
whose pulsation varies between the four first eigen pulsation (ω1 to ω4 ).



2.D     A case of damped harmonic oscillator with one degree of
        freedom
This appendix details the theory behind the damped and forced harmonic oscillator with one
degree of freedom on which we base some of the results.


A case of damped harmonic oscillator with one degree of freedom                                55


    With one degree of freedom (DoF), an oscillatory system describes for example the oscilla-
tions of a mass tied to a spring, of a pendulum or of an electronic circuit. Taking the case of a
pendulum system, the motion of the mass can be damped by a damping influence or/and can be
stimulated by an exciting force. In the absence of damping or exciting influences, the oscillation
is considered as free and the motion of the mass is only due to its initial conditions on position
or velocity. The contents of this appendix are classic and can be found in the litterature [120, 43].

   The general equation describing the motion of a forced damped harmonic oscillator desig-
nated by xptq with one DoF is :

                                 d2 xptq    dxptq
                                 m   2
                                         `b       ` kxptq “ f ptq                        (2.40)
                                  dt         dt
    with m the mass, c the damping coefficient, k the stiffness coefficient and f ptq a driving
force. The equation (2.40) can be written

                             d2 xptq      dxptq
                                  2
                                     ` 2ξ        `ω 2
                                                    0 xptq “            lohptq                (2.41)
                               dt
                             loomoon        dt
                                       looomooon  loomoon                 omoon
                                                          stiffness   driving force
                            acceleration    damping
                                                      b
   with ξ “   2m the damping coefficient, ω0 “
                b
                                                   m the natural angular frequency of the oscilla-
                                                   k

tor and h “   m f . We concentrate on periodic driving force. The solution of the equation (2.41),
              1

that can be explicitly computed, relies on the value of the damping coefficient, of the amplitude
and of the pulsation of the driving force.

    Free oscillations
In the case of free oscillation (b “ 0 and f ptq “ 0 @t), the solution of the equation (2.41) is a
combination of sines and cosines depending on the initial conditions on position and velocity :

                                                              vp0q
                                xptq “ xp0qcospω0 tq `             sinpω0 tq
                                                               ω0
   Then the mass oscillates at the natural pulsation. The potential and kinetic energies pro-
duced during the movement follow this oscillating pattern with a 180˝ difference of phase.
The kinetic energy is defined by Ek “ 21 mv 2 ptq with vptq “ dxptqdt  and the potential energy
by Ep “ 12 kx2 ptq. At the equilibrium position, the velocity of the mass is maximal, then the
kinetic energy is maximal. Then, the more the mass deviates from its equilibrium position,
the more the potential energy, and the less the kinetic energy. Finally, the mass returns to the
equilibrium position once the kinetic energy is equal to zero, see Figure 2.19.

    Damped and forced oscillations
When the motion of the mass is damped, for example if it is plunged into a viscous fluid, and
forced by an external action, the solution of the equation 2.41 is a combination of a homogeneous
and a particular solutions :

                                           xptq “ xh ptq ` xp ptq
    The homogeneous solution tends to zero as time goes to infinity, leading the general solution
to tend to the particular solution. Consequently, the general solution follows two regimes : a
transient and a steady-state regime.

    The homogeneous solution xh . The homogeneous solution xh follows one of the three
types of behavior, defined in table 2.2, according to the value of the reduced discriminant
∆1 “ ξ 2 ´ ω02 .
   For each of the three types of behavior, the decreasing exponential term (e´ξt ) leads the
homogeneous solution to be damped and to tend to zero as time goes to infinity (xh ptq ÝÑ 0).
                                                                                           tÑ`8


       Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  56                                                                         lungs




                              2
                                                                                        E
                                                                                        p
                             1.5
                    energy




                              1


                             0.5
                                                                                        E
                              0
                                                                                        k
                                   0         2      4       6          8      10   12       14

                                                                time

Figure 2.19: Schematic of the free oscillations of a pendulum released from the initial position
(xp0q) over half a period ( T20 ) without any damping or driving force. It displays the evolution of
the kinetic and potential energies where Ek,max and Ep,max are the maximal values of respectively
the kinetic and the potential energies. Particularly we observe that the average of the kinetic
and potential energies over one period is equal.

                                                    ´    ?           ?    ¯
             ∆1 ą 0                                                                 over damping
                                                           1           1
                                       xh ptq “ e´ξt Aa e ∆ t ` Ba e´ ∆ t

             ∆1 “ 0                              e´ξt pAc t ` Bc q                 critical damping

             ∆1 ă 0                      pAp cospωd tq ` Bp sinpωd tqq e´ξt        under damping


Table 2.2: The tree types of behavior of the homogeneous solution depending on the intensity of
the damping. The couples (Aa  a , Ba ), (Ac , Bc ) and (Ap , Bp ) are constant values computed from
initial conditions and ωd “ ω02 ´ ξ 2 the damped pulsation. In case of small damping and
without external force, we notice that the motion of the mass oscillates at pulsation slightly
lower than the fundamental natural pulsation.


Hence, the transient regime is determined by the homogeneous solution.

    The particular solution xp . The steady-state regime occurs for large times t when the
homogeneous solution is close to zero. Hence, the solution xptq is only depending on the partic-
ular solution (xptq ÝÑ xp ptq). The particular solution is of the form of the external force. For
                   tÑ`8
a periodic driving force of the type hptq “ Hcospωtq, the particular solution is

                                                  xp ptq “ Xcospωt ` φx q
   where X and φx are constants determined according to the characteristics of the system and


Configurations of parameters for the numerical simulations                                    57


of the stimulation. The constant X is the magnitude of the oscillations in the steady state and
φx is the phase difference of those oscillations according to the stimulation. The two constants
can be determined through two ways : an algebraic and a complex method. We will not detail
the methods here and give directly the expression of X and φx :

                            H                                               ´2ξω
                  X“a 2                             and       tanpφx q “
                     pω0 ´ ω q2 ` p2ξωq2
                            2                                              ω02 ´ ω 2


   We can also study the magnitude of the oscillations with the Q-factor or quality factor which
characterizes the intensity of the damping :
                                                   ω0
                                             Q“
                                                   2ξ
   Hence, the higher is Q, the lower is the damping.

   Resonance for the displacement. The study of denominator of X expression shows that
there exists a maximum for X if ξ ă ?
                                    ω0
                                      2
                                        . This maximum is reached at the angular frequency
                                            b
                                      ωr “ ω02 ´ 2ξ 2
    The angular pulsation ωr is the resonance pulsation of the oscillator at steady-state for
damping satisfying Q ą ?12 (ξ ă ?  ω0
                                    2
                                      ). Particularly, if the driving force stimulates the mass at
this particular angular frequency, the resulting displacement is maximal and tends to increase
through time. It appears that for the pulsation ω0 , the smaller the damping is, the closer the
resonance angular frequency is to the fundamental angular frequency (ωr « ω0 ).
    For sufficiently high damping such as Q ď ?12 (ξ ě ?  ω0
                                                           2
                                                             ), the amplitude of the steady solution
reaches its maximum for ω “ 0, see the Figure 2.20.

   Resonance for the velocity. The phenomena of resonance appears also for the velocity
 dt .We can deduce the amplitude of the velocity :
dxptq


                                                   ωH
                                   V “a
                                           pω02 ´ ω 2 q2 ` p2ξωq2
    which reaches its maximum for angular frequency equal to the fundamental angular fre-
quency. It also indicates that the phenomena of resonance for the velocity occurs for any values
of damping, see the Figure 2.20.


2.E     Configurations of parameters for the numerical simulations
For a clear distinction, this appendix gathers all the values of the configurations of param-
eters used in the numerical simulations of this manuscript. One of the configuration is of
non-physiological lungs where all the variables are standardized. The others configurations of
parameters model averaged healthy and non-healthy lungs. Specifically, the non-heatlhy lungs
mimic asthma, chronic obstructive pulmonary disease (COPD) and cystic fibrosis (CF) diseases.
Most of the variables are taken from [111] for physiological lungs, if not the reference is stated.


           Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  58                                                                             lungs

             Amplitude of the displacement                            Amplitude of the velocity
   5                                                      4
                                                                                        Q=4

   4                               Q=4
                                                          3

   3
                                                                                     Q=2
 X/H




                                                        V/H
                                                          2
                             Q=2
   2
                                                                              Q=1
                             Q=1                          1
   1
                         Q=1/√2                                             Q=1/√2
           Q=1/4
   0                                                      0       Q=1/4
       0           0.5             1     1.5      2           0       0.5           1                 1.5   2


Figure 2.20: Left: Evolution of the magnitude of the oscillations (X{H) according to the
pulsation (ω{ω0 ). If the damping is small (Q ą ?12 ), the maximum of the amplitude of the
oscillation is reached for a pulsation close to the resonance pulsation (ω « ωr “ ω02 ´ 2ξ 2 ),
                                                                                     a

and for a pulsation close to zero otherwise ω « 0. The smaller the damping is (i.e. the bigger the
Q-factor is Q ąą 1), the closer the resonance pulsation is to the natural pulsation (ωr « ω0 ).
Right: Evolution of the magnitude of the velocity (V {H) according to the pulsation (ω{ω0 ).
The maximum of the amplitude is always reached for a pulsation equal to the natural pulsation
(ω “ ω0 ) independently of the intensity of the damping. However, for high damping (Q ă ?12 ),
the amplitude of the velocity is small and in a plateau, i.e. it does not vary too much as the
pulsation ω varies.

                     Model input parameters modeling the applied pressure

                                           Non-physiological force

               Physical quantity                        Parameter name                  Value

               Frequency of the applied pressure                  f                         1 Hz
               Amplitude of the applied pressure                  A                         1 Pa

                              Respiratory muscles effort for the ventilation
                            at rest in healthy lungs (tidal volume of 500 mL)

               Frequency of the applied pressure                  f                     1
                                                                                        5   Hz   ˚1

               Amplitude of the applied pressure                  A                  200 Pa        ˚2



                                  Pressure applied by the HFCWO therapy

               Frequency of the applied pressure                  f              1 to 20 Hz
               Amplitude of the applied pressure                  A                     200 Pa

Table 2.3: Input parameters of the model for the applied pressure. ˚1 We make the frequency
varying in the case of COPD lungs to 31 Hz and 16 Hz, see subsection 2.5.3.2. ˚2 The amplitude
varies in the cases of non-healthy lungs in order to ventilate a tidal volume of 500mL ; it is
detailed in the subsection 2.5.3. The amplitude is computed in order to get physiological value
of tidal breathing.


Configurations of parameters for the numerical simulations                                       59




                               Lungs model input parameters

                                    Non-physiological lungs

 Physical quantity                                   Parameter name                 Value

 Lung volumetric density                                        ρ                 1 kg.m´3
 Characteristic lungs size                                      L                    1m
 Lamé parameters                                           λ ` 2µ                    1 Pa
 Tree root radius (trachea radius)                            r0                    0.01 m
 Tree root length (reduced trachea length)                      l0                  0.06 m
 Number of generations in the tree                              n                   2 to 5
 Hydrodynamic resistance of the airway tree             Req “        1
                                                                 t JR´1 J   8.10´3 cmH2 O.s.L´1
 Resistance matrix of the airway tree                    Rnp “        R
                                                                     Req             see     ˚



                                          Healthy lungs

 Lung volumetric density                                        ρ                100 kg.m´3
 Characteristic lungs size                                      L                   0.2 m
 Poisson’s ratio                                                ν                     0.4
 Young’s modulus                                              E                    1256 Pa
 Lamé parameters                                           λ ` 2µ                  2691 Pa
 Tree root radius (trachea radius)                            r0                    0.01 m
 Tree root length (reduced trachea length)                      l0                  0.06 m
 Number of generations in the tree                              n                        8
 Corrective factor for the resistance of the tree             rh                      30
 Resistance matrix of the airway tree                     Rh “ rh R                see   ˚ ˚1

 Hydrodynamic resistance of the airway tree             Req “        1
                                                                 t JR´1 J
                                                                            1.5 cmH2 O.s.L´1 [87]
                                                                     h



Table 2.4: Input parameters of the model for the non-physiological and healthy lungs. ˚ The
resistance matrix R is defined from r0 and l0 , see the subsection 2.2.1 and [25] for the definition.
˚1 The corrective factor r is applied on each airway of the tree, even the ones of the bronchial
                          h
and acinar subtrees that are added to the terminal branches of the tree, as detailed in the
appendix 2.A.


       Modelling the lungs to simulate tidal breathing for healthy and non-healthy
  60                                                                         lungs


                              Lungs model input parameters

                                      Shared parameters

 Physical quantity                                  Parameter name                Value

 Lung volumetric density                                       ρ                100 kg.m´3
 Characteristic lungs size                                     L                  0.2 m
 Poisson’s ratio                                               ν                    0.4
 Tree root radius (trachea radius)                           r0                   0.01 m
 Tree root length (reduced trachea length)                     l0                 0.06 m
 Number of generations in the tree                             n                    8


                                         Asthma lungs

 Young’s modulus                                             E                   1256 Pa
 Lamé parameters                                          λ ` 2µ                 2691 Pa
 Corrective factor for the resistance of the tree          rnh                      11

 Resistance matrix of the airway tree                  Ra “ rnh Rh                 see   ˚

 Hydrodynamic resistance of the airway tree            Req “        1
                                                                t JR´1 J
                                                                           15 cmH2 O.s.L´1 [116]
                                                                    a



                                         COPD lungs

 Young’s modulus                                             E                    628 Pa
 Lamé parameters                                          λ ` 2µ                 1346 Pa
 Corrective factor for the resistance of the tree          rnh                      7
 Resistance matrix of the airway tree                Rcopd “ rnh Rh                see   ˚

 Hydrodynamic resistance of the airway tree          Req “          1
                                                               t JR´1 J
                                                                           10 cmH2 O.s.L´1 [77]
                                                                   copd



                                            CF lungs

 Young’s modulus                                             E                   2512 Pa
 Lamé parameters                                          λ ` 2µ                 5383 Pa
 Corrective factor for the resistance of the tree          rnh                      12
 Resistance matrix of the airway tree                  Rcf “ rnh Rh                see   ˚

 Hydrodynamic resistance of the airway tree            Req “        1
                                                                t JR´1 J
                                                                           17 cmH2 O.s.L´1 [44]
                                                                    cf



Table 2.5: Input parameters of the model for the non-healthy lungs. ˚ The resistance matrix
Rh , mimicking the resistance matrix associated to a healthy lungs, is defined in the previous
page. The corrective factor rnh in case of non-healthy lungs is applied only on the airways of
the bronchial tree and not for the ones of the acinar region when adding the contribution of the
generations that the tree structure does not take into account to the terminal branches of this
same tree, as detailed in the appendix 2.A. Consequently the equivalent resistances of the acinar
region for the healthy and non-healthy lungs are equal ; only differ the equivalent resistance of
the bronchial tree (hence the equivalent resistance of the whole tree).


Chapter     3
Mechanics of the lungs and
optimization of HFCWO

                            "Ubi stimulus, ibi fluxus humorum."
                                               -
                      "Where the stimulation is, there is a flow of fluid."
                                                    Well known medical axiom of 19th century [107].

     From Résumé historique des principales découvertes sur la structure et les fonctions des
                                             poumons, Léonard-Fulcrand Gasté, 1832, p.15.


Contents
      3.1    Introduction       . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .       63
            3.1.1   Recall of the equations of the coupled model . . . . . . . . . . . . . . .          63
      3.2    Physical analysis of the parameters of the model with a dimension-
             less formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .             64
            3.2.1   Determination of the dimensionless parameters . . . . . . . . . . . . . .           65
            3.2.2   The coupled model reduced to one degree of freedom . . . . . . . . . . .            67
            3.2.3   Predicted behaviors of healthy and non-heatlhy lungs with the dimen-
                    sionless parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     71
            3.2.4   Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .      73
      3.3    Modelling the High Frequency Chest Wall Oscillation in healthy
             and non-healthy lungs . . . . . . . . . . . . . . . . . . . . . . . . . . . .              73
            3.3.1   Modeling the stress in the mucus . . . . . . . . . . . . . . . . . . . . . .        73
            3.3.2   Effects of the HFCWO on the healthy lungs model . . . . . . . . . . . .             75
            3.3.3   Airflows at mouth induced by HFCWO for the range of healthy lungs
                    resistances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   77
            3.3.4   Idealized HFCWO for non-healthy lungs models . . . . . . . . . . . . .              78
            3.3.5   Estimation of the operational hydrodynamic resistance of the airway
                    tree from HFCWO mouth airflow . . . . . . . . . . . . . . . . . . . . . .           79
            3.3.6   Estimation of the compliance using the fundamental frequency . . . . .              80
      3.4    Discussions and conclusion . . . . . . . . . . . . . . . . . . . . . . . . .               80
      3.A Behaviors of the solution according to the dimensionless parameters 83
      3.B Extension of the definition of the dimensionless parameter E . . . .                          84
            3.B.1 Numerical simulation        . . . . . . . . . . . . . . . . . . . . . . . . . . . .   84
            3.B.2 Alternative definition of the dimensionless parameter E           . . . . . . . . .   86
      3.C A one degree of freedom equation. . . . . . . . . . . . . . . . . . . . .                     86


62                               Mechanics of the lungs and optimization of HFCWO


     3.D Estimation of the stress in the mucus layer induced by the airway
         walls oscillations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .      87
         3.D.1 Estimation of the evolution of the airways radii . . . . . . . . . . . . . .    88
         3.D.2 Estimation of the stress in the mucus layer . . . . . . . . . . . . . . . .     89
     3.E Operational resistance        . . . . . . . . . . . . . . . . . . . . . . . . . . .   90


Introduction                                                                                 63


3.1     Introduction
In the previous chapter, we propose a mathematical and numerical model of the biomechanics
of the lungs to analyze the isolated phenomenon acting during tidal breathing in healthy and
non-healthy human lungs. It proposes the interest of studying the resonance of the lungs which
can be an interesting feature for the HFCWO. The previous chapter also allows to calibrate the
set of parameters of the model to get model predictions compatible with the physiology of the
lungs. In this chapter, we use the unidimensional model to study the effect of the HFCWO
therapy on the lungs isolated from the ventilation.
    We have seen in the frame of forced and damped harmonic oscillator, that the natural
pulsation of the oscillator could maximize the displacement and velocity amplitudes of the
oscillator and that those amplitudes are dependent of the intensity of the damping. Moreover,
we have observed some similar behaviors between our coupled model and the harmonic oscillator
such as the balance of energies of the system. Hence, we take an interest on studying the
resonance in our model.
    Analyzing the velocity of the deformation in our model amounts to study the air flows in
the tree induced by the material deformation. Hence, this study aims at determining optimal
operating parameters for HFCWO, in the sense of maximizing the resulting amount of air flow in
the bronchi, and potentially maximizing the stress applied on the mucus in the airways. For that
purpose, we propose a dimensionless formulation of the model in order to understand the intrinsic
and interconnected influences of the parameters of the model. The dimensionless formulation is
used to explain the induced phenomena that occur during HFCWO maneuvers such as resonance.
This formulation raises two dimensionless parameters. We also determine from an idealized
perspective, another dimensionless parameter which indicates the influence of the intensity of
the damping of the tree on the material deformation. The way those dimensionless parameters
are calculated and the physical analysis of the model are presented in section 3.2. Then, we
apply our model to idealized HFCWO. The model suggests that a frequency can maximize the
air flows in the tree induced by the deformation of the material during a HFCWO therapy. The
frequency is related to the natural frequency of the material. Moreover, we propose a way to
model the stress felt by the mucus in the tree. We define two types of stress felt by the mucus
in the pulmonary airways from the deformation of the lung’s parenchyma : one originates from
the air-mucus interaction and one from the mechanical vibration of the airway’s wall. Finally
we propose the use of HFCWO as a non-invasise tool to asses the resistance and the compliance
of the lungs. The application of HFCWO in our model, modelling the mucus and the way to
assess idealized lung’s physical properties are presented in the section 3.3.

3.1.1   Recall of the equations of the coupled model
The model is based on the coupling between two idealized models : one of a quasi-fractal tree
mimicking the pulmonary tree and one of an elastic medium mimicking the lung’s parenchyma
tissue. The model is described in the previous chapter 2. Here, we recall the equations of the
model, see chapter 2 for more details.
    The deformation of the latter is then submitted to the dissipative action of the tree. The
number of generations in the tree is n ` 1 and the number of terminal branches is N “ 2n . The
                                                                                      i“1 Ai . Each
domain representing the spatial occupation of the elastic material is defined as Ω “ YN
subregion Ai is fed (and feeds) with air by one of the terminal branch of the tree. The equations
that rule the biomechanics of the tissue region are defined for any dimension m “ t1, 2, 3u
               $ B2 u
               ’ ρ Bt2 ´ divpσpu, Frusqqq
                                      9   “0                            xPΩ
                         9 “ λTrppuqqI ` 2µpuq ´ ptree pFrusqI        xPΩ
               ’
               & σpu, Frusq
               ’
               ’                                            9
                 σpu, Frusqq.n
                         9      “ τ ptq                                 x P Γ1                (3.1)
                 upx, tq “ 0                                            x P Γ2
               ’
               ’
               ’
                 upx, 0q “ u0 pxq                                       for x P Ω
               ’
               %


  64                                  Mechanics of the lungs and optimization of HFCWO


    where u is the displacement of the lung’s parenchyma tissue, and σ is the viscoelastic stress-
strain relationship. A Neumann boundary condition (τ ) is applied on the boundary Γ1 and no
displacement u “ 0 is imposed in the boundary Γ2 . We denote by Frus                9 1ďiďN the
                                                                         9 “ pFi rusq
vector of the flows at the N terminal branches and P “ ppi q1ďiďN , the vector of the pressures
at those same branches. The pressure ptree is a piecewise continuous function that depends on
the hydrodynamic resistances of the airways tree :
                                                     N
                                                                                             (3.2)
                                                     ÿ
                                     ptree pFrusq
                                              9 “            pi pFrusqχ
                                                                   9 i
                                                     i“1

   with

                                                        1,    if x P Ai
                                                    #
                                    with χi pxq “
                                                        0,    otherwise
   The linear relationship between the pressures and flows vectors is written using the resistance
matrix R of the airway tree [37, 25],
                                              P “ RFrus
                                                     9                                       (3.3)
   This chapter numerically studies the model in one dimension. An analytical solution of (3.1)
can be computed on a particular case, see 2.3.3. Otherwise, more generally, we apply the finite
element with the weak formulation. The system of equations (3.1) can be written using the
weak formulation with one dimension

       $                                      N
         şL B2 u
                           2µq                                    Bx dx ´ τ ptqwpt, 0q “ 0
                               Bu Bw          ř             ş
       ’
       ’
       ’
       ’     ρ
          0 Bt  2 w ` pλ `     Bx Bx   dx  ´            9 Ai Bw
                                                  pi pFrusq
       ’
       ’                                     i“1
       & up0, xq “ u0 pxq
       ’
         upt, Lq “ ub pLq ˜and wpLq “ 0                                                      (3.4)
       ’                                                            ¸
       ’
       ’                     N
                                                                       i “ 1, . . . N
       ’                    ÿ        `                            ˘
       % pi pF rusq             Rij Bu                 Bu
                                       Bt pxj`1 , tq ´ Bt pxj , tq
       ’
       ’
       ’        9 “ ´SL
                              j“1



   The first equation in (3.4) is written with the discretized approach of the finite element
method that leads to solve the following ordinary differential equation :

                              d2             dU ptq
                            M    2
                                   U ptq ` D        ` KU ptq “ τ ptqh                       (3.5)
                              dt              dt
    with U “ pui ptqq0ďiďnx the unknown vector of displacements composed of nx `1 displacement
elements. The spatial position of the ui are called degree of freedom (DoF). We refer the reader
to the section 2.2 in the previous chapter for more details.


3.2     Physical analysis of the parameters of the model with a
        dimensionless formulation
To reach a better understanding of the equations and to determine the intrinsic parameters of
the problem, we rewrite the equation (2.11) into a dimensionless formulation, see section 3.2.1.
This formulation is very convenient to relate the influence of the parameters of the model and
to extract the dimensionless numbers that drive the behaviors of the system. These parameters
will be then used to correlate the behaviors of our model with the ones of harmonic oscillator
presented in the previous chapter 2. For that, we propose an idealized formulation of the model
which is represented with only one degree of freedom, see section 3.2.2. Then, in section 3.2.3,
we propose an analysis of the dimensionless parameters for the configurations of healthy lungs
and non-healthy lungs model. The configurations of parameters are detailed in the appendix
2.E.


Physical analysis of the parameters of the model with a dimensionless
formulation                                                                                            65


3.2.1    Determination of the dimensionless parameters
The space, the time and the amplitude of the solution are adimensionalized as follows

                                    y “ x{L
                                    s “ t{T
                                                                                                       (3.6)
                                    upx, tq “ Υũpy, sq “ Υũp Lx , Tt q
                                           9 “ P p̃i pF̃r BBsũ sq
                                    pi pFrusq

The quantities L and T represent respectively the characteristic length of the system and its
characteristic time. The quantity Υ represents the characteristic displacement of the structure
and P the characteristic pressure. The rate of volume change is now
                     ˆ ż              ˙            ˆ                              ˙
               dũ             B Bũ                 Bũ              Bũ
            F̃r s “ ´           p qdy          “´        pyj`1 , sq ´     pyj , sq
               ds         Ãi By Bs     1ďiďN
                                                     Bt               Bt            1ďiďN

    The space domain becomes Ω̃ “ r0, 1s. Ω̃ is decomposed into N subsets Ãi , which are the
transformations by the adimensionalization of the corresponding Ai in the original space. Hence
the projection of Ãi on the axis y is the segment ryj , yj`1 s. We define the characteristic velocity
v of the system by v “ L{T .

                                     Characteristic quantities

               Physical quantity                        Variable name          Expression

               Time                                              T                       1
                                                                                         f
               Velocity                                          v                       L
                                                                                         T
                                                                                 b
               Wave velocity                                     c                     pλ`2µq
                                                                                          ρ

               Displacement                                      Υ                     AL
                                                                                    pλ`2µq
               Equivalent resistance of the tree                Req                     1
                                                                                     t JRJ

               Air pressure in the tree                         pL                Req SL v
               Effective air pressure in the tree                P                  A
                                                                                  pλ`2µq pL
               Tissue inertia                                    –                   ρv 2

                                      Dimensionless numbers

               Name                                     Variable name          Expression

               Euler number                                      E                     pL
                                                                                      ρv 2
               Inverse of Cauchy number                               1
                                                                                     ` c ˘2
                                                              B“      C                v
               Lung Mechanics number                            LM                     pL
                                                                                    pλ`2µq


Table 3.1: Characteristic quantities and dimensionless numbers used in this chapter. All the
characteristic quantities and dimensionless numbers are defined with the input parameters of
the model. Notice that E “ LM B.

   The characteristic pressure P is obtained by

                            Bu         Bu                Bũ       SL Υ R       Bũ
                ptree pFr      sq “ RFr s “ P p̃tree pF̃r sq “ Req           F̃r s
                            Bt         Bt                Bs              Req
                                                                    T looooomooooon
                                                               looomooon        Bs
                                                                           P
                                                                               p̃tree pF̃ r BBsũ sq


   66                                         Mechanics of the lungs and optimization of HFCWO


    where we recall that Req “ 1{pt JRJq is the equivalent resistance of the tree, i.e. how it
responds to an homogeneous distribution of pressures in its branches, see the subsection 2.2.1.2.
The vector J is defined as J “t p1, ..., 1q P RN . Hence, we can now define P “ Req SLTΥ . The
quantity SLTΥ represents a characteristic air flow in the system.
    The stress–strain relationship becomes,

                        Bũ      Bũ      PL                Bũ   Bũ    Req SL L            Bũ
           σ̃pũ, F̃r       sq “     ´           p̃tree pF̃r sq “     ´           p̃tree pF̃r sq
                        Bs       By    pλ ` 2µqΥ            Bs    By    pλ ` 2µqT            Bs

and consequently, σpu, Frusq                σ̃pũ, F̃r BBsũ sq. We call the number LM “ pλ`2µq     the Lung
                                                                                                     R S v
                          9 “ Υpλ`2µq
                                   L
                                                                                              eq L


Mechanics number, it compares the characteristic pressure in the terminal branches pL “ Req SL v
induced by the viscous dissipation of the air flow in the tree to the the elastic response of the
material, here represented by pλ ` 2µq.
   At the boundary y “ 0, σ̃pũ, F̃r BBsũ sq.n “ pλ`2µqΥ  AL
                                                                 τ̃ psq, with A the characteristic amplitude
of pressure applied on the boundary and τ̃ psq “ τ pTAsq the applied stress. In order to get a
dimensionless stress at the boundary, we set the characteristic displacement to Υ “ pλ`2µqAL
                                                                                              . It
is the result of the trade-off between the applied boundary stress and the elastic response of the
material, scaled by the size of the object. Typically, the applied stress τ on the boundary is a
sinusoidal signal with frequency ω, τ ptq “ A sinpωtq, hence unless stated differently, T “ 2π{ω
is the characteristic time of the system.
    Substituting these dimensionless quantities in the weak formulation of the system brings a
new dimensionless weak formulation, for any smooth function w such as wp1q “ 0,

                       B 2 ũ
              ż                 ˆ                ˆ „ ˙˙                           ż
                                   Bũ               Bũ Bw
                           2
                              w` B     ´ E p̃tree F̃        dy ´ B                      τ̃ psqw dy      “0         (3.7)
                  Ω̃   Bs          By                Bs  By                         Γ̃1
                                                                                   loooooomoooooon
                                                                                “τ̃ psqwp0q (1D case)


with B the inverse of the Cauchy number of the system B “ pλ ` 2µq{ρv 2 that compares the
elastic forces in the material with the inertial forces. The number E “ LM B is actually the Euler
number of the system since it can be rewritten in the form E “ ρv    pL
                                                                       2 . It compares the pressures
forces induced by the viscous dissipation of the air flow in the tree with the inertial forces in the
material.
    Finally, the system is characterized by two dimensionless numbers: B “ pλ ` 2µq{ρv 2 and
E “ pL {ρv 2 “ Req SL {ρv. The pressure pL represents the non-coupled characteristic pressure in
the terminal branches of the tree, i.e. in the absence of the coupling with the respiratory zone;
the pressure P represents the efficace characteristic pressure resulting from the coupling, it is
equal to the non-coupled characteristic pressure weighted by the ratio between the applied force
A and the elastic response pλ ` 2µq. As a verification, we express the balance of energy of the
system.

   Energy of the system. Taking w in equation as the velocity of the material, i.e. w “ BBsũ ,
we can determine the time variation of the energy of the system.
   ˜ ż ˆ                                                      ˙2 ¸
 d 1 1 Bũ                              1 1 Bũ
                           ˙2              ż ˆ                                                 N
                                                                                 Bũ           ÿ           Bũ       Bũ
                    py, sq dy ` B                     py, sq dy “ Bτ̃ psq p0, sq ` E               p̃i pF̃r sqF̃i r s
 ds 2 0 Bs                              2 0 By                                   Bs
                                                                         looooooomooooooon    i“1
                                                                                                           Bs        Bs
   looooooooooooooooooooooooooooooooomooooooooooooooooooooooooooooooooon                   loooooooooooooomoooooooooooooon
                                                                         input power
                          Total energy of the system                                          viscous power dissipated
                                                                                                     (3.8)
Since the pressure p̃i pF̃r BBsũ sq in an Ai is of the opposite sign than the corresponding flow Fi r BBsũ s,
then the term in E corresponds to a damping of the tissue, as expected.

    In the dimensionless equation (3.7), each term plays a part on the shape of the solution and
is weighted and compared with the other terms by the value of its respective prefactor. The
prefactors are either 1 or one of the two dimensionless parameters B or E. The dimensionless


Physical analysis of the parameters of the model with a dimensionless
formulation                                                                                             67


equation (3.7) can be decomposed according to the physical role of its different terms:
        ż1
                 B 2 ũ
                              ˆ                    ˆ „ ˙˙
                                     Bũ                 Bũ      Bw
                         w`        B     ´ E p̃tree F̃               dy ´      B  τ̃ psq     wp0q “ 0    (3.9)
        0          mo2on
               looBs                                     Bs
                                     Byon loooooooooomoooooooooon
                                  loomo                           By           loomoon
                                                                            boundary force
             acceleration     elasticity         damping

    The study of the role of each dimensionless parameter singled out allows to determine charac-
teristic behaviors of the system. These behaviors could be interpreted in terms of the physiology
as highly pathological situations, such as strong constrictions of the bronchi. An analysis is pro-
posed in the appendix 3.A to study the behaviors of the system for asymptotic values of the
dimensionless parameters.
    The next section proposes an idealized formulation for our coupled model with one degree of
freedom. This formulation is then assimilated to an equation ruling the motion of an harmonic
oscillator with one degree of freedom.

3.2.2       The coupled model reduced to one degree of freedom
The section 2.4 in the previous chapter shows some similarities between the response of our
coupled model and the harmonic oscillator. Moreover, the appendix 2.D presents the properties
and characteristics of the motion of a damped and forced harmonic oscillator with one degree
of freedom (DoF) ruled by the equation :

                                  d2 xptq      dxptq
                                      2
                                          ` 2ξ       ` ω02 xptq “ hptq                      (3.10)
                                   dt           dt
    with ξ the damping coefficient, ω0 the natural angular frequency of the oscillator and h a
driving force. The appendix 2.D details how the amplitudes of the motion and of the velocity of
the oscillations evolve according to the pulsation of the forced component and to the intensity
of the damping coefficient. It raises two behaviors that can be predicted from the value of the
quality factor (the Q-factor) defined by Q “ ω2ξ0 . The Q-factor, which is determined from the
natural frequency (ω0 ) and the damping coefficient (ξ), characterizes the influence of the damp-
ing and determines the intensity of the phenomenon of resonance. More precisely, we have seen
that if the Q-factor is strictly above a specific value (Q ą ?12 ), the amplitude of the motion of
the oscillator is maximized   when the oscillator is forced at a pulsation equal to the resonance
frequency (ω « ωr “ ω0 ´ 2ξ 2 ). Additionally, for Q ą ?12 , the amplitude of the velocity is
                        a
                            2

maximised at the the natural frequency of the oscillator (ω “ ω0 ). Below this specific value
(Q ď ?12 ), no resonance occurs, the oscillator is too damped, see Appendix 2.D for more details.

    The Q-factor is then a relevant variable indicating if the oscillating system can reach reso-
nance that could maximize its motion while forced. In this subsection, we focus on expressing
the equation of our model with an idealised one DoF formulation in order to draw a quality
factor that can inform on the resonance of the lungs. We will use the discretized equation (3.5)
of the dimensionless model obtained with the finite element method :

                                      d2             dU ptq
                                  M      2
                                           U ptq ` D        ` KU ptq “ τ ptqh                           (3.11)
                                      dt              dt
    with U “ pui ptqq0ďiďnx the displacement vector containing displacement element ui com-
puted at the nx ` 1 degrees of freedom. For this subsection, we use the term "coupled model" to
refer to the equations (3.11) defined for several degrees of freedom. The idealised one DoF model
is named "the single DoF model" and it will be defined from the dimensionless formulation of
(3.11). The equation of the single DoF model can be assimilated to the equation of the motion
of a damped and forced harmonic oscillator with one degree of freedom. Hence, the single DoF
model is a qualitative expression built to study the Q-factor and potentially to propose insight
on the resonance of the lungs. Then, to ensure the significance of this quality factor, we compare
the results obtained from the response of the coupled model with those of the single DoF model.


  68                                          Mechanics of the lungs and optimization of HFCWO


3.2.2.1    Hypothesis
We consider the unidimensional and discretized equation (3.5) written with the dimensionless
formulation (3.7). We assume that the spatial occupation of the lung’s parenchyma is expressed
with only two positions (or degrees of freedom). In our case, the two degrees of freedom are
the positions x “ 0 and x “ L. Moreover, in the subsections 2.4.1 we saw that the damping
influence of an idealised symmetric tree with a large number of generations behave quite the
same as the one with a small number of generations. Hence, we assume that the lung’s tissue is
subjected to only one homogeneous pressure. This can be simulated by considering only one Ai .
                             ´ Dirichlet condition
Finally, we apply a homogeneous                   ¯ (upL, tq “ 0 , @t) in x “ L and a sinusoidal
Neumann condition in x “ 0      Bx .n “ τ ptq , @t .
                              Bup0,tq



3.2.2.2    Formulation of the single DoF model
We recall that the discretized equation of the dimensionless coupled model can be computed
using the finite element method described in the appendix 2.B. It is written :

                                              :̃ ` E D̃U9̃ ` B K̃ Ũ “ B h̃τ̃
                                           M̃ U
                 9̃        2
   with U :̃ “ dU “ d Ũ , and with M̃ , D̃ and K̃ respectively the dimensionless mass, damping
               dt    dt2
and stiffness matrices and h̃ the dimensionless vector of loads. The vector Ũ is the dimensionless
vector displacement. The dimensionless damping matrix D̃ is defined as D̃ “ S t G̃ RReq G̃, with
S a characteristic surface. For two degrees of freedom this equation becomes

          ˆ          ˙ ˜ :̃ ¸     ˆ            ˙ ˜ 9̃ ¸     ˆ           ˙ˆ ˙       ˆ ˙
           M̃11 M̃12    U1         D̃11 D̃12      U1         K̃11 K̃12    Ũ1       h̃1
                              ` E                       ` B                   “ τ̃
           M̃21 M̃22     :̃
                        U2         D̃ 21 D̃ 22     9̃
                                                  U2         K̃ 21 K̃22   Ũ2        0

   Particularly, the damping matrix D̃ is written :

                                                ˘ 1
                      ˆ          ˙                  ˆ         ˙ˆ ˙
                       D̃11 D̃12      `               R11 R12   G̃1
                                   “ S G̃1 G̃2
                       D̃21 D̃22                 Req R21 R22    G̃2
   Actually, as considering only one generation for the tree, the elements of the resistance
matrix are equal to R0 as well as the equivalent resistance Req . With the homogeneous Dirichlet
condition in x “ L, the second element of the vector Ũ is null (Ũ2 “ 0). We got :

                                        :̃ ` E D̃ U9̃ ` B K̃ Ũ “ B h̃ τ̃
                                   M̃11 U 1      11 1       11 1      1                                   (3.12)
   With the dimensionless formulation and with two degrees of freedom, the elements of the
matrices and of the vector are equal to
                   $
                                         M̃11 “ 13
                   ’
                   ’
                   ’
                   ’
                   ’
                   ’
                   ’
                                         K̃11 “ 1
                   ’
                   ’
                   &

                                                          h̃1 “ 1
                      ’
                      ’
                      ’
                      ’
                      ’
                      ’
                      ’
                                               R11
                                                     G̃1 “ S p´1q R              R11
                                                                                       “1
                      ’                                            11
                               D̃11 “ S G̃1                       Req p´1q “ S
                      ’
                      %
                                               Req                               Req

   With E “            ,                   and setting ũ “ Ũ1 , equation (3.12) can then be written :
               Req T L            ` c ˘2
                 ρ         B“      v

                             :̃ ` 3Req T L u9̃ ` 3 c ũ “ 3 c τ̃
                                                  ´ ¯2         ´ ¯2
                            u                                                              (3.13)
                                     ρ             v            v
   The previous equation is a typical equation describing the motion of a damped and forced
harmonic oscillator, see (3.10) and Appendix 2.D. This is the expression of the single DoF model.
By analogy, we conclude that


Physical analysis of the parameters of the model with a dimensionless
formulation                                                                                  69



                                   3Req T L                        ´ c ¯2
                            2ξ “                and      ω02 “ 3
                                      ρ                             v
   and that the Q-factor is :
                                                   ?
                                           ω0    cρ 3
                                        Q“    “
                                           2ξ   3Req L2
    In the case of a one generation tree, the equivalent resistance, as stated above, is equal to
the resistance of the only airway (R0 ). However, to reach a physiological value for the resistance
of the tree, the value of R0 can be modulated with a corrective factor as used in the previous
chapter. Consequently the variable Req can characterize the overall resistance that the air
encounters from the ambient air to the exchange surface in the lungs.
    The Q-factor is then computed from the properties of the tissue and of the tree. By extension,
it can be written with the dimensionless parameters as :
                                                    ?
                                                1 B
                                           Q“ ?                                              (3.14)
                                                  3 E
    We recall that the higher the Q-factor is, the lesser is the damping. We also notice that,
considering the dimensional discretized equation, we obtain the same definition for the quality
factor, see the appendix 3.C.

3.2.2.3   Numerical simulations
We want to verify the significance of the definition of the Q-factor found above with numerical
simulations. More specifically, we want to check if this quality factor has similar predictions
properties for resonance with the single DoF model and the coupled model. We run compara-
tive numerical simulations. On one hand, we compute the amplitudes of the motion and of the
velocity of the solution of the single DoF model (3.13) whose definitions is deduced from the
theory of harmonic oscillator, see Appendix 2.D. On the other hand, we compute the averaged
displacement over the domain and the time and the averaged kinetic energy over the time com-
puted from our coupled model.

    Input data.       We use the set of parameters from the non-physiological lungs (see the
appendix 2.E) in which the value of the resistance of the tree varies in order to have different
values of the Q-factors. For the single DoF model, we adjust the resistance Req to 1, 1{3, or 1{7,
resulting in a Q-factor equal to respectively, 0.6, 1.7 or 4. For the coupled model, we adjust the
non-physiological matrix Rnp using the same values 1, 1{3, or 1{7 as multiplying factors that
leads to Q-factors equal respectively to 0.5, 1.6 or 3.7. Typically, for the coupled model, the
equivalent resistance Req is equal to k{pt JR´1np Jq, with k set to 1, 1{3, or 1{7. For numerical
visualisation purpose, the natural pulsation of the single DoF model is called ω0 and the funda-
mental pulsation (the smallest natural frequencies) of the coupled model is written ω1 .

    Output data. On one hand, we compute the amplitudes of the motion and of the veloc-
ity of the oscillation (divided by the amplitude of the forcing term) from the equation (3.13)
and from the values of the Q-factors, see the appendix 2.D for the definitions. On the other
hand, we compute the quantity Ru and Ek defined in section 2.4.2 for the coupled model :
                          2
                                          ´                          ¯1
                                 and                                    .
           şT şL                                ş Tf ş L 2            2
Ek “ 12 Tρf 0 f 0 Bupx,tq
                    Bt      dxdt     Ru “    1
                                            Tf L 0    0 u  px, tqdxdt

    Results.      In the figure 3.1, we observe that the amplitudes of displacement and the
velocity of the deformation behave similarly in the single DoF model and in our coupled model.
Typically, the respective maxima are reached for the closely same pulsations according to the
natural pulsations (ω0 and ω1 for respectively the single DoF and coupled models). We also
notice that the averaged kinetic energy and the averaged displacement for the highest quality


        70                                       Mechanics of the lungs and optimization of HFCWO


 factor (Q “ 3.9) has a local maximum located at pulsations equal to the second eigen pulsation.
 For that case, that explains that the damping is low and allows resonance phenomenon for the
 other natural pulsations. The amplitudes of the curves are not equivalent as we compute different
 quantities. The results have to be understood for qualitative and comparative purposes and not
 quantitative ones. The results raises the fact that the quality factor of the single DoF model can
 be used to predict resonance phenomenon of the coupled model while saving drastically time
 computation.
                   Amplitude of the displacement - 1 dof                                                    Amplitude of the velocity - 1 dof
        1.4                                                                                    2.5

        1.2                     Q=4
                                                                                                2                     Q=4
         1

                                                                                               1.5
        0.8
  X/H




                                                                    V/H
        0.6
                                                                                                1

        0.4         Q=1.7
                                                                                               0.5                    Q=1.7
        0.2       Q=0.6
                                                                                                          Q=0.6
         0                                                                                      0
              0             1           2        3           4                                       0            1            2       3           4


                   With a eight generation tree. multi-dof                                               With a eight generation tree. multi-dof
         0.3
                                Q=3.7                                                          1.2
                                                                 Averaged kinetic energy (J)




        0.25                                                                                                           Q=3.7
                                                                                                1
         0.2
                                                                                               0.8
R (m)




        0.15
  u




                    Q=1.6                                                                      0.6

         0.1                                                                                   0.4
                  Q=0.5                                                                                      Q=1.6
        0.05                                                                                   0.2
                                                                                                                   Q=0.5
             0                                                                                  0
                            1           2        3           4                                                 1               2       3           4



 Figure 3.1: Top : Evolution of the amplitude of the oscillation (left) and of the velocity of the
 oscillations (right) according to the pulsation of the external force for different Q-factors (by
 varying the damping of the tree) with the single degree of freedom model (1 DoF). Bottom :
 Evolution of the kinetic energy averaged in time (left) and of the total displacement averaged
 in time and in space (right) according to the pulsation of the applied pressure for different Q-
 factors (by varying the damping of the tree) with the coupled model (multi-DoF). Note : The
 single DoF model is ruled by the equation (3.13). The coupled model is ruled by the equation
 (2.18). For both models, the quality factor is defined by (3.14). For the single DoF model, Req
                                                                         np Jq, with k set to 1, 1{3,
 is set to 1, 1{3, or 1{7. For the coupled model, Req is equal to k{pt JR´1
 or 1{7.


 3.2.2.4            Application of the Q-factor to the HFCWO
 The previous results show that the Q-factor allows to determine if the resonance occurs in our
 coupled model of the lungs. The value of the quality factor, which is computed directly from
 the dimensionless parameters, informs on the influence of the damping on the motion of the
 lungs’ tissue. The major advantage is that the computation of the Q-factor avoids computing
 the response of the lungs for different pulsations, which might lead to a heavy computational


Physical analysis of the parameters of the model with a dimensionless
formulation                                                                                   71


cost.


3.2.3      Predicted behaviors of healthy and non-heatlhy lungs with the dimen-
           sionless parameters
In this subsection, we propose an analyze of the dimensionless parameters in the case of healthy
and non-healthy lungs models. For this cases, we also investigate the values of the Q-factor that
we determine in the previous subsection. The dimensionless parameters propose indications on
the potential behaviors of the model. The Q-factor informs on the influence of the damping
of the tree on the elastic material. The quality factor can be an indicator for resonance phe-
nomenon. The parameters of healthy and non-healthy are taken from averaged values found in
the literature. The results have to be understood in the limits of the model.

    We compute the values of the dimensionless parameters for healthy and non-healthy (asthma,
COPD, CF1 ) lungs, during the tidal breathing and during a HFCWO therapy, see the section
2.5 and the appendix 2.E. For HFCWO, we set the frequency to a relatively high frequency (20
Hz) which is usually used in the treatment [96] in order to have an indicated comparison between
the therapy and the ventilation at rest which works with lower frequency (1{5 Hz). Moreover,
we compute the values of the Q-factor (definition (3.14)). As it is independent of the frequency,
the quality factor has the same value for the ventilation at rest and for HFCWO.

    Ventilation at rest
For the ventilation at rest for healthy lungs, the Euler number E, which represents the damping,
is about 10 times lower than the inverse Cauchy number B that represents the relative role of
the elasticity. This indicates that the system tends to dissipate slowly the elastic energy injected
by the diaphragm. The damping of the tree is not high enough to stop the elastic recoil of the
lungs that allows the expiration to be passive. However, the damping is also not negligible as
the small value of the Q-factor indicates. It prevents any amplification of the deformation of
the lungs, i.e. any kind of resonance that could lead to an excessive deformation of the system.
Moreover, both E and B are larger than 1, indicating that the acceleration plays a small role on
the dynamics and that most of the energy is stored as elastic energy. Hence, the elastic recoil is
preponderant during rest ventilation for healthy lungs.
    For the non-healthy lungs at tidal breathing, the euler number E is about 10 times higher
than for healthy lungs. It is close to the parameter B for asthma, exceeds B for COPD (about
20% higher) and represents half B for CF. This shows that the stored energy is less dissipated
by the tree for CF than for asthma and COPD. Globally, it shows that for non-healthy lungs,
the stored energy is more dissipated by the tree than for healthy lungs. This indicates that the
respiratory muscles have to increase their work in order to compensate the dissipation of the
tree and to ensure a proper ventilation. Moreover, the reduction of the parameter B in COPD
corresponds to a reduction of the elastic recoil that leads to lungs hyperinflation because of the
reduction of the efficiency of the passive expiration. This is a typical symptom of the COPD
disease that implies severe respiratory muscles fatigue due to the increase of their work. While
lungs hyperinflation is also true for the asthma because of the increase of the dissipation, study
shows that severe respiratory muscles weakness was not often seen in CF patients [26] which is in
agreement with the values of the dimensionless parameters in the case of CF lungs. Specifically,
the increase of B because of the increase in lung’s tissue stiffness in CF favours a better elastic
recoil for CF than for asthma or COPD. As a consequence, a better elastic recoil reduces the
work of breathing, for expiration at least. Interestingly, the authors of [26] have measured, in a
population of 27 CF adolescent and adult patients, that the respiratory muscles strength during
expiration remains within the range of healthy lungs whereas during inspiration, it is higher
than for healthy lungs. This suggests that the respiratory muscles do not have to compensate a
lack of elastic recoil, as our dimensionless parameters suggest.
   1
       COPD : Chronic Obstructive Pulmonary Disease, CF = Cystic Fibrosis


  72                                 Mechanics of the lungs and optimization of HFCWO



    HFCWO (20 Hz)
With higher frequency than ventilation at rest, typically 20Hz of HFCWO, we observe that the
prefactor in front of the kinetic (1) and the elastic terms (B) are of the same order of magnitude
for both healthy and non-healthy lungs. The parameter B is always lower than E. The ratio
between B and E is about 1% and 10% for respectively healthy and non-healthy lungs. For
all cases, the parameter B is of the same order of magnitude as the prefactor 1. This indi-
cates that the kinetic and the elastic components are of the same order of magnitude. We have
seen previously that the kinetic and the elastic components are of the same order of magnitude
around the fundamental natural frequency. Typically, at this frequency, the kinetic and the
elastic components compensate and cancel each other out, leading to a system that is driven
only by the remaining components, i.e. the damping and the driving force according to the type
of system. This frequency favours resonance. Then, the intensity of the damping modulates
the intensity of the resulting displacement which can be maximum at frequencies lower than
the natural frequency. For a small damping, the resonance frequency is close to the natural
pulsation. For a higher damping the resonance frequency is lower to the natural pulsation, see
the appendix 2.D in the previous chapter.

    Actually, in our model, for both healthy and non-healthy cases, the Q-factor is lower than
the critical value of ?12 (see Appendix 2.D). This indicates that the intensity of the damping
of the tree is large compared to the physical properties of the lung’s tissue. This prevents
resonance. However, we recall that the values used to mimic the resistance, the size and the
elastic properties of the lungs are taken in the literature from average healthy lungs. Those data
is not valid for all individuals. Moreover, the dimensionless parameters of the model and the
Q-factor are determined from a model of the lungs based on idealized assumptions. The result
have to be interpreted in the limitations of the model. Nevertheless, we have seen that the model
is able to reproduce qualitative physiological behavior of the lungs such as tidal breathing or
pathological breathing. We have seen that the dimensionless parameters can corroborate those
behaviors, for example : lungs hyperinflation. Hence, the quality factor could be used as an
indicative parameter. Here, the Q-factor indicates that the damping influence is too high to
prevent resonance. However, we have seen for harmonic oscillator, that the velocity is always
maximised when the oscillator is forced at pulsation equal to the natural pulsation. The damping
acts on the amplitude of the maximum of the velocity. In the next section we will investigate the
influence of the damping on the velocity of the elastic deformation with numerical simulations.
Precisely, we will study how the lungs respond to a range of pulsations compatible with HFCWO.
We will focus on the air flows in the tree, computed from the air velocities, and analyze the
behaviors of the lungs using the quality factor.

                                       Healthy lungs     Non-healthy lungs model
                                          model          Asthma    COPD         CF
              Ventilation        E         1565           14765     10806      17314
                at rest         B          16821          16821      8411      33643
                                 E         15.650         147.66      108      173.14
          HFCWO (20Hz)
                                B         1.6821          1.6821     0.84      3.3643
             Quality factor     Q          0.048          0.0051    0.0050     0.0061

Table 3.2: Values of the dimensionless parameters to mimic healthy and non-healthy lungs
models for tidal breathing and HFCWO (20 Hz). The values of the Q-factor are computed from
the definition (3.14). The term COPD is for Chronic Obstructive Pulmonary Disease and CF
is for Cystic fibrosis.


Modelling the High Frequency Chest Wall Oscillation in healthy and
non-healthy lungs                                                                             73


3.2.4    Conclusion
The dimensionless formulation raises two specific dimensionless parameters defined from the
parameters of the model. The dimensionless parameters propose indications on the behaviors of
the lungs. For example, they can suggest if the elastic recoil of the lungs is sufficient relatively
to the damping of the tree to allow a passive expiration. Moreover the dimensionless parameters
indicate how the dimensional parameters are interacting together. Last but not least, a quality
factor can be computed from the dimensionless parameters. It indicates the capability of the
lungs model to resonate. The Q-factor is defined from the fundamental pulsation of the material
(without damping) and from the resistance and the size of the lungs. In the table 3.2, we
have computed the values of the Q-factor for the healthy and non-healthy lungs models. The
quality factor is smaller than the critical values ?12 , see Appendix 2.D. This indicates that
no phenomenon of resonance can occur. However, from the study of a harmonic oscillator
(Appendix 2.D), we have seen that the amplitude of the velocity is always maximised at the
natural frequency of the oscillator and that this amplitude is modulated by the damping. In
our model, the velocity of the deformation is directly related to the air flow induced by the
displacement of the lung’s parenchyma. In the next section, we investigate the impact of the
damping on the mouth air flows at mouth in the case of an idealized a HFCWO.


3.3     Modelling the High Frequency Chest Wall Oscillation in
        healthy and non-healthy lungs
The values of the quality factor computed in the previous section 3.2 for the healthy and non-
healthy cases suggest that no phenomenon of resonance can occur for the lungs : if the lungs are
continuously stimulated by a periodic force, its motion will not amplify through time. However,
the study of the harmonic oscillator shows that the amplitude of the velocity of the deformation is
always maximised at the natural frequency of the material. The damping acts on the intensity
of this maximum. We want to determine the influence of the damping on the amplitude of
the velocity. In our model, it amounts to observe the airflows induced by HFCWO. With the
hypothesis that a HFCWO device is more efficient if the airflows are larger, we compare its
efficiency by applying periodic pressures on the model of the lungs with different frequencies.
The study is performed for the healthy lungs model in the subsection 3.3.2. Moreover, we study
the stress felt by the mucus inside the tree during a HFCWO manipulation. First, to be able to
compute those stresses, we propose an idealised model for the mucus, see subsection 3.3.1. Then,
we propose perspectives of use for the model. We investigate the influence of the damping for
non-healthy lungs (subsection 3.3.4) and we propose a way to use the HFCWO as a non-invasis
tool (subsection 3.3.5).
     The parameters used for the modelling of HFCWO are based on the configuration of param-
eters mimicking healthy and non-healthy lungs, see the section 2.5 of the previous chapter, and
also the tables of the appendix 2.E for more details. We notice that due to the linearity of the
equations relatively to the Neumann boundary condition at x “ 0 (where the periodic pressure is
applied), mixing the rest ventilation and HFCWO would bring an amount of airflow that would
be the sum of the airflows induced by the ventilation and by the HFCWO computed separately.
Hence, in order to isolate the effects of HFCWO in our simulations, we do not account here for
the lung’s ventilation as discussed in the introduction.


3.3.1    Modeling the stress in the mucus
During HFCWO manipulations, the mucus is submitted to two types of stress that deform the
mucus layer : one arising from the air–mucus interactions and one from the oscillations of the
airways walls. The mucus is viscoelastic and its inner stress needs to be larger than its yield
stress to be able to move. These stress add together and can either overcome directly the mucus
yield stress and make it flow, or represent a buffer of stress, de facto reducing the quantity of


  74                                  Mechanics of the lungs and optimization of HFCWO


stress to apply to overcome the mucus yield stress.

    Air–mucus interaction
The first stress is the one induced by the air–mucus interaction [83, 84]. As the mucus layer is
in general thin relatively to the diameter of the airways, this stress can be approximated by the
wall shear stress induced by the air flow in the airways [124, 125]. As the airflows induced by
HFCWO are small, we assume that the air fluid mechanics follows the Poiseuille’s regime in the
airways. Hence, the wall shear stress σa in an airway with radius r and an airflow φ is [124]

                                                            µa φ
                                                     σa “
                                                            πr3

with µa the air viscosity, µa “ 1.8 10´5 Pa.s. Globally, the wall shear stress in the tree is
maximal when the air flow in the tree is maximal.

    Airways wall oscillations
The tissue oscillations regularly compress and relax the airways, with the consequence of peri-
odically affecting the geometry of the airways walls. To evaluate the resulting stress applied to
the mucus, we assume as a first approximation that a deformed airway remains a cylinder with
the same length, that only its radius is affected and that no strain occurs along the axis of the
airway. With these hypotheses, the displacements of the wall of an airway with rest radius r0
induce a change of the perimeter of their section from the rest length, 2πr0 , to the deformed
length, 2πrptq with t Ñ rptq representing the radius of the airway as a function of the time. The
airways deformations are small and, for determining the radius evolution with time, we can use
the same model as in [85] that considers the airway walls as springs. We can then relate the
time evolution of the radius of an airway to the elastic properties of its wall and to the variations
of the pressures in the tissue pt and of the pressure of the air in the airways pa . In this first
approximation model, we assume that the Young’s modulus Eb of the walls of the airways is
the same for all the airways and that Eb “ 6250 Pa [85]. Details about the derivation of the
dynamics of the airways radii are given in Appendix 3.D. The pressure pa is taken as the mean
air pressure in the airway and is computed using the pressure–flow relationships in the airways,
see equation (3.3) and Appendix 3.D. The pressure pt is an estimation of the mechanical pres-
sure surrounding the airway. In our model, the airways have no spatial occupation, hence pt is
estimated using the mean mechanical pressure over the region Q of the respiratory zone fed by
the airway studied. More precisely, if we consider all the paths from the terminal branches to
the root of the tree, the set Q is the union of the Ai ’s that are coupled to a terminal branch
whose associated path includes the airway studied. Finally,

                                                Q n Trpσpuqpt,
                                                  1
                                                ş
                                                               xqq      dx
                                     pt ptq “
                                                            Q1
                                                      ş
                                                                   dx

See details in Appendix 3.D. In the unidimensional in space, n “ 1 and
                                 ż                                           ż
                                           du
                         pt ptq “ pλ ` 2µq    ´ ptree pFrusq
                                                         9 dx{                   1 dx
                                  Q        dx                                Q

    The way the radius evolves with time induces a tangential strain on the interface between
                                                    r0 . Under the hypothesis that the pressure
the mucus and the airway wall, θ pr0 , θ, zq “ rptq´r 0

difference felt by the airway is small relatively to Eb , the resulting absolute stress in the mucus
can then be estimated to,

                                                    5 Em
                                      σptq »             |pa ptq ´ pt ptq|                    (3.15)
                                                    4 Eb
   with Em is the Young’s modulus of the mucus, see Appendix 3.D.


Modelling the High Frequency Chest Wall Oscillation in healthy and
non-healthy lungs                                                                             75


3.3.2     Effects of the HFCWO on the healthy lungs model
3.3.2.1    Modeling HFCWO with our model
In our unidimensional model of the lungs, we recall that a Neumann boundary condition is
applied on one boundary (τ on x “ 0) and no displacement is set to the other boundary (u “ 0
on x “ L). The amplitude A and the pulsation ω of the boundary condition at x “ 0 are
adjusted to mimic an idealised HFCWO maneuver. We consider HFCWO to work as a thrust
and a traction at each cycle, with a boundary normal constraint (pressure) τ ptq “ Asinpωtq,
with ω “ 2πf and f the frequency. The typical frequencies used in HFCWO devices are in the
range 1Hz to 20Hz. To the best of our knowledge, the amplitude of the force felt by the lungs
due to the pressure on the thorax is not documented as of today. Since our model is linear in
A, we can easily determine the solution for any value of A from a single computation once the
other parameters, such as the frequency, have been fixed. Our goal is to compare the efficiency
of the different frequencies by observing the airflow induced by HFCWO.


3.3.2.2    Influence of the amplitude A of the applied pressure
HFCWO devices are used to help the draining of the mucus but not for assisting ventilation.
The volume of air moved at each cycle, called Vp , is small relatively to the tidal volume of normal
ventilation. At rest, the tidal volume is around 500 mL including the dead space, Vd “ 150 mL,
that does not take part in the gas exchanges. We assume that the device does not ventilate
more than half the dead space (Vp ď V2d “ 75 ml). With this hypothesis, setting f “ 10Hz,
the amplitude A of the applied pressure in our model, in order to ventilate half the dead space,
is A “ 247 Pa. We assume that this value of A is the maximal possible pressure applied by
HFCWO in our model. For the next, we set A “ 200 Pa.

3.3.2.3    An optimal range of frequencies
HFCWO is known to help the mucus movement by affecting its rheology, out of the scope of
this study, and by applying airflows that interact with the mucus by inducing shear stress at the
air–mucus interface [83, 84, 125]. The air volume Vp exchanged with the ambiant air and the
airflows created by HFCWO are dependant on its working frequency, whose recommended values
are based on empirical knowledge. Hence, we study with our model the influence of the HFCWO
frequencies on the inhaled air volume and on the tracheal airflow (flow in the first generation
of the tree). We assume that the amplitude of the applied pressure A at the boundary x “ 0 is
fixed to A “ 200 Pa and make the frequency of HFCWO range between 1 Hz and 20 Hz.
    The model predicts that Vp decreases as the frequency increases, with a decreasing slope,
as shown on figure 3.2 (left). Also, the average airflow increases for frequencies lower than 6.6
Hz and then decreases, hence the maximal airflow is reached at an optimal frequency fo “ 6.6
Hz, see figure 3.2 (right). As our model is linear in the amplitude of the boundary constraint
A, A affects only the amplitude of the volumes and of the airflows, but not the location of the
maximum. Near the optimal frequency fo , the airflow is actually on a plateau. In the range of
frequencies from 3 Hz to almost 20 Hz, the amount of airflow remains within 1% of the maximum.
By maximizing the airflow in the tree, this range of frequencies also maximizes the air–mucus
interactions during HFCWO maneuvers. It appears that the optimal frequency fo “ 6.6 Hz that
maximizes the airflow in thebtree corresponds to the fundamental natural frequency (Appendix
2.C) of the material f1 “            4L “ 6.5 Hz that relies on the properties of the material
                               pλ`2µq 1
                                  ρ
(rigidity, density and size). Then, this maximum corroborates the properties of a harmonic
oscillator. Indeed, we have seen that the velocity of the motion of a harmonic oscillator is
always maximised for the natural frequency.
    Actually, resonance frequencies (i.e. eigen frequencies) of the respiratory system have been
estimated in the litterature to 6 Hz for healthy adults [91] and to 18Hz for infants lungs with
respiratory distress syndrome (in average over 18 infants) [75]. Those estimations are quite


                        76                                Mechanics of the lungs and optimization of HFCWO



                                                                                           405
volume per cycle (mL)




                                                                     average flow (mL/s)
                        300
                                                                                           400


                        200
                                                                                           395


                        100
                                                                                           390           mean flow
                                                                                                         maximum of the mean flow
                                                                                                         1% around maximum
                                5       10           15         20                               5       10           15            20
                                    frequency (Hz)                                                   frequency (Hz)

       Figure 3.2: Left: Volume of air (mL) ventilated at each cycle of the applied constraint according
       to the frequency of the applied constraint from 1Hz to 18Hz. Right: Mean air flow according
       to the frequency of the applied constraint (from 1Hz to 20Hz) with a maximum of mean flow
       for » 6.6Hz (long red-dashed line) and a range of frequencies for a mean flow within a range of
       1% of the maximum (small red-dashed line).


       equivalent with our fundamental eigenfrequency f1 “ 6.5 Hz obtained by considering a charac-
       teristic length of L “ 20 cm for average adult lungs. Particularly, if we assume approximately
       a characteristic length of 7 cm for infants lungs, we obtain a fundamental eigenfrequency of
       f1 “ 18.5 Hz.
           The wide range of frequencies from 3 Hz to 20 Hz that remains in 1 % of the maximum
       describes the fact that the intensity of the damping is pretty strong compared to the elastic
       properties of the the material, as shown by the value of the Q-factor (Q “ 0.048). If we study
       the displacement averaged over space and time for different pulsations, we observe that the
       maximum is reached for the smallest frequency. This is a result that occurs also for harmonic
       oscillator. Indeed, for harmonic oscillator, the maximum of the motion amplitude is reached
       for the smallest frequency if the damping is too high compared to the stiffness of the oscillator.
       However, the resistance of the tree controls the intensity of the resonance in the value of the
       Q-factor. Hence, different lungs resistances involve different intensity resonance. The next
       subsection 3.3.3 studies the intensity of the mouth air flows for different resistances in the range
       of healthy lungs resistances (from 0.5 cmH2 O.s.L´1 to 4 cmH2 O.s.L´1 [87]). Prior to that, we
       will investigate the distribution of the stress inside the generations of the tree.


       3.3.2.4                Stress in the mucus in the optimal configuration.

       At the optimal frequency, we computed the two types of stress (defined in 3.3.1), averaged
       over one HFCWO cycle per unit of stress applied at the boundary. We estimate the order of
       magnitude of the stresses in the different airways of the tree, see figure 3.3.
           The stress due to the vibrations of the walls is larger than the stress induced by the air
       flow in the proximal2 part of the tree, but becomes smaller deeper in the tree. This effect is
       related to the air pressure in the airways. In the proximal part of the tree, the air pressure is
       small and the airways mechanics is mainly driven by the tissue pressure. Hence, we can deduce
       from equation (3.15) that in the distal airways, σptq » 45 EEmb |pt ptq|. Since the amplitude of pt is
       directly related to the applied sinusoidal stress of amplitude A, we can derive an estimation of
       the maximal possible mean stress due to the wall vibrations of about σ „ 45 EEmb A2 “ 0.02 Pa when
       A “ 200 Pa. The estimation is of the same order of magnitude than the results found by our
       numerical simulations. In the distal parts of the tree, the air pressure increases and compensates
           2
             The proximal airways are located in the generations close to the trachea. Inversely, the distal airways are
       located in the generations far from the trachea.


                                                  Modelling the High Frequency Chest Wall Oscillation in healthy and
                                                  non-healthy lungs                                                                                                                                                77


                                                  more strongly the tissue pressures around the airways. As a consequence, the amplitudes of the
                                                  oscillations of the airways walls decrease with the generations.
                                                      Regarding the wall shear stress, globally, we observe a constant pattern of the mean absolute
                                                  wall shear stress through the tree. We observe a trumpet-like shape as we sink in the tree similar
                                                  to the ones studied in the previous chapter. We recall that the wall shear stress applied by the
                                                  air on the mucus is related to the size of the airways and to the amount of airflow in the
                                                  airway. Moreover, the size of the branches from one generation to the next is reduced by a
                                                              ` ˘1
                                                  factor h “ 12 3 . Hence, with those assumptions, if the airflows were distributed equally in all
                                                  the branches of a single generation, the shear stress should decreases from one generation to the
                                                  next with a factor 2h1 3 “ 1, i.e. the shear stress should be constant through the generations,
                                                  see [124, 125]. In our case, the airflows are not distributed equally in the airways of a same
                                                  generation. However, the pressures jumps between the Ai regions are small relatively to the
                                                  pressure itself. That indicates that the amplitude pressures in the terminal bronchi are quite
                                                  similar.
                                                      Nevertheless, the airways that are closer to the boundary x “ 0, where the stress is applied,
                                                  feel a stronger tissue pressure than the other airways, hence, they are submitted to larger stresses
                                                  than the airways near x “ L.
                                                      Considering the two stresses, our model predicts that the idealized HFCWO therapy submits
                                                  the mucus to a stress of about a hundredth of pascal, namely one to ten percent of the yield
                                                  stress necessary for the mucus to move. However, our model produces more qualitative results
                                                  than quantitative. The amount of stresses here have to be taken in the limitations of the model.
                                                  Moreover, this suggests that once the mucus located in distal bronchi starts to move, the larger
                                                  stress in the proximal airways should facilitate its flow to the outside.

                                                                                                                                                                    2.405e-05
stress in the mucus averaged over one cycle




                                                                                                                     stress in the mucus averaged over one cycle




                                               5e-05
  per unit of stress applied at the boundary




                                                                                                                       per unit of stress applied at the boundary




                                                                                                                                                                      2.4e-05

                                               4e-05
                                                                                                                                                                    2.395e-05


                                               3e-05
                                                                                                                                                                     2.39e-05



                                               2e-05                                                                                                                2.385e-05


                                                                                                                                                                     2.38e-05
                                               1e-05       0    Distance of the   L
                                                               airways from


                                                       0             1            2      3       4       5   6   7                                                              0   1   2       3     4        5   6    7
                                                                                      generation index                                                                                      generation index


                                                  Figure 3.3: Absolute mean of the air wall shear stress (cross-shaped cold-color points) and of the
                                                  stress due to airways wall oscillations (circle-shaped hot-color points). The mean is computed
                                                  over the duration of one HFCWO cycle at the optimal frequency fo “ 6.6Hz, for all the bronchi
                                                  of the eight generations tree. We display the stress per unit of the pressure applied by HFCWO
                                                  (A). The color corresponds to the location of the corresponding airway in r0, Ls. This location
                                                  is computed as the mean position of the Ai fed by the airway. For example, the root of the tree
                                                  is feeding all the Ai and its mean position is L{2; the two branches of the second generation are
                                                  located at L{4 and 3L{4, and so on.



                                                  3.3.3                  Airflows at mouth induced by HFCWO for the range of healthy lungs
                                                                         resistances
                                                  In our model, the quality factor for the healthy lungs model is too low to allow resonance.
                                                  Nevertheless, we have seen that the fundamental pulsation of the material that mimics the


         78                                                                        Mechanics of the lungs and optimization of HFCWO


lung’s parenchyma still maximizes the airflows at mouth in the idealized HFCWO. However, we
observed that a wide range of frequencies from 3 to 20 Hz around the fundamental frequency
(6.5 Hz) is within 1 % of the maximum. Hence, the damping is high but not high enough to
prevent the existence of a maximum. We wonder here what happens to the airflows at mouth
for healthy lungs with different resistances, from 0.5 cmH2 O.s.L´1 to 4 cmH2 O.s.L´1 . This
range represents the range of healthy lungs resistance [87]. We use the same configuration of
parameters than in the previous subsections and we change only the corrective factor for the
resistance of the tree. We use three equivalent resistances : 0.5, 1.5 or 4 cmH2 O.s.L´1 .
    First of all, the figure 3.4 shows that for all cases the mean air flows are maximised at the
fundamental natural frequencies. However, we clearly distinguish that the higher the damping,
the lesser is the amplitude of the air flow. In addition, we observe that the width of the
optimal range of frequencies within 1% of the maximum increases as the dissipating action of
the tree increases. This indicates that the greater the damping, the more homogeneous are the
amplitudes of the mean air flow for the different frequencies. If the resistance is high enough,
the mean air flows are very close whatever the working frequency of the HFCWO pressures.
  standardized average flow (mL/s)




                                      1                [                ]                            0.335
                                                                                                      0.33
                                                                                                                 [                                      ]
                                     0.8                                                             0.325
                                                                                                      0.32
                                     0.6
                                                                                                                      5         10            15        20

                                     0.4
                                               [                                               ]    0.1255
                                                                                                             [                                          ]
                                                                                                     0.125
                                     0.2
                                           [                                                   ]    0.1245

                                      0                                                              0.124
                                                           5            10        15           20                     5         10            15        20
                                                                frequency (Hz)                                            frequency (Hz)

                                                                             -1                                  -1                                -1
                                                   R       = 0.5 cmH O.s.L               R     = 1.5 cmH O.s.L              R      = 4 cmH O.s.L
                                                    eq              2                     eq            2                     eq          2

                                                   fundamental natural frequency       [ ] 1% around maximum

Figure 3.4: Mean air flow according to the frequency of the applied constraint (from 1Hz to
20Hz) for different resistances of the lungs in the range of healthy lungs resistance (0.5, 1.5 and
4 cmH2 O.s.L´1 ) with detailed plots (right). The mean air flow are divided by the maximum
mean air flow produced with the smallest resistance of the lungs (0.5 cmH2 O.s.L´1 ). The
black-dashed line displays the fundamental natural frequency (» 6.6Hz) and the colored square
brackets show the respective range of frequencies for a mean flow within a range of 1% of the
maximum.



3.3.4                                          Idealized HFCWO for non-healthy lungs models
The previous subsections show that for equivalent resistances of the lungs above 1.5 cmH2 O.s.L´1 ,
the airflows at mouth induced by the idealized HFCWO are too damped to be significantly max-
imised at a given frequency. This threshold value of the resistance corresponds to the critical
quality factor of Q “ 0.048. The table 3.2 shows that the computed values of the Q-factor for
the non-healthy lungs model is strictly above this critical quality factor. In the limits of the
hypothesis of our model, the quality factor applied to the lungs suggests that the induced air
flows in the airways have a tendency to be constant for any frequency of HFCWO. We will see
in the next section that the HFCWO device could be used as an non-invasive tool to measure
resistance and compliance of the lungs.
    However, we recall that the data used in the numerical simulations are either taken or inspired


Modelling the High Frequency Chest Wall Oscillation in healthy and
non-healthy lungs                                                                            79


from the literature and they constitute averaged values. For example the resistance of the lungs
we used to mimick lungs resistance of CF patients is taken from a population of 32 people aged
fourteen in average or the Young’s modulus of the lung’s parenchyma of non-healthy lungs is set
arbitrarily and comparatively from the literature and from the value of the Young’s modulus of
healthy lungs. Nevertheless, the limitations of the model does not allow us to conclude that no
frequency can maximize the effect of the HFCWO. The fundamental frequency might still be an
interesting data for HFCWO, even for non-healthy lungs. In that way, from the data given in
the appendix 2.E, we gather, in table 3.3, resonance frequencies for the healthy and non-healthy
lungs suggested by the model.

                                              Healthy lungs      Non-healthy lungs model
                                                 model           Asthma   COPD         CF
    Resonance frequency (Hz)             fo        6.5            6.5       4.6        9.1

Table 3.3: Values of the resonance frequency of the healthy and non-healthy lungs model from
the set of parameters displayed in the appendix 2.E, in the limit of our model.


3.3.5   Estimation of the operational hydrodynamic resistance of the airway
        tree from HFCWO mouth airflow
Actually, with the model, we can derive the measurements of the resistance and the compliance
of the lungs from HFCWO. This subsection propose the way to assess, in the limits of the model,
the resistance of the lungs. The next subsection 3.3.6 proposes the way to assess the compliance
of the lungs.
    We define the operational hydrodynamic resistance Rop of the airway tree according to a
distribution of the air flows at the terminal branches given by Frus9 and to the total air flow in
the tree root (mouth air flow) given by Fm “ t JFrus,9
                                     żT                Nż T
                              Rop “     t
                                          FrusRFr
                                            9     usdt
                                                  9         Fm2
                                                                ptqdt                       (3.16)
                                     0                       0

The operational resistance reflects the resistance of the regions of the airway tree where there is
an actual air flow. Moreover, the influence of the regions is weighted according to the relative
amount of airflows that they receive. The regions where no airflow occurs are not accounted for
in that resistance. Hence, Rop is in general an overestimation of the equivalent hydrodynamic
resistance of the whole tree. In the case where the pressures at each terminal branches of the tree
are similar, then the operational resistance is close to the equivalent hydrodynamic resistance
Req of the tree.
    Coming back to our model of the lung, if we consider the balance of energy of the system
of equations (3.8) over a cycle when the periodic regime is reached, then the energy dissipated
during one cycle is equal to the amount of energy put in the system by the boundary x “ 0.
This balance is detailed in the appendix 3.E and can be summarized as
                              żT                   żT
                                  τ ptqFm ptq dt “    t
                                                        FrusRFr
                                                          9      9 dt
                                                                 us                          (3.17)
                              0                    0

The relationship (3.17) allows to estimate the operational resistance of a HFCWO maneuver if
the applied signal τ ptq is known, if the total air flow Fm ptq through the tree (i.e. the mouth
airflow) is measured and if a periodic ventilation regime has been reached:
                                      żT              Nż T
                               Rop “     τ ptqFm ptqdt     Fm 2
                                                                ptqdt                      (3.18)
                                         0               0

We showed earlier that in our idealised HFCWO maneuvers, the pressure jumps between the
Ai compartments are small relatively to the pressure itself, indicating that the pressures at


  80                                Mechanics of the lungs and optimization of HFCWO


the terminal branches are almost similar in amplitude. Hence, the operational resistance is a
good approximation of the equivalent resistance of the tree in the case of the idealised HFCWO
maneuvers. Our numerical simulations confirms that during idealised HFCWO maneuvers, we
have Rop » Req .
    Hence, the operational resistance might have interesting applications for evaluating the actual
resistance of the parts of the lung accessible to air flow, for evaluating the performance of a
HFCWO maneuver and for estimating the equivalent hydrodynamic resistance of the lung using
HFCWO.

3.3.6    Estimation of the compliance using the fundamental frequency
The results about the optimal frequency and its similarity with the fundamental frequency
suggest that HFCWO could be used to estimate the compliance of the lung of a patient by
searching for the device frequency that maximizes the air flow at mouth level. Since HFCWO
applies small and quick deformations on the lung, the lung’s response can reasonably be consid-
ered as mainly elastic and linear. Then, using the fact that the frequency found should be close
to the fundamental natural frequency of the lung in this elastic framework, we can derive the
elastic properties of the lung and determine the quantity pλ ` 2µq from which we can estimate
its compliance. Since our model is unidimensional, we can relate the compliance to the elastic
parameters by C » V {pλ ` 2µq with V “ SL L “ L3 the volume of our model of the lung. From
the expression of the fundamental frequency, we can then deduce that
                                                     1
                                                  V3
                                            C»                                               (3.19)
                                                 16ρfo2

with V the volume of the lung, ρ its density and fo » f1 the frequency that maximizes the
air flow at mouth level. This formula is derived from a unidimensional model and should be
considered with care and/or be validated with clinical data. However, this demonstrates that
HFCWO might be a potential tool for estimating the lung’s compliance based on the analysis
of the air flows at mouth level.


3.4     Discussions and conclusion
This chapter uses the coupled model developed in the previous chapter in order to suggest new
insights on the operating choices of HFCWO. Moreover it proposes models to evaluate the stress
felt by the mucus during our idealized HFCWO manipulations.

    Particularly, our model gives for the first time a physical estimation of the optimal range of
frequencies to be used by HFCWO, which is in scope of the working frequencies usually applied
to the patient during HFCWO maneuvers [96]. More specifically, we show that in the range of
optimal frequencies, the fundamental natural frequency of the lungs deduced from its physical
characteristic maximizes the efficiency of the HFCWO in term of mouth air flows. From the
data of the literature, our computed optimal frequency is similar to the resonance frequency of
the lungs observed in clinical studies that optimizes volume delivery [91, 75]. Moreover, as the
natural frequencies are defined from the characteristic of the lungs (size, density, stiffness), the
optimal frequency differs between individuals, particularly in the case of respiratory diseases. In
the frame of HFCWO, it underlines the significance of determining properly the properties of the
lungs in order to apply pressures on the patient’s thorax with frequency that could potentially
optimize the efficiency of the therapy. Moreover we observe that in this optimal range, HFCWO
can apply stress to healthy mucus to about one to ten percent of the estimated yield stress that
has to be overcome for the mucus to flow. Last but not least, in our model, the analysis of the
mouth air flow during idealized HFCWO allows to estimate the hydrodynamic resistance and
the compliance of our model of the lung. This suggests that HFCWO might be a powerful non
invasive tool for helping the diagnosis of lung pathologies in the frame of personalized medicine.


Discussions and conclusion                                                                     81


However, we have seen that the efficiency of the HFCWO is driven by the intensity of the
damping of the tree and we proposed a way to deduce it.
    We propose a dimensionless formulation of the model ruled by two dimensionless variables
defined from the parameters of the model : E, the Euler number and B the inverse of the Cauchy
number. The Euler number compares the pressures forces induced by the viscous dissipation
of the air flow in the tree with inertial forces in the material while the inverse of the Cauchy
number compares the elastic forces in the material with the inertial forces. Through the equation
of the energies, we show that E and B mainly drive respectively the dissipating and the elastic
energies. We suggest, using a simplification of the model, the existence of a quality factor (Q-
factor) for the lungs, defined from the dimensionless parameters. The Q-factor indicates the
capacity of the lungs to resonate with external stimulations. More specifically, according to
the value of the Q-factor, the deformation of the lungs can be either maximized at a frequency
smaller or equal to the natural frequency for small damping, or not maximized at all, i.e. no
phenomenon of resonance occurs. Moreover, we observe that the air flows induced by HFCWO
are always maximized at the natural frequency whatever the damping. However, the intensity
of the damping drives quantitatively the produced air flow and the width of the range of optimal
frequencies around the optimal. Precisely, below a specific value of the quality factor, all the
operating frequencies of HFCWO induce similar mean air flows in the tree. In our case, this
corresponds to non-healthy lungs with resistances higher than usual.
    Our model predictions have to be interpreted in the limit of of the model hypotheses. Ac-
tually, as discussed in the previous chapter, it is based on a set of simplification hypotheses for
the geometry of the lung, the mechanics of the tissues and the air fluid dynamics. Typically,
to get correct flows and pressures when mimicking rest ventilation, a corrective factor for the
resistance was needed. Hence, our model can only represent the lung behavior in a qualitative
way. Moreover, the predictions of our model are based on averaged biological and mechani-
cal parameters. Those variables are submitted to inter-individual variations, typically for the
pulmonary resistance or the compliance, they are affected by the age, the gender, etc. Such
variability should be accounted for in future works.
    In addition, a simplification was made concerning the physics of the system, for the sake of
tractability. Actually, the dimensionless parameter E is built from the equivalent hydrodynamic
resistance of the tree. Hence, it captures only the global influence of the dissipation of the
energy by viscous effects in the tree. Thus some changes in the tree configuration can be missed
as soon as the equivalent hydrodynamic resistance is not affected by the geometrical change.
To get a more fine description of the dynamics linked to the viscous dissipation in the tree, we
can consider one dimensionless parameter per generation of the tree (symmetric bifurcating)
or per branch of the tree (asymmetric bifurcating), see the appendix 3.B. This improvement
would allow to catch any influence of local changes in the tree, such as localized constrictions.
However, this would lead to a large number of dimensionless parameters, more than a hundred
thousand for a 17th generation tree, and would break the tractability of the model and its
potential applicability to medicine.
    Finally, the definition of the quality factor has used carefully. Indeed, it is deduced from
an idealized and simplified formulation of our continuous coupled model. It does not take
into consideration all the full spatial occupation of the lungs. Hence, it has to be interpreted
qualitatively, and comparatively from averaged data.
    Nevertheless, our model is able to successfully mimic physiological behaviors of the lungs, as
the rest ventilation, and to capture the interactions between the tissue mechanics and the air
flow in the airways.The two dimensionless parameters B and E allow to highlight the relative
influence of the elasticity and of the dissipation, depending on the physiological parameters and
on how the idealised lung is ventilated. In its limits, the model proposes different tools to suggest
optimal working parameters to be used by HFCWO devices. The results predicted by our model
have to be validated by clinical data.


82   Mechanics of the lungs and optimization of HFCWO




     Appendices


Behaviors of the solution according to the dimensionless parameters                           83


3.A     Behaviors of the solution according to the dimensionless
        parameters
The dimensionless equation (3.7) can be decomposed according to the physical role of its different
terms:
     ż1
           B 2 ũ
                      ˆ                  ˆ „ ˙˙
                           Bũ                 Bũ      Bw
               2
                  w` B         ´ E p̃tree F̃               dy ´ B   τ̃ psq wp0q “ 0         (3.20)
       0 looBs
             moon                              Bs
                           Byon loooooooooomoooooooooon
                        loomo                           By       loomoon
                                                                            boundary force
        acceleration     elasticity       damping



   All of the following possibilities have been simulated numerically, the results agree with the
theory.

    High frequencies. The system is driven only through the acceleration term, namely the
parameters B and E are negligible compared to the prefactor 1. This situation occurs if the
system works with high enough frequencies : the characteristic time is then low. It could also
appear for a very dense and soft material associated to a poor resistive tree. The equation (3.7)
can be expressed as
                                        ż 2
                                            B ũ
                                               2
                                                 wdy “ 0
                                         Ω̃ Bs
   The solutions of the previous equation is, with c1 and c2 , two space-dependant constants in
time :

                                      ũpy, sq “ c1 pyqs ` c2 pyq
   The two constants are determined with the initial conditions.

  • With zero initial condition on displacement or velocity, the solution is equal to zero.

  • The constant c2 is obtained with the initial condition on the displacements. The solution
    stays constant through time if the initial condition on the velocity is zero.

  • The constant c1 is calculated with the initial condition on the velocity and the solution
    converges to plus or minus infinity according to c1 values.

    Low frequencies. In this case, the elastic term and the driving force are the only acting
terms in the system, i.e the parameter B is dominant compared to E and the prefactor 1 which
drives the acceleration term. This situation particularly happens when the characteristic time
is high (low characteristic frequency). It could also occurs for very stiff material or if the
characteristic length is small. The associated equation is :
                             ż                   ż
                                  Bũ Bw
                                B        dy ´ B        τ̃ psqw dy “ 0
                              Ω̃ By By             Γ̃1
                                                 loooooomoooooon
                                                    “τ̃ psqwp0q (1D case)

    The velocity of propagation of the deformation in this case is very high as well as the angular
eigenfrequencies. The amplitude of displacement is linear in space as we put a zero-displacement
on the frontier Γ2 . The equation can be assimilated to the Poisson’s equation with one dimension.
    A highly resistive tree. In this case, the values of E is large compared to B and the
prefactor 1. This situation is related to a highly resistive tree or a very long material (L ąą 1).
In that case, the terms of stiffness, mass and boundary force can be neglected and the equation
(3.7) is written :
                                  ż           ˆ „ ˙
                                                  Bũ   Bw
                                      E p̃tree F̃            dy “ 0
                                   Ω̃             Bs     By


  84                               Mechanics of the lungs and optimization of HFCWO


    This situation implies that either the solution is constant in time or that the mean flows are
nulls. If zero-initial condition on the displacement or the velocity is applied, the solution stays
null. Otherwise, this is the the mean flow due to the displacement that is equal to zero.

   A low resistive tree. The variable E is considered small relatively to B and the prefactor
1. This situation occurs for a low resistive tree. The equation (3.7) is rewritten as :

                                        1 Bũ Bw         1
                         ż ˆ 2               ˙
                              B ũ
                                 2
                                   w`               dy ´   τ̃ psqwp0q “ 0
                          Ω̃  Bs       C By By           C
    As explained in the appendix 2.C, solving equation (3.7) comes down to solve the wave
equation with a system of ordinary differential equation.
    The material reacts to the boundary conditions and to the initial condition. With the
Neumann boundary condition on y “ 0 and the zero initial condition on displacement (and
velocity), we observe a typical deformation wave propagating trough the material presented,
see figure 2.3. Without any boundary conditions, the solution is zero unless there is an initial
condition on the displacement or on the velocity. Then, the material deformation only responds
to elastic properties (there is not damping effect), the deformation propagates endlessly with a
velocity associated to the material stiffness.

    A soft material.
    The parameter B is considered negligible compared to the other terms of the equation. This
corresponds to a very soft material (for example a foam or a fluid). The equation (3.7) becomes:
                           ż 2          ˆ        ˆ „ ˙˙
                               B ũ                  Bũ   Bw
                                  2
                                    w `  E p̃tree F̃            dy “ 0
                            Ω̃ Bs                    Bs     By
   Without the term of elasticity, the material is not deformed at all space points, but only at
the frontier of the Ai depending on the initial and boundary conditions.

    A very stiff material with a very resistive tree.
    It is equivalent to a low density material. Both parameters B and E are considered dominant
in the equation.
                 ż ˆ                  ˆ „ ˙˙                 ż
                        Bũ               Bũ    Bw
                      B     ` E p̃tree F̃            dy ´ B         τ̃ psqw dy “ 0
                  Ω̃    By                Bs      By            Γ̃1
                                                              loooooomoooooon
                                                             “τ̃ psqwp0q (1D case)

    The term of the first derivative in time of the displacement is only defined locally on the
boundaries of the subareas Ai . We analyse this case with a numerical simulation. It shows that
for zero-initial condition on displacement and velocity and with the boundary conditions used
in the non-physiological case 2.4.1 of the previous chapter , the solution is piecewise-continuous,
in particular it is discontinuous at the boundaries of the Ai . Moreover the amplitude of the
solution is close to zero.


3.B     Extension of the definition of the dimensionless parameter
        E
3.B.1    Numerical simulation
The dimensionless parameter E is not able to discriminate between all the trees, as two different
trees can have the same hydrodynamic resistance but not the same branches. To illustrate
this phenomenon, we run two similar numerical simulations with the same E, but with two
different trees. We chose the resistance matrices R so that they are different but with the
same equivalent resistance and consequently the same B and E. Hence, one tree branches
symmetrically, i.e. a mother branch divides into two daughters branches of same size. The


Extension of the definition of the dimensionless parameter E                                         85


other tree branches asymmetrically, i.e. the size of the daughters branches have not the same
size. We call R11 and R12 the hydrodynamic resistance of the two airways in the generation 2.
The airway with resistance R1i feeds the set Ai (i “ 1, 2). The asymmetric bifurcating tree is
related to the symmetric tree by a decrease by a factor 100 of the hydrodynamic resistance of
one of the branch of generation 2, i.e. R11 “ R1 {100, and an increase by the same factor of the
hydrodynamic resistance of the other branch, i.e. R12 “ 100 R1 –, see Figure 3.4. We keep r0 “ 1
cm and l0 “ 6 cm to define the hydrodynamic resistance R0 of the root branch. The values of
the dimensionless parameters are B “ 1 and E “ 1. We use the same boundary conditions as
the section 2.4 and a zero initial condition on displacement and velocity.




 (a) 2 generations tree structure with symmetric bi-   (b) 2 generations tree structure with asymmetric bi-
 furcations. We set R1 “ 2R0 .                         furcations. We set R11 “ R1 {100 and R12 “ 100R1 .
                                                                     ¨                               ˛
                ¨                         ˛                              R 0 ` R11        R0
                    R0 ` R1
                    looomooon     R0                                     loooomoooon
                                                                  ˚       p1.02qR0
                                                                                                     ‹
            ˚         3R0
                                          ‹                     R“˚                                  ‹
          R“˚                             ‹                       ˝         R0         R 0 ` R12
                                                                                                     ‚
            ˝          R0       R0 ` R1 ‚
                                looomooon                                              loooomoooon
                                                                                         201R0
                                  3R0

                                                            (d) Resistance matrix for the 2 generations
      (c) Resistance matrix for the 2 generations
                                                            tree structure with asymmetric bifurca-
      tree structure with symmetric bifurcations
                                                            tions : R11 “ R1 {100 and R12 “ 100R1 .

Table 3.4: Two different tree structures with the same equivalent resistance and parameters B
and E, but with different resistance matrices. On the left is displayed a symmetric bifurcations
tree structure (a) with the corresponding resistance matrix (c). On the right, is displayed a
asymmetric bifurcating tree structure (b) with the corresponding resistance matrix (d).




    The Figure 3.5 shows the material displacement for the two cases. Since A2 is connected
to the more resistive branch in the asymmetric case, the displacements in A2 are lower in the
asymmetric case than in the symmetric case. This example shows that the local contribution of
the resistance of each branch of the tree is not accounted for in the dimensionless formulation
based on E and B. This choice allows however to keep the physics of the system tractable and to
connect more easily with clinical measures which often reflect global behaviors of the pulmonary
system.


  86                                         Mechanics of the lungs and optimization of HFCWO




Figure 3.5: Propagation of wave deformation of a two generations symmetric bifurcating tree
(black cross) and a two generations asymmetric bifurcating (red circle) tree at time s “ 13 (a),
s “ 12 (b), s “ 32 (c). For the two cases above, the parameters B and E are equal.


3.B.2    Alternative definition of the dimensionless parameter E
The definitions of the dimensionless parameter E “ eqρv L in Table 3.1 is based on the equivalent
                                                                     R S

hydrodynamic resistance of the tree Req only. This approach is not able to distinguish the
dynamics induced by two different trees with the same hydrodynamic resistance. Hence, we
propose alternative definitions of the dimensionless parameters.
   In the case of a symmetric bifurcating tree, one dimensionless variable Ei can be defined for
each generation i of the tree. In this case, all the branches belonging to the generation i have
the same hydrodynamic resistance Ri . The dimensionless weak formulation is then
                 ż1 2        ˆ               ˙               ż
                     B ũ        Bũ            Bw
                        2
                          w` B          n
                                     ` E F̃T        dy ´ B         τ̃ psqw dy “ 0          (3.21)
                   0 Bs          By             By             Γ̃1
                                                             loooooomoooooon
                                                                             “τ̃ psqwp0q (1D case)


with E n “    i“0 Ei ,                                and for i “ 0, . . . , n,
             řn                  řN         “ Bũ ‰
                         F̃T “    i“1 F̃i     Bs

                                                                   Ri
                                                       Ei “ 2n´i       E
                                                                   Req

   Similarly, in the case of a tree with non symmetric bifurcations, all the branches of the tree
can be different and one dimensionless number E can be defined for each branch. Hence, the
number of dimensionless parameters E would equal the number of branches in the tree, i.e.
2n`1 ´ 1 if the tree has n ` 1 generations. The dimensionless number Eb associated to a branch
b belonging to the generation i and with a hydrodynamic resistance Rb would then be
                                                                   Rb
                                                       Eb “ 2n´i       E
                                                                   Req

   It is important to adapt the number of dimensionless parameters to the problem in order to
keep some tractability in the study.


3.C     A one degree of freedom equation.
This appendix deals with the one degree of freedom simplification of the equation of the coupled
model using the dimensional and discretized expression (2.18). It allows to verify the definition
of the Q-factor obtained in the subsection 3.2.2 using the dimensionless equation.

   The dimensional and discretized equation of our coupled model, obtained with the finite
element method in 2.B, is :

                                     d2             dU ptq
                                 M      2
                                          U ptq ` D        ` KU ptq “ τ ptqh
                                     dt              dt


Estimation of the stress in the mucus layer induced by the airway walls
oscillations                                                                                87


          : “ dU9 “ d2 U2 , and with M , D and K respectively the mass, the damping and the
     with U     dt    dt
stiffness matrices and with h the vector of loads. The damping D is defined as D “ S t GRG,
with S a characteristic surface. For two degrees of freedom this equation becomes
          ˆ        ˙ˆ ˙ ˆ         ˙ˆ ˙ ˆ           ˙ˆ ˙    ˆ ˙
           M11 M12   :1
                     U    D11 D12   U9 1   K11 K12   U1     h1
                        `                `              “τ
           M21 M22   :
                     U2   D21 D22    9
                                    U2     K21 K22   U2     0

   Particularly, the damping matrix D is written as
                          ˆ        ˙            ˆ        ˙ˆ ˙
                           D11 D12      `      ˘ R11 R12   G1
                                     “ S G1 G2
                           D21 D22               R21 R22   G2

    Considering only a one generation tree, the coefficients of the resistance matrix are equal to
r0 as well as the equivalent resistance Req . With the homogeneous Dirichlet condition in x “ L,
the second element of the vector U is null (U2 “ 0). Finally we have :

                              M11 U:1 ` D11 U91 ` K11 U1 “ h1 τ                            (3.22)

   With the dimensional formulation and with two degrees of freedom, the elements of the
matrices and of the vector are equal to
                      $
                      ’                              ρL
                      ’
                      ’
                      ’                     M11 “     3
                      ’
                      ’
                      ’
                      ’                            pλ`2µq
                                           K11 “
                      ’
                      &
                                                     L

                                          h1 “ 1
                      ’
                      ’
                      ’
                      ’
                      ’
                      ’
                      ’
                      ’
                      % D11 “ S G1 R11 G1 “ S p´1qR11 p´1q “ S R11
                      ’


   Setting u “ U1 , S “ L2 , and with Req “ r0 , the equation (3.22) becomes :

                                   3Req L      3pλ ` 2µq      3
                             u
                             : `          u9 `       2
                                                         u “    τ
                                     ρ            ρL         ρL
   We relate on parameters with those of the harmonic oscillator :

                                3Req L                         3pλ ` 2µq
                            2ξ “          and          ω02 “
                                   ρ                              ρL2
                                     b
   Finally the Q-factor is, with c “ pλ`2µq
                                        ρ   :
                                                  ?
                                          ω0    cρ 3
                                       Q“    “
                                          2ξ   3Req L2


3.D     Estimation of the stress in the mucus layer induced by the
        airway walls oscillations
The airway walls are oscillating due to the oscillation of their transmural pressure. In order to
estimate the stress applied on the mucus by the oscillations of the airway walls, we have first to
determine the response of the airways radius to the changes in transmural pressure. We assume
that the airways wall behaves as a circular spring [85]. Then, we compute the stress in the mucus
assuming that the mucus remains solid and behaves as a linear elastic material. The hypotheses
of linear elasticity are justified by the small amplitudes of the oscillations applied by HFCWO.


  88                                        Mechanics of the lungs and optimization of HFCWO


3.D.1      Estimation of the evolution of the airways radii
As HFCWO devices apply small deformations to the lung, we model the walls of the airways
in the same way as in [85]. Hence, we assume that the airway wall reacts as a spring that
remains circular. We consider an airway with a rest radius r0 and with a constant length l0 .
As in [113, 85], we assume the airway wall to have a thickness w0 “ 52 r0 , a Young’s modulus
Eb “ 6250 Pa, a Poisson ratio νb “ 0.5 (incompressible material) and a density ρb “ 1000
kg.m´3 . We consider cylindrical coordinates pr, θ, zq adjusted to the cylindrical geometry of the
airway: r corresponds to the radial position, θ to the angular position and z to the axial position.
The corresponding basis vectors are denoted er , eθ and ez . Assuming that the cylindrical airway
has a radius r, we consider a part of its wall with an angular width of dθ located at the angular
position θ. Applying the Newton’s second law to that segment leads to

                  d2 r
     dθ w0 l0 ρb 2 er pθq “ tprq
   rlooooomooooon                  l0 eθ pθq ´ tprq l0 eθ pθ ` dθq ` rloooooooooooooooomoooooooooooooooon
                                                                        dθ l0 ppa ptq ´ pt ptqq er pθq      (3.23)
                  dt
                  loooomoooon looooooooooooooooooomooooooooooooooooooon
         mass                                   elastic force                    pressures forces
                 acceleration

where:

  • The function r Ñ tprq is the lineic tension due to the elongation of the wall, tprq “
       Eb
    ´ 1´ν     r´r0
          2 w0 r
                0
                   , see more details in [85].
            b


  • The pressure in the tissue pt ptq is computed using the trace of the stress tensor σpuq in
    the respiratory zone, see equation (2.8),

                                               Trpσpuqpt, xqq dx
                                           ş 1
                                   pt ptq “ Q n ş
                                                  Q 1 dx

       with n the spatial dimension and Q the set defined as the union of the Ai fed by the airway
       studied. For example, the tissue pressure in the first generation airway is the mean of the
       tissue pressures computed on all the Ai as this airway is feeding all the tissue, i.e. Q “ Ω.
       With n “ 1, we can rewrite the pressure in the tissue as

                                            pλ ` 2µq du
                                         ş
                                                                   9 dx
                                                        ´ ptree pFrusq
                                 pt ptq “ Q          dx

                                                      Q 1 dx
                                                     ş


  • The air pressure in the airway pa ptq results from the air fluid dynamics in the tree. It is
    approximated by the mean air pressure in the airway, which is computed using the linear
    relationships between the air flows and pressures in the tree, see equation (2.1). More
    precisely, we define the set I of the indexes of the airways that are on the path starting
    from the root of the tree and ending at the airway studied. For i P I, we denote Ri is
    the hydrodynamic resistance of the airway with index i and φi the airflow in that same
    airway; the quantity Ri φi is the pressure drop in the airway i. Finally, denoting Rb the
    hydrodynamic resistance of the airway studied and φb the airflow in that same airway, we
    have                                    ˜              ¸
                                             ÿ                Rb
                                 pa ptq “ ´       Ri φi ptq `    φb ptq
                                              iPI
                                                              2
       where the first term computes the pressure at the end of the airway studied and the second
       term is a correction to get the pressure in the middle of that airway.


   Using the relationship eθ pθq ´ eθ pθ ` dθq “ er pθqdθ, projecting the equation (3.23) on er and
simplifying, we obtain

                                        d2 r    w0 Eb r ´ r0
                                w0 ρb        “´              ` ppa ptq ´ pt ptqq                            (3.24)
                                        dt 2    r0 1 ´ νb2 r


Estimation of the stress in the mucus layer induced by the airway walls
oscillations                                                                                         89


    Then, rewriting the equation (3.24) in a dimensionless form allows to compare the different
influences of acceleration, elasticity and pressures:
                ρb r02 p1 ´ νb2 q d2 r̃        1             r0 P p1 ´ νb2 q
                                        “ ´1 ˆ    pr̃ ´ 1q `                   pp̃a psq ´ p̃t psqq
                     Eb T 2
                loooooomoooooon   ds2          r̃            w0       Eb
                                                             looooooomooooooon
                      N                                              M

using s “ t{T , r̃psq “ rpsT q{r0 , p̃˚ psq “ p˚ psT q{P with ˚ “ a or t. T is the characteristic time of
the oscillations, i.e. their period; at the optimal configuration (see figure 3.2), T “ 0.05 s. P is
the order of magnitude of the pressure, typically the pressure applied on the boundary, reflected
by the variable A, hence we chose P “ A “ 200 Pa. Finally, we can estimate the dimensionless
                ρ r2 p1´ν 2 q               P p1´ν 2 q
numbers N “ b E0 b T 2 b and M “ wr00 Eb b at the optimal configuration,

                            N ď N|r0 “1cm “ 5.1 10´4 and M “ 6.0 10´2

Consequently, the acceleration is small relatively to the elastic term (N ăă 1) and we can assume
at first approximation a static equilibrium between the elastic forces and the pressure forces.
Notice that N decreases when the generation index increases since the radii of the airways are
decreasing with the generation index. Hence, the approximation N ăă 1 is better for the small
airways. The number M is also quite small relatively to 1, indicating that the displacements
due to the pressures are also small, in agreement with the linear elasticity approximation.
    Solving the static equation leads to r̃psq “ p1 ´ M pp̃a psq ´ p̃t psqq´1 . Considering M ăă 1,
we can go further in the approximation, and r̃psq » 1 ` M pp̃a psq ´ p̃t psqq. Equivalently, using
dimensional variables and replacing νb with 1{2, we can finally reach an expression for rptq:
                                                            3 r0 pa ptq ´ pt ptq
                                                       ˆ                         ˙
                                    r0
                     rptq “                        » r0 1 `
                            1 ´ 3 r0 pa ptq´pt ptq          4 w0       Eb
                                    4 w0      Eb

     The determination of the evolution of the radius relatively to that of the transmural pressure
pa ptq ´ pt ptq allows to compute in the next section the resulting stress in the mucus.

3.D.2     Estimation of the stress in the mucus layer
The way the radius evolves with time induces a tangential strain on the interface between the
                                               r0 . This tangential strain propagates into the
mucus and the airway wall, θ pr0 , θ, zq “ rptq´r 0


mucus at a characteristic velocity c “ Em {ρm where Em is the Young’s modulus of the mucus
                                       a

and ρm its density. In an healthy mucus layer, Em » 1 Pa and ρm » 1000 kg.m´3 [70] and
we can estimate that c » 3 cm.s´1 . Since the typical thickness of the mucus layer is about
10 µm [59], the wave propagates through the depth of the mucus in less than 0.5 ms. Hence,
the strain on the mucus wall represents well the strain inside the mucus layer at the time scale
of HFCWO. At the position pr, θ, zq the strain in the mucus layer is then θ pr, θ, zq “ rptq´r
                                                                                            r0 .
                                                                                                0

The mucus is an incompressible material, hence the trace of the strain operator is zero and
θ “ ´r since we assume z “ 0. Finally, based on these hypotheses and on the linear elasticity
in cylindrical coordinates states that
                                r “ p1 ` νm q pp1 ´ νm qσr ´ νm σθ q {Em
                                θ “ p1 ` νm q pp1 ´ νm qσθ ´ νσr q {Em

Then, using r “ ´θ , we have σ˚ “ 1`ν
                                      Em
                                         m
                                           ˚ with ˚ “ r or θ. Making the mucus Poisson’s ratio
νm going to 0.5 since the mucus is incompressible, the norm of the stress in the thin layer of
mucus on the wall of the airway can be estimated with
                              2    ˇ rptq ´ r0 ˇ 1 r0 Em
                                   ˇ           ˇ
                        σptq “ Em ˇ            ˇ 2 w0 Eb |pa ptq ´ pt ptq|
                                               ˇ»
                              3
                                   ˇ
                                        r0
    The stress induced in the mucus by airways wall oscillations is then compared to the yield
stress of the mucus, see main text.


   90                                     Mechanics of the lungs and optimization of HFCWO


3.E       Operational resistance
We consider the dimensionless energy conservation in our model, see equation (3.8). and use the
                                                                                       ş1 B2 ũ
fact that the total air flow through the tree is F̃m psq “ t J F̃ “ N          B ũ
                                                                   ř
                                                                     i“1 F̃i r Bs s “ ´ 0 ByBs py, sqdy “

 Bs p0, sq ´ Bs p1, sq “ Bs p0, sq. Hence, we can rewrite the dimensionless energy conservation,
B ũ         B ũ         B ũ

           ˜ ż ˆ                                       ˙2 ¸
        d 1 1 Bũ                       1 1 Bũ
                               ˙2         ż ˆ
                                                                                        R
                        py, sq dy ` B            py, sq dy “ Bτ̃ psqF̃m psq ´ E t F̃        F̃      (3.25)
       ds 2 0 Bs                        2 0 By                                         Req

since t F̃r BBsũ s RReq F̃r BBsũ s “ ´ N i“1 p̃i pF̃r Bs sqF̃i r Bs s. Now, if we assume that the system is periodic
                                                        B ũ       B ũ
                                         ř
with a period 1, then integrating the previous equation over a cycle and going back to dimensional
variables lead to
   ż1                                                                       żT                    żT
                                     LM 1 t Bũ
                                         ż
                                                              Bũ                                    t
       τ̃ psqF̃m psq ds “                    F̃r sRF̃r s ds Ñ                    τ ptqFm ptq dt “      FrusRFr
                                                                                                         9     9 dt
                                                                                                              us
    0                                R eq 0        Bs         Bs              0                    0
                                                                                                                (3.26)

We define now the operational hydrodynamic resistance of the airway tree
                                                    şT   t FrusRFr
                                                             9    usdt
                                                                   9
                                            Rop “    0
                                                         şT                                                   (3.27)
                                                               2 ptqdt
                                                              Fm
                                                          0

When the pressures are all identical in the terminal branches of the tree, then we have t FrusRFr
                                                                                            9     usdt
                                                                                                   9   “
Req Fm2 . In that case, R   “ R    . More  generally, R   is the equivalent  resistance of the parts
                         op     eq                     op
of the tree where the air flows occur, weighted by the relative values of the airflows. Hence, the
value of Rop ranges from the value of the equivalent resistance of the most resistive path between
the root of the tree and the terminal branches, and the value of the equivalent resistance of the
tree. In the quasi-fractal model with n ` 1 generations, Rop ranges from R0 ` R1 `ř... ` Rn
(hydrodynamic resistance of a path from generation 0 and n, all identical) and Req “ ni“0 R2ii .


Chapter      4
Towards the improvement of the
model of the lungs



      "[...] ; ce qui ne demande point de preuve, c’est-à-dire, que l’air est la cause de tous les
  mouvements des animaux, [...] de sorte que l’air est le premier mobile dans les animaux, &
 qu’on peut l’appeler le principe de la vie, & qu’on peut dire avec fondement que c’est dans ce
                         sens, que l’Ecriture l’a appelé l’air de la vie."
                                                                           Joseph-Etienne Bertier,
        Dissertation sur cette question si l’air de la respiration passe dans le sang, 1739, p.95.




Contents
       4.1    Introduction      . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .     92
       4.2    Hypotheses of the model . . . . . . . . . . . . . . . . . . . . . . . . . .             92
             4.2.1   Assumptions of the tree region . . . . . . . . . . . . . . . . . . . . . . .     92
             4.2.2   Assumptions about the lung’s parenchyma . . . . . . . . . . . . . . . . .        93
             4.2.3   To an enhanced model of the mucus . . . . . . . . . . . . . . . . . . . .        95
       4.3    Towards the modeling of the lungs with 3D geometries . . . . . . .                      96
             4.3.1   Three dimensional geometries of the lungs . . . . . . . . . . . . . . . . .      97
             4.3.2   Solving the 3D model using the finite element library deal.II      . . . . . .   98
             4.3.3   The splitting method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
       4.4    Investigation of the efficiency of a HFCWO device through a clinical
              study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
             4.4.1   Method and protocol . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
             4.4.2   Preliminary results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108
             4.4.3   On the perspectives of the clinical study . . . . . . . . . . . . . . . . . . 113


  92                                Towards the improvement of the model of the lungs


4.1       Introduction
The study of the model proposed in the previous chapters has been performed from an idealized
perspective with several hypothesis. The hypotheses simplify the model and its solving to
mimic the conductive pulmonary tree. We use for example an idealized tree geometry which is
dichotomous and symmetric. The flow of air inside the tree are also considered low to allow the
use of Poiseuille’s regime. Additionally, the composition of the lung’s parenchyma is mimicked
by an homogeneous media, although it is known that it is heteregeneous and composed of
numerous of air-filled alveoli. In parallel, we analyze mostly the one-dimensional formulation of
the model that produces mainly qualitative and comparative results. In this chapter, we discuss
the different hypotheses of the model and investigate the potential ways to improve it. Moreover,
we present the different methods leading to efficient multi-dimensional numerical simulations.
Finally, the setup of a clinical study to estimate experimentally the efficiency of a HFCWO
device is proposed and detailed.


4.2       Hypotheses of the model
With the aim of respecting the balance between precision and computational time, our model of
the lungs is based on several assumptions. The model is based on hypotheses for the dissipating
action of the tree structure mimicking the pulmonary tree, see subsection 4.2.1, and for the
physical properties of the lung’s parenchyma, see subsection 4.2.2. In addition, the 0D model
of the mucus used in the chapter 3 produces only comparative outputs and further adjustments
can be proposed to reach better estimations of the stress felt by the pulmonary secretions, see
subsection 4.2.3.

4.2.1     Assumptions of the tree region
It has been discussed that our model of the pulmonary tree is idealized and does not take into
account the oesopharyngeal pathway, the details of the geometry of the bifurcations, the inertial
effects of the air flow and the asymmetric branching [104, 105, 87]. That is the reason why, to
model real lungs behaviors, we used a corrective factor for the resistance of our tree structure
to get it closer to the physiological values of real resistances of the lungs. We notice that the
overall resistance of the lungs measured experimentally takes all those effects into account [87].
Actually, the resistance of the lungs corresponds to the resistance of the air pathway from the
ambient air to the exchange surface in the acinar region, and not the one of the tracheo-bronchial
tree only. Hence, in order to reduce the value of the corrective factor, i.e. to have a model of
the pulmonary tree which is closer to the reality, several hypotheses can be improved.

4.2.1.1    Considering circulation of air in the pulmonary tree
We model the pulmonary airways as rigid cylinders where the circulation of air follows the
steady-state Poiseuille’s regime. This type of flow is valid for low flow and when neglecting the
inertial effects in the fluid. Moreover, we do not take into account the complex geometry of the
bifurcations between the generations. Actually, as evoked in [109], the respiratory airways are
not longitudinal circular tracts, their section can vary. This can increase the overall resistance
of the pulmonary tree. In addition, while Poiseuille’s flow is a valid approximation for low flow
in cylindrical airways, i.e. HFCWO manipulation, it does not allow to determine properly the
air fluid dynamics in complex geometries (for example bifurcations [60]), non-cylindrical airways
constrictions or high flow breathing. Hence, the resistance can be flow dependant and account
for complex geometrical features. Inertial effects can appear, particularly in the upper airways
[134]. In that case, the hydrodynamic resistance is higher than Poiseuille’s : R “ Z Rpois , Z ě 1
[123]. We denote by Rpois the resistance of Poiseuille’s regime. We recall that it is defined in
a three-dimensional cylinder as Rpois “ 8πηl
                                           πr4
                                               , where η is the dynamic viscosity, and r and l the
respective radius and length of the pipe.


Hypotheses of the model                                                                        93


    HFCWO induces relatively low amplitude air flows compared to tidal breathing. The iner-
tial effects due to high flow may be limited to highly constricted airways, not in the scope of
this thesis. However, we could consider the non-linear resistance due to the geometry of the
bifurcations. The author in [123] describes different models found in the literature to deter-
mine the prefactor Z. In [104], it is proposed a model for the resistance based on experimental
measurement for symmetric bifurcations. The prefactor is denoted
                                                    c
                                                      Re
                                       ZP edley “ C      2r
                                                       l
    where C “ 0.327 and Re is the Reynolds number defined by Re “ 2ρ|φ|    νπr which denotes the
regime of the fluid. The higher the Reynolds number is, the higher are the inertial effects.
The model has been designed to inspiratory air flow as in [16] where asymmetric branching is
considered. Typically, in [16], they consider that, at a bifurcation, the mother branch opens on
one bigger and one smaller daugther branches. Hence, they defined two prefactors Z` (for the
bigger) and Z´ (for the smaller) to describe the resistances. In [130], the model is built for high
Reynolds number in cylinders. Particularly for Re ď 300, the prefactor is one and the resistance
is defined as that of Poiseuille. Otherwise for Re ą 300, the resistance is defined as
                                          1  Re
                                       R“p `    qRpois
                                          2 600
   Notice that other models of airways resistance could also be discussed [60, 134], see [109].

    The model of resistance should be considered according to the situation, if one assumes
asymmetric/symmetric branching or low/high flows. At a first try, the models proposed by
[104] should be considered to take into account the inertial effects of the bifurcations in the tree.

4.2.1.2    Towards more realistic geometries of the respiratory tree
Our 0D model of the pulmonary tree used in the previous chapters is based on the homogeneous
model of Weibel [135]. Typically, the tree is considered as a dichotomous symmetrical branching
system, namely all the branches of a given generation have the same size. Actually, studies
show that, despite being quasi dichotomous, the tree rather adopts asymmetric structure [82].
More specifically, this asymmetry can be defined by two distinct aspects : the asymmetry of
branching and the asymmetry of topology [123]. The branching is asymmetric when a mother
airway divides into two daughter airways with different sizes. The asymmetry of topology defines
the fact that the pathways from trachea through the acini do not encounter the same number
of generations. This results on air pathways from the trachea to the acini composed of about
nine generations up to thirty generations [47].
    We have seen, through the study of the wall shear stress induced by the air flow in the tree in
the section 3.3, that with the hypothesis of a dichotomous and symmetrical branching tree, the
wall shear stress due to the air–mucus interaction in the airways rather spread homogeneously.
Considering the tree asymmetry would be a benefit approach to study more realistic distributions
of the air flow dynamics in the airways of the tree. That would also allow to better understand
the behaviors of the mucus inside the airways. Several models have been proposed for that
purposes [72, 138, 47, 16]. The asymmetric properties of the lung would be taken into account
in the matrix of resistance defining the resistances of paths and sub-paths of the considered tree.
In the case of asymmetrical branching, the properties of the matrix remain verified [37]. For the
asymmetric topology, a new matricial formulation has to be derived [123].

4.2.2     Assumptions about the lung’s parenchyma
We consider the lung’s parenchyma as a homogeneous linear elastic medium. Typically, we do
not account for the spatial heterogeneity of the physical properties of the lung’s parenchyma and
we remain only in the frame of small deformation. The chapter 1 shows the complexity of the


  94                                  Towards the improvement of the model of the lungs


lung’s parenchyma and show the difficulties of a detailed modeling. However, some refinements
can be proposed insired from literature.


4.2.2.1    On the heterogeneity of the lung’s parenchyma

We have seen in the chapter 1 that the lung’s parenchyma is filled with acini and is composed
of millions of alveoli, i.e. little cavities filled with air. It is then formed of successions of tissue
and air space, whose physical properties are different. In our model of the lung’s parenchyma,
we do not account for this spatial heterogeneity. Actually, remembering that the size of the
alveoli and the thickness of their surface are small compared to the spatial occupation of the
lung’s parenchyma, the hypothesis of homogeneity regarding the physical property of the elastic
medium can be quite relevant. In fact, several studies have already discussed about the justifi-
cation of this hypothesis [71]. For example, as stated in [109], the heterogeneity of the alveoli
micro-structure can be considered at a macroscopic level by way of a homogenization method
proposed in [19, 3]. However, the way those physical properties are considered can be discussed.
In particular, the stiffness of the lung’s parenchyma is one of the main data in our model. It
determines the capability of the lungs to recoil from a stimulation. Moreover, the stiffness of
the lung affects the velocity of the wave deformation. Estimating the bio-mechanical properties
of the lung’s parenchyma is then important for our model. Several studies propose different
approaches for that purpose. The estimations are done by mixing mathematical models and
clinical measurements (in dogs) [74, 71] or using hypo-elastic model [31]. Moreover, different
factors can modify the physical properties of the lungs, as the age or the health condition.
Hence, assessing personalized data could be beneficial to our HFCWO model. For example, this
is done in [119], which uses an inverse non-invasive method from four-dimensional computed
tomography. Moreover, as suggested in the chapter 3, the HFCWO therapy could be also used
as a non-invasive measurement tool to measure the resistance and the compliance of the lungs.
Nevertheless, those properties should be adapted for any individuals and complete lungs data
should be reviewed and compiled from literature.


4.2.2.2    Spatial composition of the thorax

We do not model the deformation induced by HFCWO in all the physical components of the
thorax. In reality, the action of the HFCWO pressures propagates through the skin tissue, mus-
cles, bones, pleural liquid and tissues, before acting on the lungs. The physical properties of
those layers are different and affect the deformation. For example, bones are known to be much
stiffer than tissue [106, 12]. One arising question would then be : does some locations of the
applied pressures on the thorax’s patient induce more efficient deformation than others? Those
considerations should be taken into account in future works. The study of those features would
be relevant only in multidimensional model of the lungs.

    The consideration of the spatial heterogeneity of the thorax could be integrated directly
into the stress-strain law of our elastic medium. With the weak formulation for our continuous
system, integrating the different layers composing the thorax would resume to add a spatial
dependence for the Lamé parameters. The linear stress (2.6) would become

                             σelastic puq “ λpxq tr ppuqq I ` 2µpxq puq

   with upx, tq P Rm , m the spatial dimension, and t P R` .

   The heterogeneity of the thorax could be also considered by using different equations, con-
nected with boundary conditions or interaction forces, each one ruling a specific region of the
thoraco-pulmonary region as in [32]. Typically, using our discretized system (2.18) and in the
same spirit as [32], we would have the following illustrative system of dynamics equations to


Hypotheses of the model                                                                       95


solve                  "
                           M lU: l ` Dl U9 l ` K l U l “ hlÑr ` hrÑl
                             r
                           M U : r ` Dr U9 r ` K r U r “ hlÑr ` hHFCWO
    if considering the ribs and the lungs regions and their interacting forces h. The deformation
of the rib is represented by the r index and the one of the lungs by the l index. The right
arrow in index represents the interacting forces and the HFCWO index expresses the action of the
HFCWO therapy, as an example.
    As a first study, one could consider an idealized 2D model of the thoraco-pulmonary region
mimicking cuts as shown on figure 4.1. The different physical layers of the thorax could be defined
from the Lamé parameters and the volumetric density. The tissue areas (the Ai in our model)
submitted to the pressures of the tree region should be defined from the sub-domain mimicking
the interior of the lungs only (see 4.1). From both horizontal and vertical cuts, positions of
the pressures on the external surface could be tested measuring the induced airflow at mouth
as a first try, with similar purposes as in the chapter 3. By extension, idealized 3D model of
the thoraco-region could be studied. Ultimately, 3D geometry of the thoraco-pulmonary model
could be used which is discussed in the subsection 4.3.1.

4.2.3    To an enhanced model of the mucus
The model of the mucus used in the chapter 3 is based on several assumptions. We propose here
ways to improve these assumptions to reach a better estimation of the stress felt by the mucus
during HFCWO manipulations.

    For the computation of the stress due to the air-mucus interaction in the airways, we con-
sider low flows and neglect the inertial effects. In order to compute the stress arising from the
vibration of the airways wall, we relate the change of their radius with the transmural pressure
in the airways. However, we do not account for the spatial occupation of the airways. Hence
the pressure in the airways tissue is estimated for all generations of the tree only from the tissue
pressures induced by the deformation of the regions of the lung’s parenchyma that feed the
terminal bronchi of the tree. Additionally, we do not consider neither the spatial occupation of
the mucus inside the airways nor its displacement through the tree.

    Ways to estimate those stresses have been studied in the literature. First of all, as discussed
in the subsection 4.2.1, one could consider different approaches to mimic the flows of air in the
airways. Typically, for example, we could consider either the effects of symmetric bifurcations
on the flow of air [104], or the effects of asymmetric branching [16], see the subsection 4.2.1.
Then, as in [125], we could consider that the airways are not rigid. For that, the authors of
[125] use the static relationship proposed by [72] that relates the surface area of the airways
lumen and the transmural pressure they are submitted to for the seventeen generations of the
tree. The radii of the airways change according to their transmural pressure. This relationship
is based on experimental data, hence, in [72] estimations of the lengths and radii of the airways
at functional residual volume (FRC) are proposed. Realistic data for the airways could be also
interesting for our purposes. The pressure-surface area relation of [72] could be included in our
model for estimating the mucus stress by computing the transmural pressure in the airways from
the deformation of the lung’s parenchyma, as detailed in the subsection 3.3.1. The relationships
of [72] is also used in [84] where the authors develop a quasi-static model to study the behaviors
of the lungs and of the mucus during Chest Physiotherapy (CP). While [125] do not, the authors
of [84] consider also the mechanics of the airways from the volume–pressure relationship of [2].
Moreover, they model the spatial occupation and the mechanics of the mucus in the airways
and its displacement through the generations. However, they consider only the stress coming
from the air-mucus interaction. Nevertheless, this consideration is interesting for our purpose
and could be adapted. Further studies are necessary.
    With the improvements proposed above, the unidimensional model of the lung’s parenchyma
could already produce better estimations of the stress felt by the mucus. However, considering


  96                                 Towards the improvement of the model of the lungs




Figure 4.1: Top: Schematic of a horizontal cut-view of the thorax (left) with an idealized
associated geometry (right). Bottom: Schematic of a vertical cut-view of the thorax (left) with
an idealized associated geometry (right). The black-shaded surfaces expresses the cut-view.


3D geometry of the lungs could bring far better predictions. Three dimensional geometry of
the bronchial tree brings realistic estimation of the size of the airways which is different to each
individual. Moreover, being able to locate the bronchial tree in the lungs volume could allow
to estimate properly the difference in tissue pressures along the tree. Additionally, the shape of
the different regions corresponding to the terminal bronchi of our tree would be more realistic.
That would allow a better estimation of the pressure inside and outside the airways.


4.3     Towards the modeling of the lungs with 3D geometries
In the previous chapters, we have tested and validated our model with the unidimensional
formulation and idealized geometry of the lungs. These results can be only discussed in a
qualitative and comparative way. In order to reach more quantitative results, still in the limits
of the model, the use of 3D geometry of the lungs is necessary. In this section, we propose ways
to obtain 3D geometry of the lungs (subsection 4.3.1), to solve our model with 3D geometry


Towards the modeling of the lungs with 3D geometries                                                      97


(subsection 4.3.2) and to optimize the resolution of the numerical method (subsection 4.3.3).

4.3.1       Three dimensional geometries of the lungs
One relevant way to assess 3D lungs geometry is medical imaging associated to segmentation
techniques1 . Nevertheless, as of today, the use of medical imaging and segmentation techniques
does not allow to reproduce entirely the spatial geometry of the lungs [38, 118]. Typically,
CT-scan (Computerized Tomography scan) or HRCT-scan (High Resolution Computerized To-
mography scan) reach spatial precision of around respectively few millimeters and few tenth of
millimeters [57, 36, 109]. Hence, generally, segmentation techniques allow to detect the first 5 or
6 generations of the pulmonary tree only [38, 76]. Consequently, the 3D geometries provided by
medical imaging, can be segmented into two parts : the first generations of the bronchial tree
(from the trachea to the generations 5 or 6) and the lung parenchyma (the remaining volume
of the lungs). For example, in figure 4.2, from a CT-scan and using the segmentation software
ITK-SNAP [54, 141], we display those two geometries. Consequently, we can either work with
those geometries at this scale as in [140, 118, 129], or we can use algorithms to generate idealized
tree geometries as in [64, 131]. Specifically, the algorithm proposed in [64] allows to generate
an idealized bronchial tree from trachea to terminal bronchioles that homogeneously fills all
the space inside a given lungs geometry. It is based on several deterministic rules. It would
appear that the algorithm of [64] is quite sensitive to geometrical changes and produces more
asymmetry than in reality [131]. In the tree generating algorithm proposed in [131], the rules
seem more adapted to reproduce realistic airways dimension, see figure 4.3 (left).




Figure 4.2: Left: Geometries of the lung’s parenchyma with the first generations of the tracheo-
bronchial tree (red). The colors correspond to the right (pink) and left (orange) lungs. Right:
Geometry of the first generations of the bronchial tree (around 4 and 5). Geometries are con-
structed from CT-scan images with the segmentation software ITK-SNAP [54, 141].

    Then, the two 3D geometries, i.e the first generations of the bronchial and the lung parenchyma,
can be coupled. In [109], the pulmonary tree is modeled using the coupling between the HRCT-
scan of the first generations of the tree and the tree generating algorithm proposed in [131]. The
results is illustrated in figure 4.3 (right). Then, the lung parenchyma is segmented into several
regions fed by the terminal bronchi of the tree. Hence, in the same spirit as [109], as with our 1D
model displayed in the previous chapters, we can relate the dissipation of the bronchial tree to
the deformation of the lung’s parenchyma with 3D geometries. Additionally, as in the previous
   1
       Segmentation techniques consist in dividing and dissociating several specific areas of an image.


  98                                Towards the improvement of the model of the lungs




Figure 4.3: Left: Idealized geometry of the tracheo-bronchial tree generated by a tree generation
algorithm. The colors correspond to the different lobes of the lungs where the airways are
contained. Taken from [131]. Right: Geometry of the tracheo-bronchial tree coupling HRCT-
scan images (white region) and tree generation algorithm (colored regions). Taken from [109].


chapters, virtual sub-trees can be added to the terminal branches in order to get a more realistic
resistance for the lungs.
    Finally, in the aim of applying our model in such 3D geometry of the lungs, the geometry
has to be meshed. Generating a mesh from a geometry allows to transform a continuous domain
into a discrete one in order to be used by numerical method such as the finite element method.
Different mesh generator are available such as Gmsh [33] or snappyHexMesh proposed by the
software OpenFOAM [101].

4.3.2     Solving the 3D model using the finite element library deal.II
The application of the model proposed in the chapter 2 in a multi-dimensional framework is under
process. We implement a dimension-independent resolution of the system of equations using
the finite element method (FEM) with the finite element library deal.II [5, 6]. The numerical
results computed with deal.II have been validated in one dimension by comparing the results
from deal.II with those presented in the previous chapters. For multi-dimensional cases, the
calculated results have not been validated yet. Nevertheless, as a perspective, we will present
the approach.

4.3.2.1    Quick presentation of the library deal.II
The library deal.II is a C++ [53] open-source software designed for programming finite element
codes. It provides tools for each step in the FEM method, except for the mesh generation of
complex geometries. The documentation offers a wealth of information and goes along with
more than 75 tutorials and 70 video lectures.

4.3.2.2    Multi-dimensional formulation
The three-dimensional equation of the model is described in the chapter 2 as well as the appli-
cation of the finite element (subsection 2.2.4). We recall here only the main equations.


Towards the modeling of the lungs with 3D geometries                                          99


    The deformation of the lung’s tissue at time t and at position x P R3 , 3 the spatial dimension,
is given by upx, tq P Rm . For any proper smooth function w : Ω Ñ Rm , the weak formulation of
our model is


     ż ˆ 2                       ˙     ż              N         ż
         B u
        ρ 2 w ` σelastic puq : w dx ´                               div pwq dx “ 0            (4.1)
                                                     ÿ
                                            τ. w dS ´ pi pFrusq
                                                            9
      Ω  Bt                              Γ1          i“1          Ai


    As displayed in the chapter 2, the continuous equation (4.1) is turned discrete by using the
finite element method. Consequently, the equation (4.1) is written as a linear matrix-vector
equation :

                                  d2             dU ptq
                              M      2
                                       U ptq ` D        ` KU ptq “ τ ptqh                      (4.2)
                                  dt              dt
   The matrix M and K stand for the mass and the stiffness matrix. The matrix D is the
damping matrix arising from the coupling with the tree structure. It is defined as D “t GRG
whose coefficients are defined above. The vector h is the vector of loads. With x P R3 , those
objects are defined as
                              $
                              ’             ş
                              ’
                              ’
                              ’      Mkl “ Ω ρφk pxqφl pxqdx
                              ’
                              ’
                              ’
                              & Kkl “ σelastic pφk pxqq : pφl pxqqdx
                              ’
                              ’      ş
                                                                                               (4.3)
                                      Ω
                              ’                ş
                              ’
                              ’
                              ’          hl “ Ω φl pxqdx
                              ’
                              ’
                              ’
                                                 divpφk qdx
                              ’               ş
                                       Gik “
                              ’
                              %
                                                     Ai

   with puq “ 21 ∇u ` t ∇u the strain tensor. More specifically, the components of the stiffness
                 `         ˘

matrix are computed as
                          ż
                  Kkl “       rλ divpφk pxqqdivpφl pxqq ` µ pφk pxqq : pφl pxqqs dx
                          Ω


4.3.2.3   Numerical scheme

In order to solve the linear system (4.2), we need to use a numerical scheme to discretize the
time. To apply the time stepping scheme, we reduce the time derivative order of the equation.
Typically we set

                                                          Bupx, tq
                                             vpx, tq “
                                                            Bt
   Its variational form, for any smooth test function w : Ω Ñ Rm is
                                       ż             ż
                                                          Bupx, tq
                                            vwdx “                 wdx
                                        Ω            Ω      Bt
   Using the finite element method, the previous equation becomes

                                                 dU
                                             M      ´ MV “ 0
                                                 dt
   Finally, as the mass matrix is invertible, we have

                                                 dU
                                                    ´V “0
                                                 dt


    100                               Towards the improvement of the model of the lungs


    The linear system to solve is then
                             $
                                              dU
                                                   ´V “0
                             ’
                             &
                                                                                                 (4.4)
                                              dt

                              % M dV “ ´D dU ptq ´ KU ptq ` τ ptqh
                              ’
                                  dt       dt

    In the second equation of (4.4), we keep the term dUdtptq instead of V to facilitate the resolution
of the system, see below.
    We use the Crank-Nicholson numerical scheme to discretize the time with pti q0ďiďnt , ti “
i ˆ δt. Using the subscript n to denote the time step, and applying the Crank-Nicholson scheme
with the θ leads to write (4.4) as
       $
                              U n ´U n´1
                                         ´ θV n ´ p1 ´ θqV n´1 “ 0
       ’
       &
                                                                                                  (4.5)
                                    δt

       % M V n ´V n´1 “ ´D U n ´U n´1 ´ KθU n ´ Kp1 ´ θqU n ` θτ n h ` p1 ´ θqτ n´1 h
       ’
                δt               δt

   In order to cancel the term V n in the first line of (4.5), we add the second line multiplied
by δtθ to the first line. It leads to

$
& U n pM ` δt2 θ2 K ` δtθDq “ U n´1 pM ` δt2 θp1 ´ θqK ` δtθDq ` δtM V n´1 ` δt2 θ2 τ n h ` δt2 θp1 ´ θqτ n´1 h
’

             M V n “ U n p´δtθK ´ Dq ` U n´1 pD ´ δtp1 ´ θqKq ` M V n´1 ` δtθτ n h ` δtp1 ´ θqτ n´1
’
%
                                                                                        (4.6)
   The system (4.6) is then solved using the deal.II library. A quick explanation of how it is
implemented in deal.II is given in the following subsection.

4.3.2.4   Overview of the implementation of the finite element method in deal.II
The resolution of the equations governing our multi-D model of the lungs has been tested for
idealized geometry of the lung’s tissue only, typically a square and a cube. The validation of
the implementation has been validated in 1D only and is in progress for the multi-D. We will
detail the main steps of the implementation using the library deal.II. The following explanation
is inspired from the steps of the deal.II documentation [6, 5].

    The first step consists in either importing a meshed geometry or creating a geometry and
meshing it with the desired number of cells. Then, in order to associate the number of degrees
of freedom (DoF, i.e. the spatial position where the solution will be expressed) to the cells, we
need to choose the type of finite element. For example, if we use 1st order elements, the degrees
of freedom will be associated to the nodes of the mesh. For higher order elements, the degrees of
freedom can be associated also to faces, edges, etc. Once the geometry is meshed in deal.II, we
need to prepare the matrices before they evaluate the integrals of the shape functions depending
on the weak formulation. Typically, as the matrices are frequently sparse, it consists in locating
the non-zero coefficients in the matrices. We can then assemble the matrices and evaluate their
elements. Then, we create a loop over the cells and over the DoFs of the cells. We evaluate the
value of the specific integral of shapes functions for one cell. Then we add the contribution of
this cell in the global matrices. Once the loop is finished, we apply the homogeneous boundaries
conditions. The linear matrix-vector equation is then solved using a solver among the range of
solvers in deal.II.


Towards the modeling of the lungs with 3D geometries                                           101


4.3.3    The splitting method

This section has been investigated in collaboration with Bernard Rousselet, emerita professor,
Université Côte d’Azur, CNRS, LJAD.

     The coupling between the elastic material and the tree structure involves a non-usual dif-
ferential operator. As we have seen in the previous chapters, the effect of the dissipation of the
tree on the elastic deformation is non-local. Then, in the finite element framework, the damping
of the tree is represented by the matrix D “ t GRG applied to the velocity. The matrix R is
the resistance matrix [25] of the considered tree and contains the resistances of paths and sub-
paths from the trachea toş the terminal branches. The matrix G is the operator that computes
the air flow with Gik “ Ai divpφk qdx. Hence, in the finite element framework, the matrix D
has a specific matrix patterns which is different from the usual ones appearing in the mass or
stiffness matrices. While the mass and stiffness matrices are sparse, the damping matrix D is
not. Numerically, it induces higher computational time when solving the matrix-vector system.
Moreover, if one would consider inertial effects for the first generations of the tree, the matrix D
has to be reconstructed at each time step during the numerical resolution, as performed in [109].
Hence, in the aim of studying complex 3D geometries of the lungs with sufficient numerical
precision, finding a way to optimize the calculation time is important.
     In [109], to reduce time calculation due to the consideration of inertial effects, they decompose
the product DU9 into three distinct products. That results in smaller computational time. In
our case, we do not take the inertial effects into account yet. However, in order to reduce the
calculation time, we used a method easily adaptable. In that sense, in the spirit of "divide and
conquer" [46], the approach of the splitting method is well adapted.
     The method of splitting is a method that allows to simplify the resolution of Ordinary and
Partial Differential Equations (ODEs and PDEs) by dividing the ODE or PDE into a system of
ODEs and PDEs [46]. Specifically, each equation of the system takes into consideration only one
or several differential operators. Then, the equations are linked together using specific conditions
on the discretization step, see above.
     The splitting method is also named operator splitting, dimensional splitting or also frac-
tional step. It was mainly introduced in the early 1950s but since 1990s, with the technological
progress, the method is now recognized as an important numerical tool. The splitting method
has been applied on several fields with typical ODEs or PDEs, see [90] for more details.

    The splitting method has several advantages. Sometimes, some complex equations exhibit
different behaviors which do not work at the same scale. For example, it could be used to couple
the spatial deformation of the trachea with the one of an alveolus, which do not have the same
order of magnitude in size. Another application could be to link the human ventilation with
the high frequency pressure induce by HFCWO, which do not work at the same time scale.
Hence, the coupled equations would deal with operators which are not defined at the same scale.
The splitting method allows to consider the different operators influences while solving a set of
different equations. This splitting also allows to work with different solving algorithm or step-
ping scheme, adapted to each equation. Consequently, it can reduce the numerical calculation
memory, favours multi-processing, and improve the stability of the scheme [46]. However, the
implementation of the method is not straightforward. The choice in the operator splitting and
numerical scheme has to be thoroughly studied carefully to satisfy efficient numerical resolution.
Moreover, it can be less efficient if the operators are common.

    Our implementation of the splitting method is not validated yet. However, we can already
give some indications on its implementation and present potential applications for the model of
the lungs. Before discussing the implementation of the method in our case (subsection 4.3.3.1),
we present the method from a general perspective (subsection 4.3.3.2). Then, we propose some
numerical results in subsection 4.3.3.3.


  102                                Towards the improvement of the model of the lungs


4.3.3.1   The splitting method
This subsection is inspired from [90, 46, 34]. Let’s consider the following Cauchy problem, with
U, U0 P Rn , A and B two n ˆ n matrix operators and U9 “ dU {dt :

                                  U9 “ pA ` BqU,               U p0q “ U0                       (4.7)
   whose typical solution is

                                          U “ epA`Bqt U0
   For large matrices and specific operators, it may be more efficient to solve the differential
equation with one matrix at a time. Namely, conceptually, it would be easier to compute, with
∆t ą 0 the time step and U n “ U pn∆tq “ U ptn q,

                                         U n`1{2 “ e∆tA U n
   and

                               U n`1 “ e∆tB U n`1{2 ” e∆tB e∆tA U n
   This ´is an aproximation
                     ¯n         particularly due to the Lie product formula, which states that
limnÑ8 e e A nt B nt
                        “e pA`Bqt . It is equivalent to solve iteratively in rtn , tn`1 s
                                           $
                                           & U9a ´ AUa “ 0
                                                                                          (4.8)
                                           % U pn∆tq “ U n
                                                a
                                       $
                                       & U9 ´ BU “ 0
                                           b       b
                                                                                                (4.9)
                                       % U ptn q “ U n`1{2
                                            b

    by setting U n`1{2 “ Ua ptn`1 q. And finally, the solution at time pn ` 1q∆t is U n`1 “
Ub ptn`1 q.

   Since the equation (4.7) can be approximated by the iterative resolution of equations (4.8)
and (4.9) with specific stepping conditions, the method encourages the use of adapted algorithms
and it can reduce the numerical calculation time. However, the method does not provide neither
the numerical algorithms nor the way the splitted equations are coupled (un`1{2 and un`1 ).

4.3.3.2   The splitting method for the model of the lungs
Our model of the lungs couples the deformations of an elastic material with the dissipation of
air in a tree structure. In the finite element framework, two specific differential operators act for
that purpose : the stiffness matrix and the damping matrix. The stiffness matrix is common.
However, as discussed above, the damping matrix has a specific pattern. It is then quite natural
to use the splitting method to decompose the equations based on those two operators in our
model of the lungs. In the continuous formulation, it amounts to separate the two terms in the
stress–strain relationship :

                         σpu, Frusq λTrppuqqI ` 2µpuq looooooomooooooon
                                9 “ looooooooooomooooooooooon ´ptree pFrusqI
                                                                        9
                                                σelastic puq           σtree puq
                                                                              9

    The following equations are a proposition for the use of the splitting method. The validation
of this approach in terms of numerical computation and stability, is in process.


Towards the modeling of the lungs with 3D geometries                                         103


    From the continuous weak formulation
    The equation of the model will be solved using the Crank-Nicolson scheme in the discrete form
of the finite element method. Hence, we use the weak formulation and we set Bupx, tq{Bt “ vpx, tq.
We recall that the deformation of the lung’s tissue at time t and at position x P Rm , m the
spatial dimension, is given by upx, tq P Rm . Then, we recall that the biomechanics of the tissue
in our model is ruled by the following system of equations : for any proper smooth function
w : Ω Ñ Rm which cancels in Γ2 ,

     ż ˆ 2                       ˙     ż             N         ż
         B u
        ρ 2 w ` σelastic puq : w dx ´                             div pwq dx “ 0            (4.10)
                                                    ÿ
                                           τ. w dS ´ pi pFrusq
                                                           9
      Ω  Bt                             Γ1          i“1         Ai




   with Γ1 and Γ2 the parts of the boundary of the domain Ω where the Neumann and the
Dirichlet condition are applied respectively.
   To split (4.10) in the spirit of the splitting method, we set the two couples of stepping
unknowns Θ “ rθ, χsT and Z “ ry, zsT with χ “ Bθ{Bt and z “ By{Bt ; θ, χ, y, z P Rm .
Consequently, equation (4.10) can be solved alternatively with
                    $
                                        ş       Bθ
                                                              ş
                                            Ω ρ Bt wdx    “       Ω χwdx
                    ’
                    ’
                    ’
                    ’
                    ’
                    ’
                                                           : pwqdx `
                    ’ ş   Bχ            ş                                  ş
                        Ω Bt wdx        Ω σelastic pθq                          σpuq.nwdx
                    ’
                    &              “´
                                                                                             (4.11)
                                                                           Γ1

                                              θpx, 0q “ upx, 0q
                    ’
                    ’
                    ’
                    ’
                    ’
                    ’
                                             χpx, 0q “ vpx, 0q
                    ’
                    ’
                    %

                           $
                                                 Ω Bt wdx “ 0
                           ’
                           ’                    ş  By
                           ’
                           ’
                           ’
                           ’                      N
                                                                      div pwq dx
                           ’ ş                    ř          ş
                           ’       Bz
                                   Bt wdx   “   ´ pi pFrusq
                                                          9 Ai
                           ’
                           & Ω
                                                 i“1                                         (4.12)
                                             ypx, 0q “ θpx, ∆tq
                           ’
                           ’
                           ’
                           ’
                           ’
                           ’
                           ’
                                             zpx, 0q “ χpx, ∆tq
                           ’
                           ’
                           %



    for a small time increment ∆t. For this increment ∆t, the solutions are ypx, ∆tq and zpx, ∆tq.
Then, the systems are solved successively for all time step. Finally, the solution u of the equation
(4.10) at a time t is ypx, tq.

   From the finite element discret formulation
   The splitted equations presented above in the continuous formulation, are discretized into
the following equations in the finite element framework (see (4.4)) :
                                   $
                                                    dU
                                                         ´V “0
                                   ’
                                   &
                                                                                             (4.13)
                                                    dt

                                   % M dV “ ´D dU ´ KU ` τ h
                                   ’
                                       dt      dt

   or

                                              dU
                                                 “ AU ` H
                                              dt
   with


  104                                   Towards the improvement of the model of the lungs



                                                                        0, 1
                                                              ˆ                        ˙
                   U “ rU, V s , H “ r0, τ hs and A “
                              T                    T
                                                                                            (4.14)
                                                                  ´M ´1 K, ´M ´1 D
   We can split the matrix A into two matrices as A “ A1 ` A2 with

                                        0, 1                              0, 0
                                  ˆ                ˙              ˆ                ˙
                         A1 “                          and A2 “                             (4.15)
                                      ´M ´1 K, 0                      0, ´M ´1 D
   With the vector functions Θ “ rθ, χsT , Z “ ry, zsT , we solve successively with ∆t a small
time increment

                                            dΘ
                                               “ A1 Θ ` H                                   (4.16)
                                            dt
   and

                                           dZ
                                               “ A2 Z                                     (4.17)
                                           dt
    The system (4.16) takes into account the elastic deformation of the material and the system
(4.17) the dissipation of the tree. The initial conditions are Θp0q “ U p0q and Zp0q “ Θp∆tq.
Then for a given time tn “ n∆t, the stepping time conditions are Θpn∆tq “ Zpn∆tq and
Zpn∆tq “ Θppn ` 1q∆tq.

4.3.3.3   Some preliminary feedback on the use of the splitting method
We implement the splitting method in the library deal.II [6] using the discrete formulation de-
scribed above. We use the Crank-Nicolson scheme to discretize the time for both the equation
of the elasticity (4.16) and the equations for the damping of the tree (4.17). In future works
we would like to study which scheme is the best adapted for each resolution. For example, we
suggest that an explicit scheme (semi-implicit Euler scheme) would be more adapted, in terms
of reducing the time calculation, to solve the system that rules the elastic deformation.

     Although the implementation of the resolution of the multi-D model has not been validated
yet, using the splitting method described above leads to the same results as the ones by solving
directly the original system (4.4). We gather in the following table the calculation times for
2D and 3D numerical simulations for different spatial and time precisions. In 2D, the geometry
is a square with a side length of 2. In 3D, we consider a cube with the same side length. We
consider a 9 generations tree feeding 64 areas in the elastic medium. The Lamé parameters,
the density, the amplitude and the frequency of the applied pressure and the final time of the
simulations are set to 1. For the 2D simulations, we apply a zero displacement condition at one
side of the square and the Neumann boundary condition τ at the opposite side of the square.
We apply the same strategy for the 3D simulations. Zero displacement is applied at one face of
the cube and the Neumann boundary condition τ is applied to the opposite face. The Neumann
boundary condition is set to τ “ sinp2πtq. The parameter of the Crank-Nicolson scheme is
set to θ “ 1{2. In that way, the scheme is second order accurate and conserve energy in the
solution. We use the conjugate gradient solver with no preconditioner. We do not compare the
efficiency of different preconditioners or solvers. In our case, the conjugate gradient solver with
no preconditioner works and allows us to make comparative results. The numerical simulations
are performed with a Intel® Core™ i7-8650U CPU@1.90 GHz ˆ 8 processors. The computations
are performed with one processor only.

    From the table 4.1, we suggest that the use of the splitting method could be interesting in
reducing calculation time. For both two and three dimensions, for a same parameters config-
uration, the splitting method needs about half the time than with the original method. The
results are proposed in the limits of the validation of the computing implementation. Further
investigations are required.


Investigation of the efficiency of a HFCWO device through a clinical study                          105


                Number of degrees       Time step ∆t            Calculation time (s)
                    of freedom                (s)         Original system     Splitting system
                        2178                  0.1               11.44                 6.31
         2D
                        8450                 0.05              240.15                92.28
                        2187                  0.1               18.25                12.22
         3D
                       14739                 0.05             1105.29               465.10

Table 4.1: Computation times comparison between the original resolution and the solving using
the splitting method for different spatial and time discretizations.


4.4     Investigation of the efficiency of a HFCWO device through
        a clinical study
This section has been worked in collaboration with Valentin Mons, PhD student, Université
Côte d’Azur, LJAD, LAMHESS.

    The chapter 3 shows that a change in lungs mechanical parameters induces a more or less
significant change in lungs deformation and in the induced airflow inside the pulmonary tree.
Particularly, we suggest that it might exist an optimal stimulating frequency that can maximize
lungs deformation and/or induced airflows in the tree. This frequency is related to the funda-
mental natural frequency of the lungs and to the intensity of the dissipative action of the tree.
We propose a mathematical formula to compute natural frequencies of the lungs that depends
on the characteristic stiffness, density and size of the lungs. The HFCWO technique applies
pressures on the patient’s chest to stimulate lungs deformation. Its efficiency is only modulated
by the intensity and the frequency of those pressures which are empirically chosen parameters.
Consequently, finding the natural frequencies of the lungs could be an interesting tool for the
determination of the operating parameters of HFCWO.
    In this section, we introduce the setup of a clinical study that aims at helping to determine
of HFCWO operating parameters. Specifically, the study examines if some frequencies and/or
intensity levels could be optimal for HFCWO.
    Several studies investigate the efficiency of the technique by comparing with other airway
clearance techniques [95, 96, 35]. They measure various indicators such as pulmonary function
(FVC, FEV1 or PEF2 ), mucus sputum expectoration or quality of life score. To the best of our
knowledge, only a few take an interest on studying the influence of the values of the HFCWO
operating parameters. In [61], the authors investigate the impact of three types of combination of
intensity–frequency pressure on the quantity of expectorated mucus with a High Frequency Chest
Wall Compression (HFCWC) device. The study is performed on 16 young adults with chronic
mucus production. As best as we know, the HFCWC device used in [61] and the HFCWO device
that we will study produce comparable therapy. The only difference is that HFCWC applies
an added homogeneous pressure on the patient’s chest [50]. In [61], the pressures intensity are
expressed in the arbitrarily device unit taken from a 1 ´ 10 scale. The evaluated combinations
in [61] are : 1) intensity 10 with 8, 9 and 10 Hz frequency ; 2) intensity 6 with 18, 19 and 20
Hz frequency ; 3) intensity 5 with 12 Hz frequency. The conclusions of [61] suggest that the
combinations 1) and 2) result in higher quantity of expectorated mucus than the combination
3). The combination 1) and 2) are not compared. Those measures are interesting but, from
our perspective, do not seem sufficient to infer which of the intensity or of the frequency has a
preponderant impact on the mucus expectoration. The influence of the frequency of the HFCWC
pressure is studied in [92] for the same HFCWC device, through a 100 patients study. They
    2
      FVC : Forced Vital Capacity, FEV1 : Forced Expiratory Volume in 1 second, PEF : Peak Expiratory Flow,
see [126]


  106                                Towards the improvement of the model of the lungs


measure the average mouth volume of air moved and the average induced airflow. In [92], the
HFCWC device applies pressures with a sine wave-forms as in [61] and as our HFCWO device.
The authors of [92] concludes that, on average, with sine wave-form pressures, highest mean
volumes and highest mean airflows are measured from frequencies respectively between 6 and 10
Hz and between 13 and 20 Hz. From an other perspective, as the HFCWO technique acts first on
the patient’s chest, one could also study the response of the chest to HFCWO stimulation. This is
actually investigated in [67] with a HFCWC device. However, the name of the device used is not
specified but the functions described seem similar to the previous one. Moreover, the operating
frequency of this device can range from 0 to 50 Hz, which is not applicable in typical HFCWO
devices (usually 1 to 25 Hz) [121, 96]. The authors of [67] measure the acceleration response
of the chest versus the force applied on the patient’s chest, i.e. they measure the inertance.
On average over 21 healthy adults, they find out that the maximal inertance is obtained with
a frequency equal to 26 Hz. This frequency could represent the resonance frequency of the
chest. They also suggest that, in average, HFCWC device should work in a range of frequencies
between 18 and 34 Hz. In parallel, they infer that there is a negative linear correlation between
the patient’s chest size and the resonance frequency. Typically, the wider the chest size is, the
lesser the resonance frequency. This relationship is in accordance with the natural frequencies
definition (2.39), inversely proportional to the characteristic size. Indeed, it can be applied to
any elastic media, as muscles and bones that compose the chest.

    Consequently, it looks like no study investigates the influence of the operating parameters for
a HFCWO device. In that way, in this section, we propose a clinical study with some preliminary
insights. The HFCWO technique acts on the mobilization of the mucus by submitting two types
of stress : from the air flowing along the mucus inside the airways and from the vibrations of
the airways wall that deform the mucus. In this clinical study, we focus only on the shear stress
arising from the air–mucus interaction. To estimate this influence, we propose to measure the
airflow at mouth induced by the HFCWO therapy. In order to eliminate the ventilation, the
patient holds her/his breath times to times during the therapy, while keeping her/his glottis
aperture open to let air flows in and out. The data would be then post-processed to keep only
the times when ventilation is on hold.

    The study will be performed in healthy non-smoking young adults. The volume of air will
be measured at mouth with a calibrated pneumotachograph (spirometry device). Four configu-
rations of parameters in the intensity–frequency range will be tested. Then, statistical analysis
will be performed according to the results. We will focus on significance test as a first approach
to compare the efficiency of the different combinations, see next subsection. The protocol of
this clinical study has been tested on two individuals. We started to analyze the measurements
from one record. The following subsections detail the method and the protocol proposed for this
study, as well as the first preliminary insights.


    We also propose the use of flexible force sensors to measure the pressure that is applied by the
HFCWO device on the patient’s chest. The quantity could be related to the scale of the HFCWO
device. Moreover, we take the opportunity of this study to measure Maximal Flow Volume Loop
(MFVL). Before and after the therapy, maneuvers of MFVL are performed and data acquired.
This kind of curve can inform on the ventilatory lungs function [9] and could inform on the
effect of a potential bronchodilator (personnal communication with HFCWO manufacturer).

    We also propose that, alternatively to significance test, parametric tests could be considered.
However, although being more powerful than significance test, they are considered less robust
[112]. Parametric tests need an initial assumption on the parameters of the data distribution. As
this assumption is quite difficult to determine in our case, we would rather focus on significance
tests.


Investigation of the efficiency of a HFCWO device through a clinical study                   107


4.4.1    Method and protocol
As stated above, a significance test would be an interesting tool to analyse the data of the
study. Before going deeper in the details of the experimentation, we introduce the concept of
this statistical test.

    Introduction to significance test. A significance test or statistical hypothesis testing
is based on the principle of accepting an assumption, called the null hypothesis, or rejecting
it in favor of an other assumption, called the alternative hypothesis, based on statistical data
[28]. The test is used either to suggest that something interesting is happening (the alternative
hypothesis is favored) or to suggest that two assumptions can be considered as similar (hypothesis
null accepted). However, such statistical test is subject to errors, and particularly two types
of error : the error of type I and of type II. The error of type I occurs if the null hypothesis
is rejected whereas it is true. The probability of this error is called the significance level and
is denoted α. Usually, it is set to α “ 0.05, which let 5% of chance to incorrectly reject the
null hypothesis. The error of type II occurs when the null hypothesis is accepted whereas it is
false. The probability of this error is denoted β and we rather consider the inverse probability
(1 ´ β) to specify the power of the test. It is usually set to 1 ´ β “ 0.8, saying that there is 80%
of chance that the null hypothesis is correctly rejected. In such test, the power is a significant
figure that has to be properly chosen in order to justify the relevance of the results. An other
important criteria is the sample size that is discussed in the next paragraph.
    Participants criteria. First, subjects are asked to be healthy non-smoker young adults
(ă 30 years old) who are free of any acute and chronic respiratory disease. Then, as stated above,
the required number of participants is an important parameter that has to be justified carefully.
As the subjects represent a sample for a global population, a larger numbers of subjects leads
to more truthful results. However, clinical researches also have to deal with experimental cost,
work time and patient ethic [23, 112]. Consequently, a clinical study generally tends to minimize
sample size while maximizing results confidence (power). With significance test, it amounts to
examine mainly the significance level (α), the power (1 ´ β) and the standard deviation of
the distribution obtained with the data [23]. We will not discuss here how to deal with those
quantities for that purpose. A specific study has to be performed in the future and during the
clinical trial to propose a justified sample size.
    Material. The HFCWO device is called RespIn 11 (RespInnovation SAS, Seillans, France).
It is composed of a jacket containing lines of flexible pistons (two at the front and three at the
back) and of an electronic device containing a blower which fed with air the pistons through
medical tubes, see Figure 4.4. The device controls the frequency and the intensity of the ex-
pansion of the pistons. The technology is also called focused pulses techniques because it applies
pressures on the patient’s chest and back only on specific regions, i.e. where the pistons are
acting. The ventilation function is measured using a pneumotachograph (model 3813, Hans
Rudolph, Kansas, USA). The pneumotachograph is calibrated with a 3L-syringe (model 5530,
Hans Rudolph, Kansas, USA) at three varying flow rates for six volumes from 0, 5 L to 3 L. We
would like to measure also the force applied by the HFCWO device on the patient’s chest. For
example, we propose the use of flexible sensor in the range FlexiForce™ (Tekscan Inc., Boston,
MA, US). During the whole session, raw flow and volume data were continuously recorded at a
sample rate of 4000 Hz using a 16-channel analog-to-digital data acquisition system (Powerlab
16/35, Model XX, ADInstrument, USA) and stored on a lab computer via adapted software
(Labchart v.7, ADInstrument).
    Spirometry measurement protocol. During the therapy, which lasts 18 minutes, 4
combinations of intensity–frequency in the scope of HFCWO are applied for 4 minutes each.
We denote by I the intensity unit of the HFCWO applied pressures, which is expressed in the
arbritrarily scale of HFCWO device 1 to 10. The four intensity–frequency combinations are {6
I, 12 Hz}, {10 I, 12 Hz}, {6 I, 20 Hz} and {10 I, 20 Hz}. The four combinations are chosen
to get insights on the influences of both the intensity and the frequency of HFCWO pressures.
The combinations of parameters have to be randomly chosen. Different experimental designs


  108                               Towards the improvement of the model of the lungs




Figure 4.4: Mechanical device of chest physiotherapy called RespIn 11 using High Frequency
Chest Wall Oscillation technique. It is developed and commercialized by RespInnovation SAS,
Seillans, France. Left: The jacket called Wrap (blue) with the controller unit (orange and
white). Right: Line of pistons contained in the Wrap. The front part of the jacket contains two
lines and the back part contains three lines. The pictures have been provided by RespInnovation
SAS.


exist and have to be studied. For example, we propose the block randomisation method [7].
The method seems convenient to distribute several groups of test, such as our four HFCWO
configurations, amongst several patients. For each combination, the participant holds his breath
during at least 10 seconds while keeping its glottis aperture open. Before and after the therapy,
the participant performs at least 3 maneuvers of Maximal Flow Volume Loop (MFVL). The post-
therapy maneuvers should be performed directly after the therapy with a 30 s to 60 s interval
between the maneuvers. Before the therapy, the participant gets accustomed to both ’holding
breath–open glottis’ and MFVL maneuvers, following the experimentators instructions. The
sensors of the pneumotachograph can be wet due to the participant ventilation and can disturb
the data acquisition. Moreover, even if it is usually not observed for healthy individual (personal
communication with HFCWO manufacturer), the participants could need to expectorate during
the therapy. Consequently, the therapy does not stop unless the sensors needs to be cleanead or
dried or if the participant needs to expectorate.
    Data post-processing. Raw data are analysed using the computing environment MATLAB
[79]. The volume of air at mouth is computed by the numerical integration of the flow of air
signal. Each holding-breath recording is dissociated from the rest of the signal and is studied
independently. From the obtained periodic signal, the volume of air ventilated at each cycle of
the HFCWO pressures is computed, see the subsection 4.4.2. We can also deduce the frequency
of the HFCWO pressures and compare it to the frequency declared by the manufacturer.

4.4.2   Preliminary results
The study protocol has been performed on two individuals. The data post-processing has been
realised for one individual. This subsection details the post-processing process and presents the
first preliminary results.

    Focusing on the holding breath signal
The overall signal of the spirometry session is displayed in the figure 4.5 (left). In the same
figure (right), we display a zoom on one of the holding-breath recording (combination {6 I, 20
Hz}). We dissociate the latter from the overall signal in order to analyse the flow of air during
a holding-breath maneuver only.


Investigation of the efficiency of a HFCWO device through a clinical study                                                                     109


                                                                                                                 2




                                                                                       Air flow at mouth (L/s)
                                                                                                                                          Breathing held
                                                                                                                 1

                                                                                                                 0

                                                                                                                 -1

                                                                                                                 -2

                                                                                                                 -3

                                                                                                                      2185     2190     2195      2200     2205
                                                                                                                                       time (s)

                                                                                                          0.3




                                                                      Air flow at mouth (L/s)
                                                                                                          0.2


                                                                                                          0.1


                                                                                                                 0


                                                                                                  -0.1


                                                                                                  -0.2
                                                                                                                      2199   2199.2 2199.4 2199.6 2199.8   2200
                                                                                                                                       time (s)


Figure 4.5: Left: Overall spirometry signal during the entire protocol. Right: Zoom of the
signal around (top) and of (bottom) a holding-breath session for the intensity–frequency com-
bination {6 I, 20 Hz}.


    Computing the volume of air exchanged during one HFCWO cycle
The volume of air is then computed by integration of the flow. To compute the volume of air
exchanged at each cycle, we need to find the local extrema of the volume curve. Then, we
consider that the amplitude difference between one local maximum and the next local minimum
represents the volume that goes in the lungs. Equivalently, we consider that the amplitude
difference between one local minimum and the next local maximum represents the volume of air
that goes out of the lungs. The total of those two volumes is the volume exchanged during one
cycle of the HFCWO pressure, see figure 4.6 (right).

    Correcting the spirometer shift
Due to several factors, such as temperature or humidity, the recorded signal of flow suffers what
we called a "shift". Specifically, this shift leads the signal amplitude to continuously increase
or decrease little by little during the therapy. In our case, we observe mostly an increasing
amplitude pattern. Consequently, the volume integrated from the flow also suffers from this
shift, see figure 4.6 (left). Two computing techniques are proposed and compared to correct the
shift. Both of the techniques consist in computing a spline of the volume curve and subtracting
it to the original volume curve. The first technique computes a spline passing through the local
maxima of the original curve. The second technique computes a spline passing through the av-
erage value between one local maximum and the next local minimum of the original curve. The
volume of air exchanged is then computed from the original curve of the corrected curves. The
volumes obtained from the two spline methods are compared with each others and are compared
with the volume computed without spline methods. We display in figure 4.7 the splines of the
curve of volume. In figure 4.8 are displayed the corrected curves, i.e. curves obtained from
subtracting the spline to the original curve.

   Data validation
The amplitude of the HFCWO pressures are small and one could doubt on the capability of the
pneumotachograph to capture the low signals. For that purpose, two measurements recorded
during the HFCWO therapy are compared : one with a closed glottis aperture and one with


                     110                                           Towards the improvement of the model of the lungs


              0.1                                                                                        0

             0.08                                                                                    -0.002

                                                                                                     -0.004
             0.06
                                                                                                     -0.006
volume (L)




             0.04




                                                                                        volume (L)
                                                                                                     -0.008

             0.02                                                                                     -0.01

                                                                                                     -0.012
                0
                                                                                                     -0.014
             -0.02
                                                                                                     -0.016        local maxima
                                                                                                                   local minima
             -0.04                                                                                   -0.018
                 2194      2196   2198               2200       2202           2204                       2198    2198.1    2198.2   2198.3   2198.4   2198.5   2198.6   2198.7
                                    time (s)                                                                                            time (s)


                Figure 4.6: Left: Volume of air during a holding breath recording. Due to the pneumotacograph
                sensibility, a "shift" of the amplitude occurs. Right: Volume of air during a held breathing
                recording with local extrema.

                                                     0

                                                 -0.002

                                                 -0.004

                                                 -0.006
                                    volume (L)




                                                 -0.008

                                                  -0.01

                                                 -0.012

                                                 -0.014       original curve
                                                              local maxima
                                                              local minima
                                                 -0.016       spline max
                                                              spline mean
                                                 -0.018
                                                      2198   2198.1    2198.2    2198.3              2198.4      2198.5    2198.6    2198.7
                                                                                      time (s)

                Figure 4.7: Original volume curve with two interpolating splines. One spline (red) goes through
                the local maxima. The other spline (black) goes through the mean between one local maximum
                and the next local minimum.


                an opened glottis aperture, see figure 4.9. We can distinguish small oscillating airflows with
                opened glottis aperture. We deduce that the amplitude precision of the pneumotachograph is
                high enough. Moreover, to verify that the oscillations correspond to HFCWO, we compared the
                measured frequency with the HFCWO frequency, with and without the correction of the shift,
                see table 4.2. We computed the frequency from the time period between two consecutive max-
                ima or between two consecutive minima. As those time periods may differ on each consecutive
                maxima/minima, we computed the average frequency of all the time periods. We also computed
                the average frequency from the two types of average frequencies obtained (from the maxima
                and from the minima). For higher frequency (20 Hz) the computed frequency is quite similar
                to the declared frequency. However, for lower frequency (12 Hz), frequencies differences can
                be observed. Those differences lead us to verify the actual frequency applied by the HFCWO.
                For that purpose, we used a 120 images per second camera to record the pressures frequencies
                delivered by the HFCWO device. We filmed directly the inflatable pistons contained inside the
                HFCWO jacket. Then, with the video editing software Adobe Premiere Pro® [52], we determined


                Investigation of the efficiency of a HFCWO device through a clinical study                                                                                         111


                                                                                                                                    ×10 -3
              0.1
                                               original volume
                                               volume minus spline max                                                         8
             0.08                              volume minus spline mean
                                                                                                                               6
             0.06                                                                                                              4
volume (L)




                                                                                                   volume (L)
                                                                                                                               2
             0.04
                                                                                                                               0
             0.02                                                                                                              -2

                0                                                                                                              -4
                                                                                                                               -6
                                                                                                                                                   original volume
             -0.02                                                                                                                                 volume minus spline max
                                                                                                                               -8
                                                                                                                                                   volume minus spline mean
             -0.04                                                                                                            -10
                 2194                            2196     2198      2200         2202       2204                                         2198.8          2199         2199.2           2199.4
                                                              time (s)                                                                                     time (s)

                Figure 4.8: Left: Original volume curve and two volume curve correcting the shift with the
                splines method. Right: Zoom of the original volume curve and the two volume curve correcting
                the shift with the splines method. Note: The corrected curves are computed by subtracting
                the spline with the maxima and the spline with the mean between two consecutive extrema to
                the original volume curve.


                the period of the oscillations of the HFCWO pressures. With 120 recorded images per second,
                the precision of the computed period is « 0.01s. We found out that the HFCWO pressure
                frequencies declared by the manufacturer correspond to the frequencies of the combined lines of
                the pistons but not of each line of pistons. Typically, when expecting 20 Hz, each line of piston
                actually applies pressures at frequency « 6.5 Hz. However, on the back of the patient, three lines
                of pistons are acting in a asynchronous way. Hence, at each HFCWO cycle, three pressures are
                applied successively. Consequently, the actual HFCWO frequency is, in this case, three times
                the frequency of one line of pistons. For example, when expecting 20 Hz, the HFCWO device
                applies 3 ˆ 6.5 “ 19.5 Hz. We verify this for all the frequencies delivered by the HFCWO device
                and, the same same observation is made. However, the HFCWO device also applies pressures on
                the patient’s chest through two lines of pistons, which are independent from the back pistons.
                Consequently, the action of the back and front pistons can interfere on the measured frequency.
                This could explain the difference between the measured frequencies and the one declared by the
                manufacturer.


                                                                                                                              0.0004
                                           0.0002
                 Air flow at mouth (L/s)




                                                                                                    Air flow at mouth (L/s)




                                           0.0001                                Glottis closed                               0.0002                                  Glottis opened

                                                0

                                                                                                                                     0
                                           -0.0001


                                           -0.0002                                                                            -0.0002


                                                        280      285       290        295                                                    520   525      530       535    540
                                                                   time (s)                                                                                time (s)

                Figure 4.9: Left: Holding breath recording while closing the glottis aperture. Right: Holding
                breath recording while opening the glottis aperture.


  112                                Towards the improvement of the model of the lungs


                                   Average frequency      Average frequency        Average frequency
                    Method         from the maxima         from the minima         from the maxima
                                                                                    and the minima
                                           (Hz)                  (Hz)                      (Hz)
                 without spline          22.42                   18.79                     20.60
   6 I, 20 Hz      spline max            25.42                   20.63                     23.03
                  spline mean            23.79                   19.36                     21.58
                 without spline            7.64                  8.14                      7.89
  10 I, 12 Hz      spline max            12.04                   7.68                      9.86
                  spline mean              9.54                  7.88                      8.71

Table 4.2: Comparison of the frequency declared by the HFCWO device and the ones measured
by the pneumotachograph and computed by numerical analysis. We computed the frequency
from the volume curve without shift correction and with shift correction. The two spline methods
correcting the shift are also compared.


    Results and comparison
We are interested in computing the volume of air ventilated per cycle of the HFCWO pressures
as well as the average air flow. To do so, we calculated the volume of air for each HFCWO
cycle during the holding–breath maneuver. Then, we computed the mean between all the
volume cycles. The average flow is computed by multiplying the mean volume to the average
frequency presented before. We performed the calculation for one individual, with and without
the corrections of the shift. We display the results for two combinations of intensity–pressure
({ 6 I, 20 Hz} and {10 I, 12 Hz} ). They are gathered in the table 4.3. First, we observe
that the average volumes over a HFCWO are quite similar with or without the correction of
the shift. Then, from the two intensity–pressure combinations, we can distinguish that the
average volumes are higher for higher HFCWO intensity pressures. However, we can not see the
influence of the frequency from these two combinations. Moreover, force measurement is needed
to determine the intensity unit of the HFCWO device. Additionally, we need to compute those
quantities for several subjects in order to have confidence in the results. Further analysis are
then required.


                                                  Average volume
                                  Method                             Average flow ( Ls )
                                                  over a cycle (L)
                              without spline          0.0027               0.055
                6 I, 20 Hz      spline max            0.0018               0.042
                                spline mean           0.0022               0.048
                              without spline           0.015                0.12
                10 I, 12 Hz     spline max             0.016                0.15
                                spline mean            0.015                0.13

Table 4.3: Comparison of the average volume over a HFCWO cycle and the average flow induced
by a HFCWO device for different combinations of HFCWO intensity–frequency. The data
computed from the corrected volume (with spline method) are also compared to the original
volume.


Investigation of the efficiency of a HFCWO device through a clinical study                113


4.4.3   On the perspectives of the clinical study
The study presented in this subsection is only a preliminary insight on the clinical study pro-
posed. The data have not been analyzed for all combinations of HFCWO intensity–pressure
and for several participants. However, the way the clinical study should be performed has been
prepared and studied. We raised the fundamental elements needed to justify the relevance of the
study, such as the statistical power and the participants sample size for example. We propose
different ways to post-process the recorded data with a first comparison about their suitability.
We suggest the use of a significance test to analyze the data when we would have the record
from a sufficient number of subjects. This kind of test can suggest which intensity–pressure
combinations is more efficient than the others, with a level of confidence. Moreover, the use
of force sensors can also be important to determine the quantity of pressure applied by the
HFCWO device. Determining the pressure amplitude is an important step in order to interpret
properly the results of our study.


114   Towards the improvement of the model of the lungs


Chapter     5
Conclusion

This thesis proposes, studies and validates a model of the biophysical mechanisms of the lungs.
The model goal is to propose new insights for High Frequency Chest Wall Oscillation (HFCWO).
    For that purpose, the model, inspired from the literature, is built in the chapter 2. It is
based on the coupling between an idealized tree structure mimicking the pulmonary tree and
an elastic medium mimicking the lung’s parenchyma. The tree is based on 0D assumptions and
the equations ruling the elastic material are written for three dimensions. We considered linear
isotropic elasticity with small deformations adapted to HFCWO. A numerical method to solve
the equations of the model is presented. Regarding the coupling hypotheses, we considered that
the deformation of the elastic material feeds the tree with air. Particularly, each one of the
terminal branches of the tree is fed by one specific region in the material. As air is viscous, the
tree resists to the air flow inside. Hence, the influence of the tree plays the role of a damping
on the material deformation. The tree induces dissipative pressures in the material regions
connected to its terminal branches and these pressures affect the material deformation. The
resulting stress–strain law of the material is that of a viscoelastic material, with a non-local
viscous behavior. To study the behaviors of the coupled model, we analyzed the unidimensional
formulation of the model. First, we studied the damping influence of the tree on the material
deformation in a non-physiological framework. Actually, in our model, we saw that we can
compute the natural pulsations of the elastic material in the absence of the influence of the tree.
Those pulsations present interesting features for HFCWO as they are related to the resonance.
The resonance of a vibrating system occurs when the system is submitted to a force oscillating
at the natural pulsations of the system. Then, the motion amplitude of the system amplifies.
Consequently, we studied the resonance in non-physiological cases. We observed that the tree
structure affects the natural modes of vibration of the material. We linked these behaviors with
those of harmonic oscillators, using the energies of the systems. The analysis of the resonance of
our coupled model is extended in the chapter 3 in the frame of HFCWO application. The rest of
the chapter 2 aimed at validating and calibrating the model to produce numerical estimations
compatible with the physiology. Different set of parameters are determined to mimic healthy
and non-healthy lungs (asthma, chronic obstructive disease and cystic fibrosis).
    The chapter 3 studies the physical influence of the parameters of the unidimensional model
in the frame of HFCWO. It proposes a dimensionless formulation that raises two dimensionless
parameters. Actually, those parameters are the Euler number and the inverse of the Cauchy
number. We also propose a simplification of the coupled model inspired from the harmonic
oscillators with one degree of freedom. This brings another dimensionless parameter known as
the quality factor (Q-factor). This Q-factor evaluates the influence of the damping of the tree
on the material deformation. It allows to predict the existence or absence of resonance in the
coupled material. The three dimensionless parameters (Euler, Cauchy and the Q-factor) are
used to highlight the model predictions for idealized healthy and non-healthy lungs during the
ventilation at rest and during HFCWO. In the limits of the model, the Q-factor indicates that
no resonance can occur for the deformation of the coupled material when mimicking the lungs.


  116                                                                                Conclusion


However, we saw that, for harmonic oscillators, the velocity of the material deformation is always
maximised at the fundamental natural frequency of the material. In our model, the flows of
air in the tree arise from the velocity of the material deformation. Hence, we studied the air
flows at mouth. From lungs data found in the literature, we showed that the averaged air flows
at mouth are maximized at a frequency of around 6.5 Hz. We found out that similar velocity
resonance frequencies of the respiratory system have been estimated in the literature from clinical
experimentation. Nevertheless, in the limits of the model, we showed that the resistance of non-
healthy lungs might be too high to allow any kind of resonance. For pathological lungs with
increased resistance, the model predicts that for different frequencies, the air flows at mouth are
similar. The chapter 3 also proposes a way to model the stress felt by the mucus inside the tree.
This model mimics the stress due to the vibration of the airway wall and the stress due to the
air–mucus interaction inside the tree. We show that during HFCWO, the stress arising from the
air–mucus interaction is of the same order of magnitude for all generations of the tree. We also
show that the stress due to the vibration of the airways wall follows a negative linear pattern
as we sink in the tree. Moreover, in our model, for generations deeper than the fourth, this
stress becomes smaller than the stress due to the air–mucus interaction. Finally, the chapter 3
proposes in the limits of the model, that HFCWO could be used as a non-invasive tool to assess
the resistance and compliance of the lungs.
     The results have to be interpreted in the limitations of the model. Our model is based on
hypotheses that simplify the complexity of the geometry of the lungs and of its biomechanical
behaviors. Ways to improve the model are proposed and discussed in the chapter 4. We propose
improvements for the physics of the air flow in the tree, for the geometry of the tree, for the
geometry of the lung’s parenchyma as well as for the mucus distribution in the airways and
for its movement through the generations of the tree. We also propose a splitting method that
aims at reducing the computational time for the multi-dimensional numerical resolution of the
model. Finally, the chapter 4 also proposes the setup of a clinical study that will investigate the
efficiency of a HFCWO device based on our model predictions.

    Hence, in the limits of the model hypotheses, this thesis proposes new insights on what
happens in the lung during HFCWO using mathematical modelling. This work focus on the
core phenomena involved in the lungs during HFCWO to extract and explain characteristic
behaviors compatible with the physiology of that complex organ. These new insights could help
at developing new features for HFCWO. The mathematical model has been designed to be easily
adaptable and is able to include higher complexity modelling. This thesis also paves the ways
toward these future improvements. This work shows the significance of mathematical modelling
at understanding the behaviors in the lungs for which in-vivo and in-vitro approaches are not
so easily realisable. By extension, this is applicable for any other human organ.


Bibliography


 [1] Paula Agostini and Nicola Knowles. Autogenic drainage: the technique, physiological basis
     and evidence. Physiotherapy, 93(2):157–163, June 2007.

 [2] Emilio Agostoni and Robert E. Hyatt. Static Behavior of the Respiratory System, pages
     113–130. American Cancer Society, 2011.

 [3] Grégoire Allaire. Homogenization and two-scale convergence. SIAM Journal on Mathe-
     matical Analysis, 23(6):1482–1518, 1992.

 [4] S. P. Ambesh, N. Singh, D. Gupta, P. K. Singh, and U. Singh. A huffing manoeuvre, imme-
     diately before induction of anaesthesia, prevents fentanyl-induced coughing: a prospective,
     randomized, and controlled study. BJA: British Journal of Anaesthesia, 104(1):40–43, 11
     2009.

 [5] Daniel Arndt, Wolfgang Bangerth, Bruno Blais, Marc Fehling, Rene Gassmöller, Timo
     Heister, Luca Heltai, Uwe Köcher, Martin Kronbichler, Matthias Maier, Peter Munch,
     Jean-Paul Pelteret, Sebastian Proell, Konrad Simon, Bruno Turcksin, David Wells, and
     Jiaqi Zhang. The deal.II library, version 9.3. Journal of Numerical Mathematics, 2021,
     accepted for publication.

 [6] Daniel Arndt, Wolfgang Bangerth, Denis Davydov, Timo Heister, Luca Heltai, Martin
     Kronbichler, Matthias Maier, Jean-Paul Pelteret, Bruno Turcksin, and David Wells. The
     deal.II finite element library: Design, features, and insights. Computers & Mathematics
     with Applications, 81:407–422, 2021.

 [7] Mohammad Asghari-Jafarabadi and Homayoun Sadeghi-Bazargani. Randomization: Tech-
     niques and Software-aided Implementation in Medical Studies. Journal of Clinical Research
     &amp; Governance, 4(2), October 2015.

 [8] Peter J. Barnes. Pharmacology of Airway Smooth Muscle. American Journal of Respi-
     ratory and Critical Care Medicine, 158(supplement_2):S123–S132, November 1998. Pub-
     lisher: American Thoracic Society - AJRCCM.

 [9] Harry Bass. The Flow Volume Loop: Normal Standards and Abnormalities in Chronic
     Obstructive Pulmonary Disease. Chest, 63(2):171–176, 1973.

[10] Jason H. T. Bates. Lung Mechanics: An Inverse Modeling Approach. Cambridge University
     Press, 2009.

[11] Klaus-Jürgen Bathe. Finite Element Procedures - Second edition. K.J. Bathe, Watertown,
     MA, 2014.

[12] Sabine Bensamoun, Marie-Christine Ho Ba Tho, Son Luu, Jean-Marc Gherbezza, and
     Jean-François de Belleval. Spatial distribution of acoustic and elastic properties of human
     femoral cortical bone. Journal of Biomechanics, 37(4):503–510, April 2004.


 118                                                                             Bibliography


[13] Lorenz Berger, David Kay, Kelly Burrowes, Vicente Grau, Simon Tavener, and Rafel
     Bordas. A poroelastic model coupled to a fluid network with applications in lung modelling.
     arXiv:1411.1491 [physics, q-bio], April 2015. arXiv: 1411.1491.

[14] J. L. Black and P. R. Johnson. Airway smooth muscle in asthma. Respirology (Carlton,
     Vic.), 1(3):153–158, September 1996.

[15] Larry Borish and Jeffrey A. Culp. Asthma: a syndrome composed of heterogeneous dis-
     eases. Annals of Allergy, Asthma & Immunology: Official Publication of the American
     College of Allergy, Asthma, & Immunology, 101(1):1–8; quiz 8–11, 50, July 2008.

[16] Alexandra Buess, Benjamin Sobac, Benjamin Mauroy, and Benoit haut. Energy dissipation
     in an asymmetric tracheobronchial tree: a CFD analysis. In 27th Canadian Congress of
     Applied Mechanics, Sherbrooke, Canada, May 2019.

[17] Ximena M. Bustamante-Marin and Lawrence E. Ostrowski. Cilia and Mucociliary Clear-
     ance. Cold Spring Harbor Perspectives in Biology, 9(4):a028241, April 2017.

[18] Brian Button and Richard C. Boucher. Role of mechanical stress in regulating airway
     surface hydration and mucus clearance rates. Respiratory Physiology & Neurobiology,
     163(1):189–201, 2008. Respiratory Biomechanics.

[19] Paul Cazeaux and Céline Grandmont. Homogenization of a Multiscale Viscoelastic Model
     with Nonlocal Damping, Application to the Human Lungs. Mathematical Models and
     Methods in Applied Sciences, 25(6):1125, February 2015.

[20] E. Alberdi Celaya, J. J. Anza Aguirrezabala, and P. Chatzipantelidis. Implementation
     of an Adaptive BDF2 Formula and Comparison with the MATLAB Ode15s. Procedia
     Computer Science, 29:1014–1026, January 2014.

[21] Michelle Chatwin, Michel Toussaint, Miguel R. Gonçalves, Nicole Sheers, Uwe Mellies, Je-
     sus Gonzales-Bermejo, Jesus Sancho, Brigitte Fauroux, Tiina Andersen, Brit Hov, Malin
     Nygren-Bonnier, Matthieu Lacombe, Kurt Pernet, Mike Kampelmacher, Christian De-
     vaux, Kathy Kinnett, Daniel Sheehan, Fabrizio Rao, Marcello Villanova, David Berlowitz,
     and Brenda M. Morrow. Airway clearance techniques in neuromuscular disorders: A state
     of the art review. Respiratory Medicine, 136:98–110, March 2018. Publisher: Elsevier.

[22] L.Y.M. Chin, Y. Bossé, Y. Jiao, D. Solomon, T.L. Hackett, P.D. Paré, and C.Y. Seow.
     Human airway smooth muscle is structurally and mechanically similar to that of other
     species. European Respiratory Journal, 36(1):170–177, 2010.

[23] MO Columb and MS Atkinson. Statistical analysis: sample size and power estimations.
     BJA Education, 16(5):159–161, 08 2015.

[24] Cara F. Dosman and Richard L. Jones. High-Frequency Chest Compression: A Summary
     of the Literature, 2005.

[25] Xavier Dubois de La Sablonière, Benjamin Mauroy, and Yannick Privat. Shape minimiza-
     tion of the dissipated energy in dyadic trees. Discrete and Continuous Dynamical Systems
     - Series B, 16(3):767–799, June 2011.

[26] M. A. Dunnink, W. R. Doeleman, J. C. A. Trappenburg, and W. R. de Vries. Respiratory
     muscle strength in stable adolescent and adult patients with cystic fibrosis. Journal of
     Cystic Fibrosis, 8(1):31–36, 2009.

[27] John W. Eaton, David Bateman, Søren Hauberg, and Rik Wehbring. GNU Octave version
     5.1.0 manual: a high-level interactive language for numerical computations. 2019.


Bibliography                                                                              119


[28] Frank Emmert-Streib and Matthias Dehmer. Understanding statistical hypothesis testing:
     The logic of statistical inference. Machine Learning and Knowledge Extraction, 1(3):945–
     961, 2019.

[29] Monika Fagevik Olsén, Louise Lannefors, and Elisabeth Westerdahl. Positive expiratory
     pressure – Common clinical applications and physiological effects. Respiratory Medicine,
     109(3):297–307, March 2015.

[30] E. Fornasa, M. Ajčević, and A. Accardo. Characterization of the mechanical behavior of
     intrapulmonary percussive ventilation. Physiol. Meas., 34(12):1583, 2013.

[31] Alan D. Freed and Daniel R. Einstein. Hypo-elastic model for lung parenchyma. Biome-
     chanics and Modeling in Mechanobiology, 11(3):557–573, March 2012.

[32] B. Fuerst, T. Mansi, Jianwen Zhang, P. Khurd, J. Declerck, T. Boettger, Nassir Navab,
     J. Bayouth, Dorin Comaniciu, and A. Kamen. A Personalized Biomechanical Model for
     Respiratory Motion Prediction. Medical image computing and computer-assisted interven-
     tion : MICCAI International Conference on Medical Image Computing and Computer-
     Assisted Intervention, 15(0 3):566–573, 2012.

[33] Christophe Geuzaine and Jean-François Remacle. Gmsh: A 3-d finite element mesh gener-
     ator with built-in pre- and post-processing facilities. International Journal for Numerical
     Methods in Engineering, 79(11):1309–1331, 2009.

[34] Roland Glowinski, Stanley J. Osher, and Wotao Yin, editors. Splitting Methods in Com-
     munication, Imaging, Science, and Engineering. Scientific Computation. Springer Inter-
     national Publishing, 2016.

[35] Yasemin Gokdemir, Evrim Karadag-Saygi, Ela Erdem, Ozun Bayindir, Refika Ersu, Bulent
     Karadag, Nimet Sekban, Gulseren Akyuz, and Fazilet Karakoc. Comparison of conven-
     tional pulmonary rehabilitation and high-frequency chest wall oscillation in primary ciliary
     dyskinesia. Pediatric Pulmonology, 49(6):611–616, 2014.

[36] Lee W. Goldman. Principles of CT: Multislice CT. Journal of Nuclear Medicine Technol-
     ogy, 36(2):57–68, June 2008. Publisher: Society of Nuclear Medicine Section: CONTIN-
     UING EDUCATION.

[37] Céline Grandmont, Bertrand Maury, and Nicolas Meunier. A viscoelastic model with
     non-local damping application to the human lungs. ESAIM: Mathematical Modelling and
     Numerical Analysis, 40(01):201–224, January 2006.

[38] Philippe A. Grenier, Catalin I. Fetita, and Pierre-Yves Brillet. Quantitative computed
     tomography imaging of airway remodeling in severe asthma. Quantitative Imaging in
     Medicine and Surgery, 6(1):76–83, February 2016.

[39] Jean Luc Guermond and Richard Pasquetti. A correction technique for the dispersive
     effects of mass lumping for transport problems. Computer Methods in Applied Mechanics
     and Engineering, 253:186–198, 2012. Publisher: Elsevier.

[40] Beatrice Haefeli-Bleuer and Ewald R. Weibel. Morphometry of the human pulmonary
     acinus. The Anatomical Record, 220(4):401–414, 1988.

[41] Peter Hagedorn and Anirvan DasGupta. Vibration of string and bars. In Vibrations and
     Waves in Continuous Mechanical Systems, chapter 1, pages 1–67. John Wiley & Sons,
     Ltd, 2007.

[42] Liming Hao, Yan Shi, Maolin Cai, Shuai Ren, Yixuan Wang, Hao Zhang, and Qihui Yu.
     Dynamic characteristics of a mechanical ventilation system with spontaneous breathing.
     IEEE Access, 7:172847–172859, 2019.


 120                                                                             Bibliography


[43] Cyril M. Harris and Allan G. Piersol, editors. Harris’ shock and vibration handbook.
     McGraw-Hill handbooks. McGraw-Hill, New York, 5th ed edition, 2002.

[44] Nicholas Hart, Michael I. Polkey, Annick Clément, Michèle Boulé, John Moxham, Frédéric
     Lofaso, and Brigitte Fauroux. Changes in Pulmonary Mechanics with Increasing Disease
     Severity in Children and Young Adults with Cystic Fibrosis. American Journal of Respira-
     tory and Critical Care Medicine, 166(1):61–66, July 2002. Publisher: American Thoracic
     Society - AJRCCM.

[45] DR Hess.    The evidence for secretion clearance techniques.            Respiratory care,
     46(11):1276—1293, November 2001.

[46] Helge Holden, Kenneth H. Karlsen, Knut-andreas Lie, and Nils Henrik Risebro. Splitting
     Methods for Partial Differential Equations With Rough Solutions: Analysis and Matlabr
     Programs. European Mathematical Society, Zürich : Providence, R.I, April 2010.

[47] K. Horsfield. Diameters, generations, and orders of branches in the bronchial tree. Journal
     of Applied Physiology, 68(2):457–461, 1990. PMID: 2318756.

[48] F. Horwat and J.P. Meyer. Débit ventilatoire de travail - Elaboration et validation de
     méthodes indirectes d’évaluation au moyen de la fréquence cardiaque et de l’observation
     de l’activité. INRS, numero 76, 4eme trimestre, 1998.

[49] Alexandra Hough. Physiotherapy in respiratory care : an evidence-based approach to
     respiratory and cardiac management. Physiotherapy Research International, pages 56–57,
     2001. Third edition.

[50] A Hristara-Papadopoulou, J Tsanakas, G Diomou, and O Papadopoulou. Current devices
     of respiratory physiotherapy. Hippokratia, 12(4):211–220, 2008.

[51] J. Hussey and S.A. Prasad. Paediatric Respiratory Care: A guide for physiotherapists and
     health professionals. Springer US, 2013.

[52] Adobe Inc. Adobe premiere pro® . Video editing software.

[53] ISO. ISO/IEC 14882:1998: Programming languages — C++. sep 1998.

[54] ITK-SNAP, 2019. Medical image segmentation software, www.itksnap.org.

[55] N.H. Jacob J.M. Bourgery. The Atlas of Human Anatomy and Surgery. 2021. TASCHEN,
     Bibliotheca Universalis, republication of the 19th century book.

[56] Luis C. (Luis Carlos Ucha) Junqueira and Anthony L. 20319 Mescher. Junqueira’s basic
     histology : text & atlas / Anthony L. Mescher. New York [etc.] : McGraw-Hill Medical„
     2013. Accepted: 2018-11-04T14:22:52Z Journal Abbreviation: Basic histology.

[57] Ryutaro Kakinuma, Noriyuki Moriyama, Yukio Muramatsu, Shiho Gomi, Masahiro
     Suzuki, Hirobumi Nagasawa, Masahiko Kusumoto, Tomohiko Aso, Yoshihisa Muramatsu,
     Takaaki Tsuchida, Koji Tsuta, Akiko Miyagi Maeshima, Naobumi Tochigi, Shun-ichi
     Watanabe, Naoki Sugihara, Shinsuke Tsukagoshi, Yasuo Saito, Masahiro Kazama, Kazuto
     Ashizawa, Kazuo Awai, Osamu Honda, Hiroyuki Ishikawa, Naoya Koizumi, Daisuke
     Komoto, Hiroshi Moriya, Seitaro Oda, Yasuji Oshiro, Masahiro Yanagawa, Noriyuki
     Tomiyama, and Hisao Asamura. Ultra-High-Resolution Computed Tomography of the
     Lung: Image Quality of a Prototype Scanner. PLoS ONE, 10(9):e0137165, September
     2015.

[58] Cyril Karamaoun. Mathematical modeling of nitric oxide and mucus dynamics in the
     human lungs, using a phenomenological approach, to provide new insights into asthma and
     cystic fibrosis. PhD thesis, 10 2017.


Bibliography                                                                             121


[59] Cyril Karamaoun, Benjamin Sobac, Benjamin Mauroy, Alain Van Muylem, and Benoît
     Haut. New insights into the mechanisms controlling the bronchial mucus balance. PLOS
     ONE, 13(6):e0199319, June 2018.

[60] Ira M Katz, Andrew R Martin, Pierre-Antoine Muller, Karine Terzibachi, Chia-Hsiang
     Feng, Georges Caillibotte, Julien Sandeau, and Joëlle Texereau. The ventilation distribu-
     tion of helium-oxygen mixtures and the role of inertial losses in the presence of heteroge-
     neous airway obstructions. Journal of biomechanics, 44(6):1137—1143, April 2011.

[61] Robert R Kempainen, Carlos Milla, Jordan Dunitz, Kay Savik, Ann Hazelwood, Cynthia
     Williams, Bruce K Rubin, and Joanne L Billings. Comparison of settings used for high-
     frequency chest-wall compression in cystic fibrosis. Respiratory Care, 55(6):695–701, 2010.

[62] R. J. King. Pulmonary surfactant. Journal of Applied Physiology, 53(1):1–8, 1982. PMID:
     6749772.

[63] H. Kitaoka, R. Takaki, and B. Suki. A three-dimensional model of the human airway tree.
     Journal of Applied Physiology (Bethesda, Md.: 1985), 87(6):2207–2217, December 1999.

[64] Hiroko Kitaoka, Ryuji Takaki, and Béla Suki. A three-dimensional model of the human
     airway tree. Journal of Applied Physiology, 87(6):2207–2217, 1999. PMID: 10601169.

[65] Janet Kluft, Leila Beker, Maria Castagnino, Judith Gaiser, Holly Chaney, and Robert J.
     Fink. A comparison of bronchial drainage treatments in cystic fibrosis. Pediatric Pul-
     monology, 22(4), 1996.

[66] Martin Kneyber, Marc Heerde, Jos Twisk, Frans Plötz, and Dick Markhorst. Heliox
     reduces respiratory system resistance in respiratory syncytial virus induced respiratory
     failure. Critical care (London, England), 13:R71, 06 2009.

[67] V. Kulish. Human Respiration: Anatomy and Physiology, Mathematical Modeling, Nu-
     merical Simulation and Aplications. Shock, 26(6):637–638, December 2006. Chapter 8.

[68] Ufuk Kuyrukluyildiz, Orhan Binici, İlke Kupeli, Nurel Erturk, Barış Gulhan, Fethi Akyol,
     Adalet Ozcicek, Didem Onk, and Guldane Karabakan. What Is the Best Pulmonary
     Physiotherapy Method in ICU? Canadian Respiratory Journal, 2016, 2016.

[69] San Andrés L. Vibrations of continuous systems. MEEN 617 - HD#14, 2008.

[70] Samuel K. Lai, Ying-Ying Wang, Denis Wirtz, and Justin Hanes. Micro- and macrorhe-
     ology of mucus. Advanced Drug Delivery Reviews, 61(2):86–100, February 2009.

[71] Stephen J. Lai-Fook. Elastic properties of lung parenchyma: The effect of pressure-volume
     hysteresis on the behavior of large blood vessels. Journal of Biomechanics, 12(10):757–764,
     1979.

[72] R. K. Lambert, T. A. Wilson, R. E. Hyatt, and J. R. Rodarte. A computational model for
     expiratory flow. J Appl Physiol Respir Environ Exerc Physiol, 52(1):44–56, January 1982.

[73] Sandrine Launois-Rollinat. Ventilation pulmonaire (4) Propriétés élastiques de l’appareil
     respiratoire. 2010.

[74] GC Lee and A Frankus. Elasticity properties of lung parenchyma derived from experi-
     mental distortion data. Biophysical journal, 15(5):481—493, May 1975.

[75] S Lee, J Alexander, R Blowes, D Ingram, and A Milner. Determination of resonance
     frequency of the respiratory system in respiratory distress syndrome. Archives of Disease
     in Childhood. Fetal and Neonatal Edition, 80(3):F198–F202, May 1999.


 122                                                                              Bibliography


[76] M.G. Levitzky. Pulmonary Physiology, Seventh Edition.          LANGE Physiology Series.
     McGraw-Hill Education, 2007.

[77] Stephen H. Loring, Mauricio Garcia-Jacques, and Atul Malhotra. Pulmonary characteris-
     tics in copd and mechanisms of increased work of breathing. Journal of Applied Physiology,
     107(1):309–314, 2009. PMID: 19359620.

[78] C. J. Martin, S. Das, and A. C. Young. Measurements of the dead space volume. Journal of
     Applied Physiology: Respiratory, Environmental and Exercise Physiology, 47(2):319–324,
     August 1979.

[79] MATLAB. version 7.10.0 (R2010a). The MathWorks Inc., Natick, Massachusetts, 2010.

[80] B. Mauroy, M. Filoche, E. R. Weibel, and B. Sapoval. An optimal bronchial tree may be
     dangerous. Nature, 427(6975):633–636, February 2004.

[81] Benjamin Mauroy and Plamen Bokov. The influence of variability on the optimal shape
     of an airway tree branching asymmetrically. Phys Biol, 7(1):16007, 2010.

[82] Benjamin Mauroy and Plamen Bokov. The influence of variability on the optimal shape
     of an airway tree branching asymmetrically. Physical Biology, 7(1):016007, jan 2010.

[83] Benjamin Mauroy, Christian Fausser, Dominique Pelca, Jacques Merckx, and Patrice
     Flaud. Toward the modeling of mucus draining from the human lung: role of the ge-
     ometry of the airway tree. Physical Biology, 8(5):056006, October 2011.

[84] Benjamin Mauroy, Patrice Flaud, Dominique Pelca, Christian Fausser, Jacques Merckx,
     and Barrett R. Mitchell. Toward the modeling of mucus draining from human lung: role
     of airways deformation on air-mucus interaction. Frontiers in Physiology, 6, August 2015.

[85] Benjamin Mauroy and Nicolas Meunier. Optimal Poiseuille flow in a finite elastic dyadic
     tree. ESAIM: Mathematical Modelling and Numerical Analysis, 42(4):507–533, July 2008.

[86] Benjamin Mauroy and Nicolas Meunier. Optimal poiseuille flow in a finite elastic dyadic
     tree. ESAIM: Mathematical Modelling and Numerical Analysis - Modélisation Mathéma-
     tique et Analyse Numérique, 42(4):507–533, 2008.

[87] Bertrand Maury. The Respiratory System in Equations. MS&A. Springer-Verlag, Mailand,
     2013.

[88] Steven R. McClaran, Craig A. Harms, David F. Pegelow, and Jerome A. Dempsey. Smaller
     lungs in women affect exercise hyperpnea. Journal of Applied Physiology, 84(6):1872–1881,
     1998. PMID: 9609779.

[89] Maggie Patricia McIlwaine, Nancy Alarie, George F. Davidson, Larry C. Lands, Felix
     Ratjen, Ruth Milner, Blythe Owen, and Jennifer L. Agnew. Long-term multicentre ran-
     domised controlled study of high frequency chest wall oscillation versus positive expiratory
     pressure mask in cystic fibrosis. Thorax, 68(8):746–751, August 2013. Publisher: BMJ
     Publishing Group Ltd Section: Cystic fibrosis.

[90] Robert I. McLachlan and G. Reinout W. Quispel. Splitting methods. Acta Numerica,
     11:341–434, 2002.

[91] Jere Mead. Measurement of Inertia of the Lungs at Increased Ambient Pressure. Journal
     of Applied Physiology, sep 1956.

[92] Carlos E. Milla, Leland G. Hansen, and Warren J. Warwick. Different frequencies should
     be prescribed for different high frequency chest compression machines. Biomedical Instru-
     mentation & Technology, 40(4):319–324, 07 2006.


Bibliography                                                                               123


 [93] B.R. Mitchell, F. Lupi, P. Gianangeli, G. Poldi, G. Malerba, and M. Pontesilli. Hfcwo
      vest, May 2013. US Patent App. 13/521,495.

 [94] Hiroyuki Nakamura and Kazutetsu Aoshiba, editors. Chronic Obstructive Pulmonary
      Disease: A Systemic Inflammatory Disease. Respiratory Disease Series: Diagnostic Tools
      and Disease Managements. Springer Singapore, 2017.

 [95] Antonello Nicolini, Federica Cardini, Norma Landucci, Sergio Lanata, Maura Ferrari-
      Bravo, and Cornelius Barlascini. Effectiveness of treatment with high-frequency chest
      wall oscillation in patients with bronchiectasis. BMC Pulmonary Medicine, 13(1):21, April
      2013.

 [96] Antonello Nicolini, Bruna Grecchi, and Paolo Banfi. Effectiveness of two high frequency
      chest wall oscillation techniques in patients with bronchiectasis: a randomized controlled
      preliminary study. Panminerva Medica, March 2020.

 [97] Antonello Nicolini, Bruna Grecchi, Maura Ferrari-Bravo, and Cornelius Barlascini. Safety
      and effectiveness of the high-frequency chest wall oscillation vs intrapulmonary percussive
      ventilation in patients with severe COPD. International Journal of Chronic Obstructive
      Pulmonary Disease, 13:617–625, February 2018.

 [98] Frédérique Noël. Influence of the ventilation on the transport properties in the healthy and
      inflamed lung. Theses, Université Côte d’Azur, February 2021.

 [99] Frédérique Noël, Cyril Karamaoun, Jerome A. Dempsey, and Benjamin Mauroy. The
      origin of the allometric scaling of lung’s ventilation in mammals, 2021.

[100] C. M. Oermann, P. R. Swank, and M. M. Sockrider. Validation of an instrument mea-
      suring patient satisfaction with chest physiotherapy techniques in cystic fibrosis. Chest,
      118(1):92–97, July 2000.

[101] OpenFOAM. OpenFOAM Foundation Ltd., OpenCFD Ltd., Computational Fluid Dy-
      namics simulation software, www.openfoam.com/documentation/overview.

[102] Paola Paone and Patrice D. Cani. Mucus barrier, mucins and gut microbiota: the expected
      slimy partners? Gut, 69(12):2232–2243, December 2020. Publisher: BMJ Publishing
      Group Section: Recent advances in basic science.

[103] S. Paramothayan. Essential Respiratory Medicine. Essentials. Wiley, 2019.

[104] T. J. Pedley, R. C. Schroter, and M. F. Sudlow. Energy losses and pressure drop in models
      of human airways. Respiration Physiology, 9(3):371–386, June 1970.

[105] T. J. Pedley, R. C. Schroter, and M. F. Sudlow. Flow and pressure drop in systems of
      repeatedly branching tubes. Journal of Fluid Mechanics, 46(02):365–383, March 1971.

[106] Celina Pezowicz and Maciej Głowacki. The mechanical properties of human ribs in young
      adult. Acta of Bioengineering and Biomechanics, 14(2):53–60, 2012.

[107] Roland Pfister, Katharina A. Schwarz, and Markus Janczyk. Ubi irritatio, ibi affluxus: a
      19th century perspective on haemodynamic brain activity. Cortex; a Journal Devoted to
      the Study of the Nervous System and Behavior, 48(8):1061–1063, September 2012.

[108] Agence Nationle pour le Développement de l’Evaluation Médicale. Recommandations de
      la 1ère conférence de consensus en kinésithérapie respiratoire, 1995.

[109] Nicolas Pozin. Multiscale lung ventilation modeling in health and disease. Phd thesis, Paris
      6, October 2017.


  124                                                                           Bibliography


[110] Nicolas Pozin, Spyridon Montesantos, Ira Katz, Marine Pichelin, Irene Vignon-Clementel,
      and Céline Grandmont. Predicted airway obstruction distribution based on dynamical
      lung ventilation data: A coupled modeling-machine learning methodology. International
      Journal for Numerical Methods in Biomedical Engineering, 34(9):e3108, 2018.

[111] Nicolas Pozin, Spyridon Montesantos, Ira Katz, Marine Pichelin, Irene E. Vignon-
      Clementel, and Céline Grandmont. A tree-parenchyma coupled model for lung ventila-
      tion simulation. International Journal for Numerical Methods in Biomedical Engineering,
      February 2017. Publisher: John Wiley and Sons.

[112] Bhavna Prajapati, Mark C. M. Dunne, and Richard A. Armstrong. Sample size estimation
      and statistical power analyses. Optometry Today, 2010(July), July 2010.

[113] Françoise Prêteux, Catalin Fetita, Andre Capderou, and Philippe Grenier M.d. Modeling,
      segmentation, and caliber estimation of bronchi in high resolution computerized tomog-
      raphy. Journal of Electronic Imaging, 8(1):36, January 1999. Publisher: International
      Society for Optics and Photonics.

[114] Singiresu S. Rao. Longitudinal vibration of bars. In Vibration of Continuous Systems,
      chapter 9, pages 234–270. John Wiley & Sons, Ltd, 2006.

[115] Gregory Reychler, Emilie Debier, Olivier Contal, and Nicolas Audag. Intrapulmonary Per-
      cussive Ventilation as an Airway Clearance Technique in Subjects With Chronic Obstruc-
      tive Airway Diseases. Respiratory Care, 63(5):620–631, May 2018. Publisher: Respiratory
      Care Section: Systematic Review.

[116] Thomas Ritz, Bernhard Dahme, Arthur B. Dubois, Hans Folgering, Gregory K. Fritz,
      Andrew Harver, Harry Kotses, Paul M. Lehrer, Christopher Ring, Andrew Steptoe, and
      et al. Guidelines for mechanical lung function measurements in psychophysiology. Psy-
      chophysiology, 39(5):546–567, 2002.

[117] Duncan F. Rogers. Airway mucus hypersecretion in asthma: an undervalued pathology?
      Current Opinion in Pharmacology, 4(3):241–250, 2004.

[118] Jan Rosell and Paolo Cabras. A three-stage method for the 3D reconstruction of the
      tracheobronchial tree from CT scans. Computerized Medical Imaging and Graphics: The
      Official Journal of the Computerized Medical Imaging Society, 37(7-8):430–437, December
      2013.

[119] Behnaz Seyfi, Anand P. Santhanam, and Olusegun J. Ilegbusi. A Biomechanical Model of
      Human Lung Deformation Utilizing Patient-Specific Elastic Property. Journal of Cancer
      Therapy, 07(06):402, 2016. Number: 06 Publisher: Scientific Research Publishing.

[120] Ahmed Shabana. Theory of Vibration: An Introduction. Mechanical Engineering Series.
      Springer International Publishing, 3 edition, 2019.

[121] Peter D. Sly and Rachel A. Collins. Chapter 7 - applied clinical respiratory physiology.
      In Lynn M. Taussig and Louis I. Landau, editors, Pediatric Respiratory Medicine (Second
      Edition), pages 73–88. Mosby, Philadelphia, second edition edition, 2008.

[122] American Thoracic Society Statement. Lung function testing: selection of reference values
      and interpretative strategies. american thoracic society. The American review of respira-
      tory disease, 144(5):1202—1218, November 1991.

[123] Jonathan Stephano. Conséquences de l’asymétrie et de la compliance des bronches sur
      les propriétés hydrodynamiques du poumon, applications à la kinésithérapie respiratoire.
      Theses, Université Côte D’Azur ; École doctorale Sciences fondamentales et appliquées
      (Nice), May 2021.


Bibliography                                                                            125


[124] Jonathan Stephano and Benjamin Mauroy. Modeling shear stress distribution in a de-
      formable airway tree. In 27th Canadian Congress of Applied Mechanics, Sherbrooke,
      Canada, June 2019.

[125] Jonathan Stéphano and Benjamin Mauroy. Wall shear stress distribution in a compliant
      airway tree. Physics of Fluids, 33(3):031907, Mar 2021.

[126] Karl Peter Sylvester, Nigel Clayton, Ian Cliff, Michael Hepple, Adrian Kendrick,
      Jane Kirkby, Martin Miller, Alan Moore, Gerrard Francis Rafferty, Liam O’Reilly,
      Joanna Shakespeare, Laurie Smith, Trefor Watts, Martyn Bucknall, and Keith But-
      terfield. ARTP statement on pulmonary function testing 2020. BMJ Open Respi-
      ratory Research, 7(1), 2020. Publisher: Archives of Disease in childhood _eprint:
      https://bmjopenrespres.bmj.com/content/7/1/e000575.full.pdf.

[127] Josué Sznitman. Respiratory microflows in the pulmonary acinus. Journal of biomechanics,
      46(2):284—298, January 2013.

[128] Lynn Taussig and Lynn Landau. Pediatric Respiratory Medicine - 2nd Edition. Mosby,
      Philadelphia, 2008.

[129] Merryn H. Tawhai, Peter Hunter, Juerg Tschirren, Joseph Reinhardt, Geoffrey McLennan,
      and Eric A. Hoffman. CT-based geometry analysis and finite element models of the human
      and ovine bronchial tree. Journal of Applied Physiology, 97(6):2310–2321, December 2004.
      Publisher: American Physiological Society.

[130] Merryn H Tawhai and Peter J Hunter. Modeling water vapor and heat transfer in the
      normal and the intubated airways. Annals of biomedical engineering, 32(4):609—622, April
      2004.

[131] Merryn H. Tawhai, A. J. Pullan, and P. J. Hunter. Generation of an anatomically based
      three-dimensional model of the conducting airways. Ann Biomed Eng, 28(7):793–802, July
      2000.

[132] HA Tiddens, LP Koopman, RK Lambert, WM Elliott, WC Hop, TW van der
      Mark, WJ de Boer, and JC de Jongste.                Cartilaginous airway wall dimen-
      sions and airway resistance in cystic fibrosis lungs.      European Respiratory Jour-
      nal, 15(4):735–742, 2000.        Publisher:  European Respiratory Society _eprint:
      https://erj.ersjournals.com/content/15/4/735.full.pdf.

[133] Umolo, 2021. Calligraphic designer, Köln, Germany.

[134] Caroline van Ertbruggen, Charles Hirsch, and Manuel Paiva. Anatomically based three-
      dimensional model of airways to simulate flow and particle transport using computational
      fluid dynamics. Journal of Applied Physiology, 98(3):970–980, 2005. PMID: 15501925.

[135] Ewald R. Weibel. Morphometry of the Human Lung. Springer-Verlag, Berlin Heidelberg,
      1963.

[136] Ewald R. Weibel. The Pathway for Oxygen: Structure and Function in the Mammalian
      Respiratory System. Harvard University Press, 1984.

[137] René Werner, Jan Ehrhardt, Rainer Schmidt, and Heinz Handels. Patient-specific finite
      element modeling of respiratory lung motion using 4D CT image data. Medical Physics,
      36(5):1500–1511, May 2009.

[138] B. J. West, V. Bhargava, and A. L. Goldberger. Beyond the principle of similitude:
      renormalization in the bronchial tree. Journal of Applied Physiology, 60(3):1089–1097,
      1986. PMID: 3957825.


  126                                                                             Bibliography


[139] S. Whittemore and D.A. Cooley. The Respiratory System. Human body, how it works.
      Chelsea House, 2009.

[140] Lena Yoshihara, Christian J. Roth, and Wolfgang A. Wall. Fluid-structure interac-
      tion including volumetric coupling with homogenised subdomains for modeling respira-
      tory mechanics. International Journal for Numerical Methods in Biomedical Engineering,
      33(4):e2812, 2017. e2812 cnm.2812.

[141] Paul A. Yushkevich, Joseph Piven, Heather Cody Hazlett, Rachel Gimpel Smith, Sean Ho,
      James C. Gee, and Guido Gerig. User-guided 3D active contour segmentation of anatomical
      structures: significantly improved efficiency and reliability. NeuroImage, 31(3):1116–1128,
      July 2006.
